<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta property="og:url" content="https://bytecodes.tech/java/jvm/java-jvm-struct.html"><meta property="og:site_name" content="å‡¤å‡°æ¶…æ§ƒè¿›é˜¶ä¹‹è·¯"><meta property="og:title" content="JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-12-26T11:56:34.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-12-26T11:56:34.000Z"><meta name="robots" content="all"><meta name="author" content="Abelsun"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><meta name="keywords" content="Java, JavaåŸºç¡€, å¹¶å‘ç¼–ç¨‹, JVM, è™šæ‹Ÿæœº, æ•°æ®åº“, MySQL, Spring, Redis, MyBatis, SpringBoot, IDEA, æ±‚èŒé¢è¯•, é¢è¯•é€†è¢­, å­¦ä¹ è·¯çº¿"><meta name="apple-mobile-web-app-capable" content="yes"><script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?5230ac143650bf5eb3c14f3fb9b1d3ec";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
        })();
      </script><link rel="stylesheet" href="//at.alicdn.com/t/font_3180624_7cy10l7jqqh.css"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#096dd9"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„ | å‡¤å‡°æ¶…æ§ƒè¿›é˜¶ä¹‹è·¯</title><meta name="description" content="å¼€æºå·¥å…·ã€æ•ˆç‡æ–¹æ³•ã€å¿ƒç†å­¦æ¢ç´¢çš„è‡ªæˆ‘æå‡ç¬”è®°ï¼Œè®°å½•å¹¶è¾“å‡ºä¸€åˆ‡èƒ½è®©è‡ªå·±æå‡çš„çŸ¥è¯†ã€‚">
    <meta name="keywords" content="è‡ªæˆ‘æå‡,æ•ˆç‡æå‡,å¼€æºå·¥å…·,å­¦ä¹ ç¬”è®°" />
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/assets/style.9613470c.css">
    <link rel="modulepreload" href="/assets/app.605999cc.js"><link rel="modulepreload" href="/assets/java-jvm-struct.html.f6ba43b3.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/java-jvm-struct.html.d3d7e35d.js">
    <!-- çœ‹æ¿å¨˜åŒºå— -->
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-y/font-awesome/6.0.0/css/all.min.css" type="text/css" rel="stylesheet" />
    <script src="/live2d-widget/autoload.js"></script>
    <!-- End çœ‹æ¿å¨˜åŒºå— -->
    <!-- Matomo æ­¤åŒºå—ä¸ºç»Ÿè®¡ä»£ç ï¼Œè¯·åˆ é™¤-->
    <script>
      var _paq = window._paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="https://piwik.seoipo.com/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '7']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Code æ­¤åŒºå—ä¸ºç»Ÿè®¡ä»£ç ï¼Œè¯·åˆ é™¤-->
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/" class="brand"><img class="logo" src="/assets/icon/logo.png" alt="å‡¤å‡°æ¶…æ§ƒè¿›é˜¶ä¹‹è·¯"><!----><span class="site-name hide-in-pad">å‡¤å‡°æ¶…æ§ƒè¿›é˜¶ä¹‹è·¯</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/blog.html" class="nav-link" aria-label="åšå®¢"><span class="icon iconfont icon-gaishu"></span>åšå®¢<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è¯­è¨€|å¹³å°"><span class="title"><span class="icon iconfont icon-creative"></span>è¯­è¨€|å¹³å°</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/language/android/android-call-js.html" class="nav-link" aria-label="Android"><span class="icon iconfont icon-creative"></span>Android<!----></a></li><li class="dropdown-item"><a href="/language/python/python-advantage.html" class="nav-link" aria-label="python"><span class="icon iconfont icon-creative"></span>python<!----></a></li><li class="dropdown-item"><a href="/language/weixin/wx-package-Optimization.html" class="nav-link" aria-label="å¾®ä¿¡"><span class="icon iconfont icon-creative"></span>å¾®ä¿¡<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Java"><span class="title"><span class="icon iconfont icon-creative"></span>Java</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/java/base/Java-basis-oop.html" class="nav-link" aria-label="JavaåŸºç¡€"><!---->JavaåŸºç¡€<!----></a></li><li class="dropdown-item"><a href="/java/io/java-io-overview.html" class="nav-link" aria-label="Java IO"><!---->Java IO<!----></a></li><li class="dropdown-item"><a href="/java/collection/java-collection-overview.html" class="nav-link" aria-label="Javaé›†åˆ"><!---->Javaé›†åˆ<!----></a></li><li class="dropdown-item"><a href="/java/thread/java-thread-x-theorty.html" class="nav-link" aria-label="Javaå¹¶å‘"><!---->Javaå¹¶å‘<!----></a></li><li class="dropdown-item"><a href="/java/java8/java8-lambda.html" class="nav-link" aria-label="Java8"><!---->Java8<!----></a></li><li class="dropdown-item"><a href="/java/jvm/jvm-overview.html" class="nav-link" aria-label="JVM"><!---->JVM<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ•°æ®åº“"><span class="title"><span class="icon iconfont icon-creative"></span>æ•°æ®åº“</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/db/sql/sql-x-basic.html" class="nav-link" aria-label="æ•°æ®åº“åŸºç¡€/SQLåŸºç¡€"><!---->æ•°æ®åº“åŸºç¡€/SQLåŸºç¡€<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Sqlæ•°æ®åº“</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/mysql/sql-mysql-overview.html" class="nav-link" aria-label="Mysql"><!---->Mysql<!----></a></li><li class="dropdown-subitem"><a href="/db/oracle/oracle-b-sequence.html" class="nav-link" aria-label="Oracle"><!---->Oracle<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>NoSqlæ•°æ®åº“</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/db/redis/db-redis-introduce.html" class="nav-link" aria-label="Redis"><!---->Redis<!----></a></li><li class="dropdown-subitem"><a href="/db/mongodb/mongodb-started.html" class="nav-link" aria-label="MongoDb"><!---->MongoDb<!----></a></li><li class="dropdown-subitem"><a href="/db/es/elasticsearch-x-introduce-1.html" class="nav-link" aria-label="Elasticsearch"><!---->Elasticsearch<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ¡†æ¶|ä¾èµ–"><span class="title"><span class="icon iconfont icon-creative"></span>æ¡†æ¶|ä¾èµ–</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dependencies/spring/spring-overview.html" class="nav-link" aria-label="Spring"><!---->Spring<!----></a></li><li class="dropdown-subitem"><a href="/dependencies/spring-boot/springboot-x-overview.html" class="nav-link" aria-label="SpringBoot"><!---->SpringBoot<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ORM</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dependencies/mybatis/mybatis-y-arch.html" class="nav-link" aria-label="Mybatis"><!---->Mybatis<!----></a></li><li class="dropdown-subitem"><a href="/dependencies/mybatis-plus/mybatis-plus-x-gen-code.html" class="nav-link" aria-label="Mybatis-Plus"><!---->Mybatis-Plus<!----></a></li></ul></li><li class="dropdown-item"><a href="/dependencies/office/office-x-aspose.html" class="nav-link" aria-label="Officeæ–‡æ¡£æ“ä½œ"><!---->Officeæ–‡æ¡£æ“ä½œ<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å¼€å‘|æµ‹è¯•"><span class="title"><span class="icon iconfont icon-creative"></span>å¼€å‘|æµ‹è¯•</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/develop/devlibrary/dev-lib-lombok.html" class="nav-link" aria-label="å¼€å‘-å¸¸ç”¨ç±»åº“"><span class="icon iconfont icon-creative"></span>å¼€å‘-å¸¸ç”¨ç±»åº“<!----></a></li><li class="dropdown-item"><a href="/develop/security/dev-security-x-injection.html" class="nav-link" aria-label="å¼€å‘-å®‰å…¨"><span class="icon iconfont icon-creative"></span>å¼€å‘-å®‰å…¨<!----></a></li><li class="dropdown-item"><a href="/develop/optimization/optimization-x-interface-optimization.html" class="nav-link" aria-label="å¼€å‘ - ä¼˜åŒ–"><span class="icon iconfont icon-creative"></span>å¼€å‘ - ä¼˜åŒ–<!----></a></li><li class="dropdown-item"><a href="/develop/style/dev-qt-code-style.html" class="nav-link" aria-label="å¼€å‘ - è§„èŒƒ/é£æ ¼"><span class="icon iconfont icon-creative"></span>å¼€å‘ - è§„èŒƒ/é£æ ¼<!----></a></li><li class="dropdown-item"><a href="/develop/test/ut-overview" class="nav-link" aria-label="æµ‹è¯•"><span class="icon iconfont icon-creative"></span>æµ‹è¯•<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è½¯ä»¶|éƒ¨ç½²"><span class="title"><span class="icon iconfont icon-creative"></span>è½¯ä»¶|éƒ¨ç½²</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/deploy/docker/docker-basic-overview.html" class="nav-link" aria-label="Docker"><span class="icon iconfont icon-creative"></span>Docker<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>æ¶ˆæ¯é˜Ÿåˆ—</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/deploy/mq/mq-a-overview.html" class="nav-link" aria-label="æ¶ˆæ¯é˜Ÿåˆ—"><!---->æ¶ˆæ¯é˜Ÿåˆ—<!----></a></li><li class="dropdown-subitem"><a href="/deploy/mq-rabbitmq/rabbitmq-x-overview.html" class="nav-link" aria-label="RabbitMQ"><!---->RabbitMQ<!----></a></li><li class="dropdown-subitem"><a href="/deploy/mq-kafka/kafka-x-overview.html" class="nav-link" aria-label="Kafka"><!---->Kafka<!----></a></li></ul></li><li class="dropdown-item"><a href="/deploy/skywalking/skywalking-x-principle.html" class="nav-link" aria-label="Skywalking"><span class="icon iconfont icon-creative"></span>Skywalking<!----></a></li><li class="dropdown-item"><a href="/deploy/linux/linux-j-monitor-overview.html" class="nav-link" aria-label="Linux"><span class="icon iconfont icon-creative"></span>Linux<!----></a></li><li class="dropdown-item"><a href="/deploy/jenkins/jenkins-overview.html" class="nav-link" aria-label="Jenkins"><span class="icon iconfont icon-creative"></span>Jenkins<!----></a></li><li class="dropdown-item"><a href="/deploy/nginx/nginx-x-overview.html" class="nav-link" aria-label="Nginx"><span class="icon iconfont icon-creative"></span>Nginx<!----></a></li><li class="dropdown-item"><a href="/deploy/deploy/docker-basic-overview" class="nav-link" aria-label="éƒ¨ç½²"><span class="icon iconfont icon-creative"></span>éƒ¨ç½²<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ¶æ„|ç³»ç»Ÿ"><span class="title"><span class="icon iconfont icon-creative"></span>æ¶æ„|ç³»ç»Ÿ</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/arch/base/arch-basic.html" class="nav-link" aria-label="æ¶æ„åŸºç¡€"><span class="icon iconfont icon-creative"></span>æ¶æ„åŸºç¡€<!----></a></li><li class="dropdown-item"><a href="/arch/distributed/arch-id.html" class="nav-link" aria-label="åˆ†å¸ƒå¼ç³»ç»Ÿ"><span class="icon iconfont icon-creative"></span>åˆ†å¸ƒå¼ç³»ç»Ÿ<!----></a></li><li class="dropdown-item"><a href="/arch/microservices/ms-overview.html" class="nav-link" aria-label="å¾®æœåŠ¡"><span class="icon iconfont icon-creative"></span>å¾®æœåŠ¡<!----></a></li><li class="dropdown-item"><a href="/arch/minio/minio-concept.html" class="nav-link" aria-label="å¯¹è±¡å­˜å‚¨-Minio"><span class="icon iconfont icon-creative"></span>å¯¹è±¡å­˜å‚¨-Minio<!----></a></li><li class="dropdown-item"><a href="/arch/manage-system/manage-system-technical-selection.html" class="nav-link" aria-label="åå°ç®¡ç†ç³»ç»Ÿ"><span class="icon iconfont icon-creative"></span>åå°ç®¡ç†ç³»ç»Ÿ<!----></a></li><li class="dropdown-item"><a href="/arch/mall/mall-sku.html" class="nav-link" aria-label="å•†åŸè®¾è®¡"><span class="icon iconfont icon-creative"></span>å•†åŸè®¾è®¡<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="åŒºå—é“¾"><span class="title"><span class="icon iconfont icon-creative"></span>åŒºå—é“¾</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/blockchain/basic-logic/The_white_paper_the_currency.html" class="nav-link" aria-label="åŒºå—é“¾ç™½çš®ä¹¦"><span class="icon iconfont icon-creative"></span>åŒºå—é“¾ç™½çš®ä¹¦<!----></a></li><li class="dropdown-item"><a href="/blockchain/component/Introduction_to_libp2p_autoNAT_network.html" class="nav-link" aria-label="åŒºå—é“¾ç»„ä»¶"><span class="icon iconfont icon-creative"></span>åŒºå—é“¾ç»„ä»¶<!----></a></li><li class="dropdown-item"><a href="/blockchain/male-chain-research/0.Rounding" class="nav-link" aria-label="ä¸»æµåŒºå—é“¾ç ”ç©¶"><span class="icon iconfont icon-creative"></span>ä¸»æµåŒºå—é“¾ç ”ç©¶<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ‚é¡¹|æ€è€ƒ"><span class="title"><span class="icon iconfont icon-creative"></span>æ‚é¡¹|æ€è€ƒ</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/think/deepImpression/redis-bigdata-slow-problem.html" class="nav-link" aria-label="å°è±¡æ·±åˆ»bug"><span class="icon iconfont icon-creative"></span>å°è±¡æ·±åˆ»bug<!----></a></li><li class="dropdown-item"><a href="/think/optimization/optimization-x-frequent-operation-db.html" class="nav-link" aria-label="ä¼˜åŒ–"><span class="icon iconfont icon-creative"></span>ä¼˜åŒ–<!----></a></li><li class="dropdown-item"><a href="/think/misc/misc-x-middleware.html" class="nav-link" aria-label="æ‚é¡¹"><span class="icon iconfont icon-creative"></span>æ‚é¡¹<!----></a></li></ul></button></div></div></nav><!----></div><div class="navbar-right"><!----><div class="nav-item"><a class="repo-link" href="https://github.com/token01/token01.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><div id="docsearch-container"></div><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">JavaåŸºç¡€</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Java-IO</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Javaé›†åˆ</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">å¤šçº¿ç¨‹ä¸å¹¶å‘</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Java8</span><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable active"><!----><span class="title">Jvm</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a href="/java/jvm/jvm-overview.html" class="nav-link sidebar-link sidebar-page" aria-label="JVMç›¸å…³çŸ¥è¯†ä½“ç³»è¯¦è§£"><!---->JVMç›¸å…³çŸ¥è¯†ä½“ç³»è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-class.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM åŸºç¡€ - ç±»å­—èŠ‚ç è¯¦è§£"><!---->JVM åŸºç¡€ - ç±»å­—èŠ‚ç è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-class-enhancer.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM åŸºç¡€ - å­—èŠ‚ç çš„å¢å¼ºæŠ€æœ¯"><!---->JVM åŸºç¡€ - å­—èŠ‚ç çš„å¢å¼ºæŠ€æœ¯<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-classload.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM åŸºç¡€ - Java ç±»åŠ è½½æœºåˆ¶"><!---->JVM åŸºç¡€ - Java ç±»åŠ è½½æœºåˆ¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/java/jvm/java-jvm-struct.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„"><!---->JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_0-è¿è¡Œæ—¶æ•°æ®åŒº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="0. è¿è¡Œæ—¶æ•°æ®åŒº"><!---->0. è¿è¡Œæ—¶æ•°æ®åŒº<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_1-ç¨‹åºè®¡æ•°å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1. ç¨‹åºè®¡æ•°å™¨"><!---->1. ç¨‹åºè®¡æ•°å™¨<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_1-1-ä½œç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.1 ä½œç”¨"><!---->1.1 ä½œç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_1-2-æ¦‚è¿°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1.2 æ¦‚è¿°"><!---->1.2 æ¦‚è¿°<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-è™šæ‹Ÿæœºæ ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2. è™šæ‹Ÿæœºæ ˆ"><!---->2. è™šæ‹Ÿæœºæ ˆ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-1-æ¦‚è¿°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.1 æ¦‚è¿°"><!---->2.1 æ¦‚è¿°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-2-æ ˆçš„å­˜å‚¨å•ä½" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.2 æ ˆçš„å­˜å‚¨å•ä½"><!---->2.2 æ ˆçš„å­˜å‚¨å•ä½<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-3-æ ˆè¿è¡ŒåŸç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.3 æ ˆè¿è¡ŒåŸç†"><!---->2.3 æ ˆè¿è¡ŒåŸç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-4-æ ˆå¸§çš„å†…éƒ¨ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.4 æ ˆå¸§çš„å†…éƒ¨ç»“æ„"><!---->2.4 æ ˆå¸§çš„å†…éƒ¨ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_3-æœ¬åœ°æ–¹æ³•æ ˆ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3. æœ¬åœ°æ–¹æ³•æ ˆ"><!---->3. æœ¬åœ°æ–¹æ³•æ ˆ<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_3-1-æœ¬åœ°æ–¹æ³•æ¥å£" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.1 æœ¬åœ°æ–¹æ³•æ¥å£"><!---->3.1 æœ¬åœ°æ–¹æ³•æ¥å£<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_3-2-æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.2 æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰"><!---->3.2 æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-å †å†…å­˜" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4. å †å†…å­˜"><!---->4. å †å†…å­˜<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-1-å†…å­˜åˆ’åˆ†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.1 å†…å­˜åˆ’åˆ†"><!---->4.1 å†…å­˜åˆ’åˆ†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-2-è®¾ç½®å †å†…å­˜å¤§å°å’Œ-oom" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.2 è®¾ç½®å †å†…å­˜å¤§å°å’Œ OOM"><!---->4.2 è®¾ç½®å †å†…å­˜å¤§å°å’Œ OOM<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-3-å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.3 å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ"><!---->4.3 å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-4-å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.4 å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹"><!---->4.4 å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-5-gc-åƒåœ¾å›æ”¶ç®€ä»‹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.5 GC åƒåœ¾å›æ”¶ç®€ä»‹"><!---->4.5 GC åƒåœ¾å›æ”¶ç®€ä»‹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-6-tlab" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.6 TLAB"><!---->4.6 TLAB<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-7-å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="4.7 å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—"><!---->4.7 å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-æ–¹æ³•åŒº" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5. æ–¹æ³•åŒº"><!---->5. æ–¹æ³•åŒº<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-1-è§£æƒ‘" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.1 è§£æƒ‘"><!---->5.1 è§£æƒ‘<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-2-è®¾ç½®æ–¹æ³•åŒºå†…å­˜çš„å¤§å°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.2 è®¾ç½®æ–¹æ³•åŒºå†…å­˜çš„å¤§å°"><!---->5.2 è®¾ç½®æ–¹æ³•åŒºå†…å­˜çš„å¤§å°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-3-æ–¹æ³•åŒºå†…éƒ¨ç»“æ„" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.3 æ–¹æ³•åŒºå†…éƒ¨ç»“æ„"><!---->5.3 æ–¹æ³•åŒºå†…éƒ¨ç»“æ„<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-4-è¿è¡Œæ—¶å¸¸é‡æ± " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.4 è¿è¡Œæ—¶å¸¸é‡æ± "><!---->5.4 è¿è¡Œæ—¶å¸¸é‡æ± <!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-5-æ–¹æ³•åŒºåœ¨-jdk6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.5 æ–¹æ³•åŒºåœ¨ JDK6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚"><!---->5.5 æ–¹æ³•åŒºåœ¨ JDK6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-6-æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="5.6 æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶"><!---->5.6 æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#å‚è€ƒæ–‡ç« " class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å‚è€ƒæ–‡ç« "><!---->å‚è€ƒæ–‡ç« <!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-heap-s.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM åŸºç¡€ - Javaå†…å­˜ç»“æ„(ç²¾ç®€ç‰ˆ)"><!---->JVM åŸºç¡€ - Javaå†…å­˜ç»“æ„(ç²¾ç®€ç‰ˆ)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-x-introduce.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹å¼•å…¥"><!---->JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹å¼•å…¥<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-jmm.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹è¯¦è§£"><!---->JVM åŸºç¡€ - Java å†…å­˜æ¨¡å‹è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc.html" class="nav-link sidebar-link sidebar-page" aria-label="GC - Java åƒåœ¾å›æ”¶åŸºç¡€çŸ¥è¯†"><!---->GC - Java åƒåœ¾å›æ”¶åŸºç¡€çŸ¥è¯†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-g1.html" class="nav-link sidebar-link sidebar-page" aria-label="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1è¯¦è§£"><!---->GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1è¯¦è§£<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-g1-supplement.html" class="nav-link sidebar-link sidebar-page" aria-label="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰"><!---->GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹G1ï¼ˆè¡¥å……ï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-cms-gc.html" class="nav-link sidebar-link sidebar-page" aria-label="GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹CMS GCé—®é¢˜åˆ†æä¸è§£å†³"><!---->GC - Java åƒåœ¾å›æ”¶å™¨ä¹‹CMS GCé—®é¢˜åˆ†æä¸è§£å†³<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-param.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - JVM è°ƒä¼˜å‚æ•°"><!---->è°ƒè¯•æ’é”™ - JVM è°ƒä¼˜å‚æ•°<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-oom.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - Java å†…å­˜åˆ†æä¹‹å †å†…å­˜å’ŒMetaSpaceå†…å­˜"><!---->è°ƒè¯•æ’é”™ - Java å†…å­˜åˆ†æä¹‹å †å†…å­˜å’ŒMetaSpaceå†…å­˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-oom-offheap.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - Java å†…å­˜åˆ†æä¹‹å †å¤–å†…å­˜"><!---->è°ƒè¯•æ’é”™ - Java å†…å­˜åˆ†æä¹‹å †å¤–å†…å­˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-thread-dump.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - Java çº¿ç¨‹åˆ†æä¹‹çº¿ç¨‹Dumpåˆ†æ"><!---->è°ƒè¯•æ’é”™ - Java çº¿ç¨‹åˆ†æä¹‹çº¿ç¨‹Dumpåˆ†æ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-oom-tool.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹JVMå¯è§†åŒ–å·¥å…·"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹JVMå¯è§†åŒ–å·¥å…·<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-agent-arthas.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹åº”ç”¨åœ¨çº¿è°ƒè¯•Arthas"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹åº”ç”¨åœ¨çº¿è°ƒè¯•Arthas<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-debug-idea.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹ä½¿ç”¨IDEAæœ¬åœ°è°ƒè¯•å’Œè¿œç¨‹è°ƒè¯•"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹ä½¿ç”¨IDEAæœ¬åœ°è°ƒè¯•å’Œè¿œç¨‹è°ƒè¯•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-agent-usage.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - JavaåŠ¨æ€è°ƒè¯•æŠ€æœ¯åŸç†"><!---->è°ƒè¯•æ’é”™ - JavaåŠ¨æ€è°ƒè¯•æŠ€æœ¯åŸç†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-help.html" class="nav-link sidebar-link sidebar-page" aria-label="GCä¸­å¯¹è±¡è‡ªæ•‘"><!---->GCä¸­å¯¹è±¡è‡ªæ•‘<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-log.html" class="nav-link sidebar-link sidebar-page" aria-label="gcæ—¥å¿—åˆ†æ"><!---->gcæ—¥å¿—åˆ†æ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-optimization-size.html" class="nav-link sidebar-link sidebar-page" aria-label="Javaå †è®¾ç½®å¤šå¤§åˆé€‚"><!---->Javaå †è®¾ç½®å¤šå¤§åˆé€‚<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-adapter.html" class="nav-link sidebar-link sidebar-page" aria-label="Javaå¦‚ä½•é€‰æ‹©åˆé€‚çš„åƒåœ¾å›æ”¶å™¨"><!---->Javaå¦‚ä½•é€‰æ‹©åˆé€‚çš„åƒåœ¾å›æ”¶å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-tools-overview.html" class="nav-link sidebar-link sidebar-page" aria-label="JDKç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ±‡æ€»"><!---->JDKç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·æ±‡æ€»<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-optimization-jstack.html" class="nav-link sidebar-link sidebar-page" aria-label="jstackç­‰å‘½ä»¤çš„å®ç°åŸç†"><!---->jstackç­‰å‘½ä»¤çš„å®ç°åŸç†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-dispatch.html" class="nav-link sidebar-link sidebar-page" aria-label="JVM å†…å­˜åˆ†é…ä¸å›æ”¶"><!---->JVM å†…å­˜åˆ†é…ä¸å›æ”¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-tools-visualvm.html" class="nav-link sidebar-link sidebar-page" aria-label="macç‰ˆideaé…ç½®visualvm"><!---->macç‰ˆideaé…ç½®visualvm<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-tools-mat-use.html" class="nav-link sidebar-link sidebar-page" aria-label="MATä½¿ç”¨"><!---->MATä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-tools-mat.html" class="nav-link sidebar-link sidebar-page" aria-label="MATå®‰è£…"><!---->MATå®‰è£…<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-tools-mat-shallow.html" class="nav-link sidebar-link sidebar-page" aria-label="Shallow heapå’ŒRetained heap"><!---->Shallow heapå’ŒRetained heap<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-classload-tomcat.html" class="nav-link sidebar-link sidebar-page" aria-label="tomcatç±»åŠ è½½å™¨"><!---->tomcatç±»åŠ è½½å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-overview.html" class="nav-link sidebar-link sidebar-page" aria-label="åƒåœ¾æ”¶é›†å™¨"><!---->åƒåœ¾æ”¶é›†å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-orth.html" class="nav-link sidebar-link sidebar-page" aria-label="åƒåœ¾æ”¶é›†å™¨åƒåœ¾æ”¶é›†ç®—æ³•"><!---->åƒåœ¾æ”¶é›†å™¨åƒåœ¾æ”¶é›†ç®—æ³•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-optimization.html" class="nav-link sidebar-link sidebar-page" aria-label="å¦‚ä½•åˆç†çš„è§„åˆ’ JVM æ€§èƒ½è°ƒä¼˜"><!---->å¦‚ä½•åˆç†çš„è§„åˆ’ JVM æ€§èƒ½è°ƒä¼˜<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-object-die.html" class="nav-link sidebar-link sidebar-page" aria-label="å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ"><!---->å¯¹è±¡å·²ç»æ­»äº¡ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-classload1.html" class="nav-link sidebar-link sidebar-page" aria-label="ç±»åŠ è½½å™¨"><!---->ç±»åŠ è½½å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-classload-interview.html" class="nav-link sidebar-link sidebar-page" aria-label="ç±»åŠ è½½å™¨ï¼ˆå¸¸è§é¢è¯•ï¼‰"><!---->ç±»åŠ è½½å™¨ï¼ˆå¸¸è§é¢è¯•ï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/jvm.html" class="nav-link sidebar-link sidebar-page" aria-label="ç±»åŠ è½½è¿‡ç¨‹"><!---->ç±»åŠ è½½è¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-classload-simplify.html" class="nav-link sidebar-link sidebar-page" aria-label="ç±»åŠ è½½è¿‡ç¨‹(ç²¾ç®€ç‰ˆ)"><!---->ç±»åŠ è½½è¿‡ç¨‹(ç²¾ç®€ç‰ˆ)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-gc-fullgc.html" class="nav-link sidebar-link sidebar-page" aria-label="çº¿ä¸Šå¦‚ä½•æ’æŸ¥FullGC(ç³»ç»Ÿ CPU çªç„¶é£™å‡ä¸” GC é¢‘ç¹ï¼Œä½ è¯¥å¦‚ä½•æ’æŸ¥)"><!---->çº¿ä¸Šå¦‚ä½•æ’æŸ¥FullGC(ç³»ç»Ÿ CPU çªç„¶é£™å‡ä¸” GC é¢‘ç¹ï¼Œä½ è¯¥å¦‚ä½•æ’æŸ¥)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-tools-mat-peoject.html" class="nav-link sidebar-link sidebar-page" aria-label="è®°ä¸€æ¬¡MATåˆ†æçº¿ä¸Šé¡¹ç›®è¿‡ç¨‹"><!---->è®°ä¸€æ¬¡MATåˆ†æçº¿ä¸Šé¡¹ç›®è¿‡ç¨‹<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-debug-tools-linux.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹Linuxå‘½ä»¤"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹Linuxå‘½ä»¤<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/java/jvm/java-jvm-debug-tools-list.html" class="nav-link sidebar-link sidebar-page" aria-label="è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹å·¥å…·å•"><!---->è°ƒè¯•æ’é”™ - Java é—®é¢˜æ’æŸ¥ä¹‹å·¥å…·å•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><!----><span class="title">Java-ç¼–è¯‘</span><span class="arrow right"></span></button><!----></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" localizeddate="2022å¹´12æœˆ24æ—¥" isoriginal="false" pageview="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="/about-the-author/" target="_blank" rel="noopener noreferrer">Abel sun</a></span><span property="author" content="Abel sun"></span></span><!----><span class="date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down" isoriginal="false" pageview="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>2022å¹´12æœˆ24æ—¥</span><meta property="datePublished" content="2022-12-24T07:29:06.000Z"></span><span class="category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down" localizeddate="2022å¹´12æœˆ24æ—¥" isoriginal="false" pageview="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li class="category category4 clickable" role="navigation">Java</li><li class="category category1 clickable" role="navigation">JVM</li><meta property="articleSection" content="Java,JVM"></ul></span><!----><span class="words-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down" localizeddate="2022å¹´12æœˆ24æ—¥" isoriginal="false" pageview="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 14358 å­—</span><meta property="wordCount" content="14358"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" localizeddate="2022å¹´12æœˆ24æ—¥" isoriginal="false" pageview="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 48 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT48M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_0-è¿è¡Œæ—¶æ•°æ®åŒº" class="router-link-active router-link-exact-active toc-link level2">0. è¿è¡Œæ—¶æ•°æ®åŒº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_1-ç¨‹åºè®¡æ•°å™¨" class="router-link-active router-link-exact-active toc-link level2">1. ç¨‹åºè®¡æ•°å™¨</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_1-1-ä½œç”¨" class="router-link-active router-link-exact-active toc-link level3">1.1 ä½œç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_1-2-æ¦‚è¿°" class="router-link-active router-link-exact-active toc-link level3">1.2 æ¦‚è¿°</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-è™šæ‹Ÿæœºæ ˆ" class="router-link-active router-link-exact-active toc-link level2">2. è™šæ‹Ÿæœºæ ˆ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-1-æ¦‚è¿°" class="router-link-active router-link-exact-active toc-link level3">2.1 æ¦‚è¿°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-2-æ ˆçš„å­˜å‚¨å•ä½" class="router-link-active router-link-exact-active toc-link level3">2.2 æ ˆçš„å­˜å‚¨å•ä½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-3-æ ˆè¿è¡ŒåŸç†" class="router-link-active router-link-exact-active toc-link level3">2.3 æ ˆè¿è¡ŒåŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_2-4-æ ˆå¸§çš„å†…éƒ¨ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">2.4 æ ˆå¸§çš„å†…éƒ¨ç»“æ„</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_3-æœ¬åœ°æ–¹æ³•æ ˆ" class="router-link-active router-link-exact-active toc-link level2">3. æœ¬åœ°æ–¹æ³•æ ˆ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_3-1-æœ¬åœ°æ–¹æ³•æ¥å£" class="router-link-active router-link-exact-active toc-link level3">3.1 æœ¬åœ°æ–¹æ³•æ¥å£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_3-2-æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" class="router-link-active router-link-exact-active toc-link level3">3.2 æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-å †å†…å­˜" class="router-link-active router-link-exact-active toc-link level2">4. å †å†…å­˜</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-1-å†…å­˜åˆ’åˆ†" class="router-link-active router-link-exact-active toc-link level3">4.1 å†…å­˜åˆ’åˆ†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-2-è®¾ç½®å †å†…å­˜å¤§å°å’Œ-oom" class="router-link-active router-link-exact-active toc-link level3">4.2 è®¾ç½®å †å†…å­˜å¤§å°å’Œ OOM</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-3-å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" class="router-link-active router-link-exact-active toc-link level3">4.3 å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-4-å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level3">4.4 å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-5-gc-åƒåœ¾å›æ”¶ç®€ä»‹" class="router-link-active router-link-exact-active toc-link level3">4.5 GC åƒåœ¾å›æ”¶ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-6-tlab" class="router-link-active router-link-exact-active toc-link level3">4.6 TLAB</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_4-7-å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" class="router-link-active router-link-exact-active toc-link level3">4.7 å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-æ–¹æ³•åŒº" class="router-link-active router-link-exact-active toc-link level2">5. æ–¹æ³•åŒº</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-1-è§£æƒ‘" class="router-link-active router-link-exact-active toc-link level3">5.1 è§£æƒ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-2-è®¾ç½®æ–¹æ³•åŒºå†…å­˜çš„å¤§å°" class="router-link-active router-link-exact-active toc-link level3">5.2 è®¾ç½®æ–¹æ³•åŒºå†…å­˜çš„å¤§å°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-3-æ–¹æ³•åŒºå†…éƒ¨ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">5.3 æ–¹æ³•åŒºå†…éƒ¨ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-4-è¿è¡Œæ—¶å¸¸é‡æ± " class="router-link-active router-link-exact-active toc-link level3">5.4 è¿è¡Œæ—¶å¸¸é‡æ± </a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-5-æ–¹æ³•åŒºåœ¨-jdk6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚" class="router-link-active router-link-exact-active toc-link level3">5.5 æ–¹æ³•åŒºåœ¨ JDK6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#_5-6-æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶" class="router-link-active router-link-exact-active toc-link level3">5.6 æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/java/jvm/java-jvm-struct.html#å‚è€ƒæ–‡ç« " class="router-link-active router-link-exact-active toc-link level2">å‚è€ƒæ–‡ç« </a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="jvm-åŸºç¡€-jvm-å†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#jvm-åŸºç¡€-jvm-å†…å­˜ç»“æ„" aria-hidden="true">#</a> JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„</h1><blockquote><p>æœ¬æ–‡ä¸»è¦å¯¹JVM å†…å­˜ç»“æ„è¿›è¡Œè®²è§£ï¼Œæ³¨æ„ä¸è¦å’ŒJavaå†…å­˜æ¨¡å‹æ··æ·†äº†ã€‚</p></blockquote><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820213459433.png" alt="image-20220820213459433"></p><h2 id="_0-è¿è¡Œæ—¶æ•°æ®åŒº" tabindex="-1"><a class="header-anchor" href="#_0-è¿è¡Œæ—¶æ•°æ®åŒº" aria-hidden="true">#</a> 0. è¿è¡Œæ—¶æ•°æ®åŒº</h2><p>å†…å­˜æ˜¯éå¸¸é‡è¦çš„ç³»ç»Ÿèµ„æºï¼Œæ˜¯ç¡¬ç›˜å’Œ CPU çš„ä¸­é—´ä»“åº“åŠæ¡¥æ¢ï¼Œæ‰¿è½½ç€æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„å®æ—¶è¿è¡Œã€‚JVM å†…å­˜å¸ƒå±€è§„å®šäº† Java åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å†…å­˜ç”³è¯·ã€åˆ†é…ã€ç®¡ç†çš„ç­–ç•¥ï¼Œä¿è¯äº† JVM çš„é«˜æ•ˆç¨³å®šè¿è¡Œã€‚ä¸åŒçš„ JVM å¯¹äºå†…å­˜çš„åˆ’åˆ†æ–¹å¼å’Œç®¡ç†æœºåˆ¶å­˜åœ¨ç€éƒ¨åˆ†å·®å¼‚ã€‚</p><p>ä¸‹å›¾æ˜¯ JVM æ•´ä½“æ¶æ„ï¼Œä¸­é—´éƒ¨åˆ†å°±æ˜¯ Java è™šæ‹Ÿæœºå®šä¹‰çš„å„ç§è¿è¡Œæ—¶æ•°æ®åŒºåŸŸã€‚</p><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820213758660.png" alt="image-20220820213758660"></p><p>Java è™šæ‹Ÿæœºå®šä¹‰äº†è‹¥å¹²ç§ç¨‹åºè¿è¡ŒæœŸé—´ä¼šä½¿ç”¨åˆ°çš„è¿è¡Œæ—¶æ•°æ®åŒºï¼Œå…¶ä¸­æœ‰ä¸€äº›ä¼šéšç€è™šæ‹Ÿæœºå¯åŠ¨è€Œåˆ›å»ºï¼Œéšç€è™šæ‹Ÿæœºé€€å‡ºè€Œé”€æ¯ã€‚å¦å¤–ä¸€äº›åˆ™æ˜¯ä¸çº¿ç¨‹ä¸€ä¸€å¯¹åº”çš„ï¼Œè¿™äº›ä¸çº¿ç¨‹ä¸€ä¸€å¯¹åº”çš„æ•°æ®åŒºåŸŸä¼šéšç€çº¿ç¨‹å¼€å§‹å’Œç»“æŸè€Œåˆ›å»ºå’Œé”€æ¯ã€‚</p><ul><li><strong>çº¿ç¨‹ç§æœ‰</strong>ï¼šç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•åŒº</li><li><strong>çº¿ç¨‹å…±äº«</strong>ï¼šå †ã€æ–¹æ³•åŒº, å †å¤–å†…å­˜ï¼ˆJava7çš„æ°¸ä¹…ä»£æˆ–JDK8çš„å…ƒç©ºé—´ã€ä»£ç ç¼“å­˜ï¼‰</li></ul><blockquote><p>ä¸‹é¢æˆ‘ä»¬å°±æ¥ä¸€ä¸€è§£è¯»ä¸‹è¿™äº›å†…å­˜åŒºåŸŸï¼Œå…ˆä»æœ€ç®€å•çš„å…¥æ‰‹</p></blockquote><h2 id="_1-ç¨‹åºè®¡æ•°å™¨" tabindex="-1"><a class="header-anchor" href="#_1-ç¨‹åºè®¡æ•°å™¨" aria-hidden="true">#</a> 1. ç¨‹åºè®¡æ•°å™¨</h2><p>ç¨‹åºè®¡æ•°å¯„å­˜å™¨ï¼ˆ<strong>Program Counter Register</strong>ï¼‰ï¼ŒRegister çš„å‘½åæºäº CPU çš„å¯„å­˜å™¨ï¼Œå¯„å­˜å™¨å­˜å‚¨æŒ‡ä»¤ç›¸å…³çš„çº¿ç¨‹ä¿¡æ¯ï¼ŒCPU åªæœ‰æŠŠæ•°æ®è£…è½½åˆ°å¯„å­˜å™¨æ‰èƒ½å¤Ÿè¿è¡Œã€‚</p><p>è¿™é‡Œï¼Œå¹¶éæ˜¯å¹¿ä¹‰ä¸Šæ‰€æŒ‡çš„ç‰©ç†å¯„å­˜å™¨ï¼Œå«ç¨‹åºè®¡æ•°å™¨ï¼ˆæˆ–PCè®¡æ•°å™¨æˆ–æŒ‡ä»¤è®¡æ•°å™¨ï¼‰ä¼šæ›´åŠ è´´åˆ‡ï¼Œå¹¶ä¸”ä¹Ÿä¸å®¹æ˜“å¼•èµ·ä¸€äº›ä¸å¿…è¦çš„è¯¯ä¼šã€‚<strong>JVM ä¸­çš„ PC å¯„å­˜å™¨æ˜¯å¯¹ç‰©ç† PC å¯„å­˜å™¨çš„ä¸€ç§æŠ½è±¡æ¨¡æ‹Ÿ</strong>ã€‚</p><p>ç¨‹åºè®¡æ•°å™¨æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„<strong>è¡Œå·æŒ‡ç¤ºå™¨</strong>ã€‚</p><h3 id="_1-1-ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#_1-1-ä½œç”¨" aria-hidden="true">#</a> 1.1 ä½œç”¨</h3><p>PC å¯„å­˜å™¨ç”¨æ¥å­˜å‚¨æŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œå³å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤ä»£ç ã€‚ç”±æ‰§è¡Œå¼•æ“è¯»å–ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚</p><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820214723695.png" alt="image-20220820214723695"></p><p>ï¼ˆåˆ†æï¼šè¿›å…¥classæ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œæ‰§è¡Œ <code>javap -v xx.class</code> åè§£æï¼ˆæˆ–è€…é€šè¿‡ IDEA æ’ä»¶ <code>Jclasslib</code> ç›´æ¥æŸ¥çœ‹ï¼Œä¸Šå›¾ï¼‰ï¼Œå¯ä»¥çœ‹åˆ°å½“å‰ç±»å¯¹åº”çš„CodeåŒºï¼ˆæ±‡ç¼–æŒ‡ä»¤ï¼‰ã€æœ¬åœ°å˜é‡è¡¨ã€å¼‚å¸¸è¡¨å’Œä»£ç è¡Œåç§»é‡æ˜ å°„è¡¨ã€å¸¸é‡æ± ç­‰ä¿¡æ¯ã€‚ï¼‰</p><p>å…³äºç±»çš„å­—èŠ‚ç ç›¸å…³å¯ä»¥çœ‹ï¼š<a href="https://pdai.tech/md/java/jvm/java-jvm-class.html" target="_blank" rel="noopener noreferrer">JVMåŸºç¡€ - ç±»å­—èŠ‚ç è¯¦è§£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_1-2-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_1-2-æ¦‚è¿°" aria-hidden="true">#</a> 1.2 æ¦‚è¿°</h3><blockquote><p>é€šè¿‡ä¸‹é¢ä¸¤ä¸ªé—®é¢˜ï¼Œç†è§£ä¸‹PCè®¡æ•°å™¨</p></blockquote><ul><li><strong>ä½¿ç”¨PCå¯„å­˜å™¨å­˜å‚¨å­—èŠ‚ç æŒ‡ä»¤åœ°å€æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿä¸ºä»€ä¹ˆä½¿ç”¨PCå¯„å­˜å™¨è®°å½•å½“å‰çº¿ç¨‹çš„æ‰§è¡Œåœ°å€å‘¢ï¼Ÿ</strong></li></ul><p>å› ä¸ºCPUéœ€è¦ä¸åœçš„åˆ‡æ¢å„ä¸ªçº¿ç¨‹ï¼Œè¿™æ—¶å€™åˆ‡æ¢å›æ¥ä»¥åï¼Œå°±å¾—çŸ¥é“æ¥ç€ä»å“ªå¼€å§‹ç»§ç»­æ‰§è¡Œã€‚JVMçš„å­—èŠ‚ç è§£é‡Šå™¨å°±éœ€è¦é€šè¿‡æ”¹å˜PCå¯„å­˜å™¨çš„å€¼æ¥æ˜ç¡®ä¸‹ä¸€æ¡åº”è¯¥æ‰§è¡Œä»€ä¹ˆæ ·çš„å­—èŠ‚ç æŒ‡ä»¤ã€‚</p><ul><li><strong>PCå¯„å­˜å™¨ä¸ºä»€ä¹ˆä¼šè¢«è®¾å®šä¸ºçº¿ç¨‹ç§æœ‰çš„ï¼Ÿ</strong></li></ul><p>å¤šçº¿ç¨‹åœ¨ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´æ®µå†…åªä¼šæ‰§è¡Œå…¶ä¸­æŸä¸€ä¸ªçº¿ç¨‹æ–¹æ³•ï¼ŒCPUä¼šä¸åœçš„åšä»»åŠ¡åˆ‡æ¢ï¼Œè¿™æ ·å¿…ç„¶ä¼šå¯¼è‡´ç»å¸¸ä¸­æ–­æˆ–æ¢å¤ã€‚ä¸ºäº†èƒ½å¤Ÿå‡†ç¡®çš„è®°å½•å„ä¸ªçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„å½“å‰å­—èŠ‚ç æŒ‡ä»¤åœ°å€ï¼Œæ‰€ä»¥ä¸ºæ¯ä¸ªçº¿ç¨‹éƒ½åˆ†é…äº†ä¸€ä¸ªPCå¯„å­˜å™¨ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½ç‹¬ç«‹è®¡ç®—ï¼Œä¸ä¼šäº’ç›¸å½±å“ã€‚</p><blockquote><p>ç›¸å…³æ€»ç»“å¦‚ä¸‹ï¼š</p></blockquote><ul><li>å®ƒæ˜¯ä¸€å—å¾ˆå°çš„å†…å­˜ç©ºé—´ï¼Œå‡ ä¹å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚ä¹Ÿæ˜¯è¿è¡Œé€Ÿåº¦æœ€å¿«çš„å­˜å‚¨åŒºåŸŸ</li><li>åœ¨ JVM è§„èŒƒä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰å®ƒè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´</li><li>ä»»ä½•æ—¶é—´ä¸€ä¸ªçº¿ç¨‹éƒ½åªæœ‰ä¸€ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„<strong>å½“å‰æ–¹æ³•</strong>ã€‚å¦‚æœå½“å‰çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ Java æ–¹æ³•ï¼Œç¨‹åºè®¡æ•°å™¨è®°å½•çš„æ˜¯ JVM å­—èŠ‚ç æŒ‡ä»¤åœ°å€ï¼Œå¦‚æœæ˜¯æ‰§è¡Œ native æ–¹æ³•ï¼Œåˆ™æ˜¯æœªæŒ‡å®šå€¼ï¼ˆundefinedï¼‰</li><li>å®ƒæ˜¯ç¨‹åºæ§åˆ¶æµçš„æŒ‡ç¤ºå™¨ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆ</li><li>å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤</li><li><strong>å®ƒæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨ JVM è§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½• <code>OutOfMemoryError</code> æƒ…å†µçš„åŒºåŸŸ</strong></li></ul><h2 id="_2-è™šæ‹Ÿæœºæ ˆ" tabindex="-1"><a class="header-anchor" href="#_2-è™šæ‹Ÿæœºæ ˆ" aria-hidden="true">#</a> 2. è™šæ‹Ÿæœºæ ˆ</h2><h3 id="_2-1-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_2-1-æ¦‚è¿°" aria-hidden="true">#</a> 2.1 æ¦‚è¿°</h3><blockquote><p>Java è™šæ‹Ÿæœºæ ˆ(Java Virtual Machine Stacks)ï¼Œæ—©æœŸä¹Ÿå« Java æ ˆã€‚æ¯ä¸ªçº¿ç¨‹åœ¨åˆ›å»ºçš„æ—¶å€™éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ ˆï¼Œå…¶å†…éƒ¨ä¿å­˜ä¸€ä¸ªä¸ªçš„æ ˆå¸§(Stack Frameï¼‰ï¼Œå¯¹åº”ç€ä¸€æ¬¡æ¬¡ Java æ–¹æ³•è°ƒç”¨ï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ä¸€è‡´ã€‚</p></blockquote><p><strong>ä½œç”¨</strong>ï¼šä¸»ç®¡ Java ç¨‹åºçš„è¿è¡Œï¼Œå®ƒä¿å­˜æ–¹æ³•çš„å±€éƒ¨å˜é‡ã€éƒ¨åˆ†ç»“æœï¼Œå¹¶å‚ä¸æ–¹æ³•çš„è°ƒç”¨å’Œè¿”å›ã€‚</p><p><strong>ç‰¹ç‚¹</strong>ï¼š</p><ul><li>æ ˆæ˜¯ä¸€ç§å¿«é€Ÿæœ‰æ•ˆçš„åˆ†é…å­˜å‚¨æ–¹å¼ï¼Œè®¿é—®é€Ÿåº¦ä»…æ¬¡äºç¨‹åºè®¡æ•°å™¨</li><li>JVM ç›´æ¥å¯¹è™šæ‹Ÿæœºæ ˆçš„æ“ä½œåªæœ‰ä¸¤ä¸ªï¼šæ¯ä¸ªæ–¹æ³•æ‰§è¡Œï¼Œä¼´éšç€<strong>å…¥æ ˆ</strong>ï¼ˆè¿›æ ˆ/å‹æ ˆï¼‰ï¼Œæ–¹æ³•æ‰§è¡Œç»“æŸ<strong>å‡ºæ ˆ</strong></li><li><strong>æ ˆä¸å­˜åœ¨åƒåœ¾å›æ”¶é—®é¢˜</strong></li></ul><p><strong>æ ˆä¸­å¯èƒ½å‡ºç°çš„å¼‚å¸¸</strong>ï¼š</p><p>Java è™šæ‹Ÿæœºè§„èŒƒå…è®¸ <strong>Javaè™šæ‹Ÿæœºæ ˆçš„å¤§å°æ˜¯åŠ¨æ€çš„æˆ–è€…æ˜¯å›ºå®šä¸å˜çš„</strong></p><ul><li>å¦‚æœé‡‡ç”¨å›ºå®šå¤§å°çš„ Java è™šæ‹Ÿæœºæ ˆï¼Œé‚£æ¯ä¸ªçº¿ç¨‹çš„ Java è™šæ‹Ÿæœºæ ˆå®¹é‡å¯ä»¥åœ¨çº¿ç¨‹åˆ›å»ºçš„æ—¶å€™ç‹¬ç«‹é€‰å®šã€‚å¦‚æœçº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡ Java è™šæ‹Ÿæœºæ ˆå…è®¸çš„æœ€å¤§å®¹é‡ï¼ŒJava è™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ª <strong>StackOverflowError</strong> å¼‚å¸¸</li><li>å¦‚æœ Java è™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œå¹¶ä¸”åœ¨å°è¯•æ‰©å±•çš„æ—¶å€™æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œæˆ–è€…åœ¨åˆ›å»ºæ–°çš„çº¿ç¨‹æ—¶æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å»åˆ›å»ºå¯¹åº”çš„è™šæ‹Ÿæœºæ ˆï¼Œé‚£ Java è™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ª<strong>OutOfMemoryError</strong>å¼‚å¸¸</li></ul><p>å¯ä»¥é€šè¿‡å‚æ•°<code>-Xss</code>æ¥è®¾ç½®çº¿ç¨‹çš„æœ€å¤§æ ˆç©ºé—´ï¼Œæ ˆçš„å¤§å°ç›´æ¥å†³å®šäº†å‡½æ•°è°ƒç”¨çš„æœ€å¤§å¯è¾¾æ·±åº¦ã€‚</p><p>å®˜æ–¹æä¾›çš„å‚è€ƒå·¥å…·ï¼Œå¯æŸ¥ä¸€äº›å‚æ•°å’Œæ“ä½œï¼š<a href="https://docs.oracle.com/javase/8/docs/technotes/tools/windows/java.html#BGBCIEFC" target="_blank" rel="noopener noreferrer">https://docs.oracle.com/javase/8/docs/technotes/tools/windows/java.html#BGBCIEFC<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="_2-2-æ ˆçš„å­˜å‚¨å•ä½" tabindex="-1"><a class="header-anchor" href="#_2-2-æ ˆçš„å­˜å‚¨å•ä½" aria-hidden="true">#</a> 2.2 æ ˆçš„å­˜å‚¨å•ä½</h3><p>æ ˆä¸­å­˜å‚¨ä»€ä¹ˆï¼Ÿ</p><ul><li>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„æ ˆï¼Œæ ˆä¸­çš„æ•°æ®éƒ½æ˜¯ä»¥<strong>æ ˆå¸§ï¼ˆStack Frameï¼‰çš„æ ¼å¼å­˜åœ¨</strong></li><li>åœ¨è¿™ä¸ªçº¿ç¨‹ä¸Šæ­£åœ¨æ‰§è¡Œçš„æ¯ä¸ªæ–¹æ³•éƒ½å„è‡ªæœ‰å¯¹åº”çš„ä¸€ä¸ªæ ˆå¸§</li><li>æ ˆå¸§æ˜¯ä¸€ä¸ªå†…å­˜åŒºå—ï¼Œæ˜¯ä¸€ä¸ªæ•°æ®é›†ï¼Œç»´ç³»ç€æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­çš„å„ç§æ•°æ®ä¿¡æ¯</li></ul><h3 id="_2-3-æ ˆè¿è¡ŒåŸç†" tabindex="-1"><a class="header-anchor" href="#_2-3-æ ˆè¿è¡ŒåŸç†" aria-hidden="true">#</a> 2.3 æ ˆè¿è¡ŒåŸç†</h3><ul><li>JVM ç›´æ¥å¯¹ Java æ ˆçš„æ“ä½œåªæœ‰ä¸¤ä¸ªï¼Œå¯¹æ ˆå¸§çš„<strong>å‹æ ˆ</strong>å’Œ<strong>å‡ºæ ˆ</strong>ï¼Œéµå¾ªâ€œå…ˆè¿›åå‡º/åè¿›å…ˆå‡ºâ€åŸåˆ™</li><li>åœ¨ä¸€æ¡æ´»åŠ¨çº¿ç¨‹ä¸­ï¼Œä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šï¼Œåªä¼šæœ‰ä¸€ä¸ªæ´»åŠ¨çš„æ ˆå¸§ã€‚å³åªæœ‰å½“å‰æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•çš„æ ˆå¸§ï¼ˆ<strong>æ ˆé¡¶æ ˆå¸§</strong>ï¼‰æ˜¯æœ‰æ•ˆçš„ï¼Œè¿™ä¸ªæ ˆå¸§è¢«ç§°ä¸º<strong>å½“å‰æ ˆå¸§</strong>ï¼ˆCurrent Frameï¼‰ï¼Œä¸å½“å‰æ ˆå¸§å¯¹åº”çš„æ–¹æ³•å°±æ˜¯<strong>å½“å‰æ–¹æ³•</strong>ï¼ˆCurrent Methodï¼‰ï¼Œå®šä¹‰è¿™ä¸ªæ–¹æ³•çš„ç±»å°±æ˜¯<strong>å½“å‰ç±»</strong>ï¼ˆCurrent Classï¼‰</li><li>æ‰§è¡Œå¼•æ“è¿è¡Œçš„æ‰€æœ‰å­—èŠ‚ç æŒ‡ä»¤åªé’ˆå¯¹å½“å‰æ ˆå¸§è¿›è¡Œæ“ä½œ</li><li>å¦‚æœåœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œå¯¹åº”çš„æ–°çš„æ ˆå¸§ä¼šè¢«åˆ›å»ºå‡ºæ¥ï¼Œæ”¾åœ¨æ ˆçš„é¡¶ç«¯ï¼Œç§°ä¸ºæ–°çš„å½“å‰æ ˆå¸§</li><li>ä¸åŒçº¿ç¨‹ä¸­æ‰€åŒ…å«çš„æ ˆå¸§æ˜¯ä¸å…è®¸å­˜åœ¨ç›¸äº’å¼•ç”¨çš„ï¼Œå³ä¸å¯èƒ½åœ¨ä¸€ä¸ªæ ˆå¸§ä¸­å¼•ç”¨å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„æ ˆå¸§</li><li>å¦‚æœå½“å‰æ–¹æ³•è°ƒç”¨äº†å…¶ä»–æ–¹æ³•ï¼Œæ–¹æ³•è¿”å›ä¹‹é™…ï¼Œå½“å‰æ ˆå¸§ä¼šä¼ å›æ­¤æ–¹æ³•çš„æ‰§è¡Œç»“æœç»™å‰ä¸€ä¸ªæ ˆå¸§ï¼Œæ¥ç€ï¼Œè™šæ‹Ÿæœºä¼šä¸¢å¼ƒå½“å‰æ ˆå¸§ï¼Œä½¿å¾—å‰ä¸€ä¸ªæ ˆå¸§é‡æ–°æˆä¸ºå½“å‰æ ˆå¸§</li><li>Java æ–¹æ³•æœ‰ä¸¤ç§è¿”å›å‡½æ•°çš„æ–¹å¼ï¼Œ<strong>ä¸€ç§æ˜¯æ­£å¸¸çš„å‡½æ•°è¿”å›ï¼Œä½¿ç”¨ return æŒ‡ä»¤ï¼Œå¦ä¸€ç§æ˜¯æŠ›å‡ºå¼‚å¸¸ï¼Œä¸ç®¡ç”¨å“ªç§æ–¹å¼ï¼Œéƒ½ä¼šå¯¼è‡´æ ˆå¸§è¢«å¼¹å‡º</strong></li></ul><p>IDEA åœ¨ debug æ—¶å€™ï¼Œå¯ä»¥åœ¨ debug çª—å£çœ‹åˆ° Frames ä¸­å„ç§æ–¹æ³•çš„å‹æ ˆå’Œå‡ºæ ˆæƒ…å†µ</p><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820220155625.png" alt="image-20220820220155625"></p><h3 id="_2-4-æ ˆå¸§çš„å†…éƒ¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_2-4-æ ˆå¸§çš„å†…éƒ¨ç»“æ„" aria-hidden="true">#</a> 2.4 æ ˆå¸§çš„å†…éƒ¨ç»“æ„</h3><p>æ¯ä¸ª<strong>æ ˆå¸§</strong>ï¼ˆStack Frameï¼‰ä¸­å­˜å‚¨ç€ï¼š</p><ul><li>å±€éƒ¨å˜é‡è¡¨ï¼ˆLocal Variablesï¼‰</li><li>æ“ä½œæ•°æ ˆï¼ˆOperand Stackï¼‰(æˆ–ç§°ä¸ºè¡¨è¾¾å¼æ ˆ)</li><li>åŠ¨æ€é“¾æ¥ï¼ˆDynamic Linkingï¼‰ï¼šæŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨</li><li>æ–¹æ³•è¿”å›åœ°å€ï¼ˆReturn Addressï¼‰ï¼šæ–¹æ³•æ­£å¸¸é€€å‡ºæˆ–å¼‚å¸¸é€€å‡ºçš„åœ°å€</li><li>ä¸€äº›é™„åŠ ä¿¡æ¯</li></ul><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820220304478.png" alt="image-20220820220304478"></p><p>ç»§ç»­æ·±æŠ›æ ˆå¸§ä¸­çš„äº”éƒ¨åˆ†~~</p><h4 id="_2-4-1-å±€éƒ¨å˜é‡è¡¨" tabindex="-1"><a class="header-anchor" href="#_2-4-1-å±€éƒ¨å˜é‡è¡¨" aria-hidden="true">#</a> 2.4.1. å±€éƒ¨å˜é‡è¡¨</h4><ul><li>å±€éƒ¨å˜é‡è¡¨ä¹Ÿè¢«ç§°ä¸ºå±€éƒ¨å˜é‡æ•°ç»„æˆ–è€…æœ¬åœ°å˜é‡è¡¨</li><li>æ˜¯ä¸€ç»„å˜é‡å€¼å­˜å‚¨ç©ºé—´ï¼Œ<strong>ä¸»è¦ç”¨äºå­˜å‚¨æ–¹æ³•å‚æ•°å’Œå®šä¹‰åœ¨æ–¹æ³•ä½“å†…çš„å±€éƒ¨å˜é‡</strong>ï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨å¯çŸ¥çš„å„ç§ Java è™šæ‹Ÿæœº<strong>åŸºæœ¬æ•°æ®ç±»å‹</strong>ï¼ˆbooleanã€byteã€charã€shortã€intã€floatã€longã€doubleï¼‰ã€<strong>å¯¹è±¡å¼•ç”¨</strong>ï¼ˆreferenceç±»å‹ï¼Œå®ƒå¹¶ä¸ç­‰åŒäºå¯¹è±¡æœ¬èº«ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„å¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æ˜¯æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–å…¶ä»–ä¸æ­¤ç›¸å…³çš„ä½ç½®ï¼‰å’Œ <strong>returnAddress</strong> ç±»å‹ï¼ˆæŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼Œå·²è¢«å¼‚å¸¸è¡¨å–ä»£ï¼‰</li><li>ç”±äºå±€éƒ¨å˜é‡è¡¨æ˜¯å»ºç«‹åœ¨çº¿ç¨‹çš„æ ˆä¸Šï¼Œæ˜¯çº¿ç¨‹çš„ç§æœ‰æ•°æ®ï¼Œå› æ­¤<strong>ä¸å­˜åœ¨æ•°æ®å®‰å…¨é—®é¢˜</strong></li><li><strong>å±€éƒ¨å˜é‡è¡¨æ‰€éœ€è¦çš„å®¹é‡å¤§å°æ˜¯ç¼–è¯‘æœŸç¡®å®šä¸‹æ¥çš„</strong>ï¼Œå¹¶ä¿å­˜åœ¨æ–¹æ³•çš„ Code å±æ€§çš„ <code>maximum local variables</code> æ•°æ®é¡¹ä¸­ã€‚åœ¨æ–¹æ³•è¿è¡ŒæœŸé—´æ˜¯ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°çš„</li><li>æ–¹æ³•åµŒå¥—è°ƒç”¨çš„æ¬¡æ•°ç”±æ ˆçš„å¤§å°å†³å®šã€‚ä¸€èˆ¬æ¥è¯´ï¼Œ<strong>æ ˆè¶Šå¤§ï¼Œæ–¹æ³•åµŒå¥—è°ƒç”¨æ¬¡æ•°è¶Šå¤š</strong>ã€‚å¯¹ä¸€ä¸ªå‡½æ•°è€Œè¨€ï¼Œå®ƒçš„å‚æ•°å’Œå±€éƒ¨å˜é‡è¶Šå¤šï¼Œä½¿å¾—å±€éƒ¨å˜é‡è¡¨è†¨èƒ€ï¼Œå®ƒçš„æ ˆå¸§å°±è¶Šå¤§ï¼Œä»¥æ»¡è¶³æ–¹æ³•è°ƒç”¨æ‰€éœ€ä¼ é€’çš„ä¿¡æ¯å¢å¤§çš„éœ€æ±‚ã€‚è¿›è€Œå‡½æ•°è°ƒç”¨å°±ä¼šå ç”¨æ›´å¤šçš„æ ˆç©ºé—´ï¼Œå¯¼è‡´å…¶åµŒå¥—è°ƒç”¨æ¬¡æ•°å°±ä¼šå‡å°‘ã€‚</li><li><strong>å±€éƒ¨å˜é‡è¡¨ä¸­çš„å˜é‡åªåœ¨å½“å‰æ–¹æ³•è°ƒç”¨ä¸­æœ‰æ•ˆ</strong>ã€‚åœ¨æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºé€šè¿‡ä½¿ç”¨å±€éƒ¨å˜é‡è¡¨å®Œæˆå‚æ•°å€¼åˆ°å‚æ•°å˜é‡åˆ—è¡¨çš„ä¼ é€’è¿‡ç¨‹ã€‚å½“æ–¹æ³•è°ƒç”¨ç»“æŸåï¼Œéšç€æ–¹æ³•æ ˆå¸§çš„é”€æ¯ï¼Œå±€éƒ¨å˜é‡è¡¨ä¹Ÿä¼šéšä¹‹é”€æ¯ã€‚</li><li>å‚æ•°å€¼çš„å­˜æ”¾æ€»æ˜¯åœ¨å±€éƒ¨å˜é‡æ•°ç»„çš„ index0 å¼€å§‹ï¼Œåˆ°æ•°ç»„é•¿åº¦ -1 çš„ç´¢å¼•ç»“æŸ</li></ul><h5 id="_2-4-1-1-æ§½-slot" tabindex="-1"><a class="header-anchor" href="#_2-4-1-1-æ§½-slot" aria-hidden="true">#</a> 2.4.1.1 æ§½ Slot</h5><ul><li>å±€éƒ¨å˜é‡è¡¨æœ€åŸºæœ¬çš„å­˜å‚¨å•å…ƒæ˜¯ Slotï¼ˆå˜é‡æ§½ï¼‰</li><li>åœ¨å±€éƒ¨å˜é‡è¡¨ä¸­ï¼Œ32 ä½ä»¥å†…çš„ç±»å‹åªå ç”¨ä¸€ä¸ª Slot(åŒ…æ‹¬returnAddressç±»å‹)ï¼Œ64 ä½çš„ç±»å‹ï¼ˆlongå’Œdoubleï¼‰å ç”¨ä¸¤ä¸ªè¿ç»­çš„ Slot <ul><li>byteã€shortã€char åœ¨å­˜å‚¨å‰è¢«è½¬æ¢ä¸ºintï¼Œbooleanä¹Ÿè¢«è½¬æ¢ä¸ºintï¼Œ0 è¡¨ç¤º falseï¼Œé 0 è¡¨ç¤º true</li><li>long å’Œ double åˆ™å æ®ä¸¤ä¸ª Slot</li></ul></li><li>JVM ä¼šä¸ºå±€éƒ¨å˜é‡è¡¨ä¸­çš„æ¯ä¸€ä¸ª Slot éƒ½åˆ†é…ä¸€ä¸ªè®¿é—®ç´¢å¼•ï¼Œé€šè¿‡è¿™ä¸ªç´¢å¼•å³å¯æˆåŠŸè®¿é—®åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­æŒ‡å®šçš„å±€éƒ¨å˜é‡å€¼ï¼Œç´¢å¼•å€¼çš„èŒƒå›´ä» 0 å¼€å§‹åˆ°å±€éƒ¨å˜é‡è¡¨æœ€å¤§çš„ Slot æ•°é‡</li><li>å½“ä¸€ä¸ªå®ä¾‹æ–¹æ³•è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œå®ƒçš„æ–¹æ³•å‚æ•°å’Œæ–¹æ³•ä½“å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡å°†ä¼š<strong>æŒ‰ç…§é¡ºåºè¢«å¤åˆ¶</strong>åˆ°å±€éƒ¨å˜é‡è¡¨ä¸­çš„æ¯ä¸€ä¸ª Slot ä¸Š</li><li><strong>å¦‚æœéœ€è¦è®¿é—®å±€éƒ¨å˜é‡è¡¨ä¸­ä¸€ä¸ª 64bit çš„å±€éƒ¨å˜é‡å€¼æ—¶ï¼Œåªéœ€è¦ä½¿ç”¨å‰ä¸€ä¸ªç´¢å¼•å³å¯</strong>ã€‚ï¼ˆæ¯”å¦‚ï¼šè®¿é—® long æˆ– double ç±»å‹å˜é‡ï¼Œä¸å…è®¸é‡‡ç”¨ä»»ä½•æ–¹å¼å•ç‹¬è®¿é—®å…¶ä¸­çš„æŸä¸€ä¸ª Slotï¼‰</li><li>å¦‚æœå½“å‰å¸§æ˜¯ç”±æ„é€ æ–¹æ³•æˆ–å®ä¾‹æ–¹æ³•åˆ›å»ºçš„ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡å¼•ç”¨ this å°†ä¼šå­˜æ”¾åœ¨ index ä¸º 0 çš„ Slot å¤„ï¼Œå…¶ä½™çš„å‚æ•°æŒ‰ç…§å‚æ•°è¡¨é¡ºåºç»§ç»­æ’åˆ—ï¼ˆè¿™é‡Œå°±å¼•å‡ºä¸€ä¸ªé—®é¢˜ï¼šé™æ€æ–¹æ³•ä¸­ä¸ºä»€ä¹ˆä¸å¯ä»¥å¼•ç”¨ thisï¼Œå°±æ˜¯å› ä¸ºthis å˜é‡ä¸å­˜åœ¨äºå½“å‰æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ä¸­ï¼‰</li><li><strong>æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ä¸­çš„æ§½ä½æ˜¯å¯ä»¥é‡ç”¨çš„</strong>ï¼Œå¦‚æœä¸€ä¸ªå±€éƒ¨å˜é‡è¿‡äº†å…¶ä½œç”¨åŸŸï¼Œé‚£ä¹ˆåœ¨å…¶ä½œç”¨åŸŸä¹‹åç”³æ˜çš„æ–°çš„å±€éƒ¨å˜é‡å°±å¾ˆæœ‰å¯èƒ½ä¼šå¤ç”¨è¿‡æœŸå±€éƒ¨å˜é‡çš„æ§½ä½ï¼Œä»è€Œ<strong>è¾¾åˆ°èŠ‚çœèµ„æºçš„ç›®çš„</strong>ã€‚ï¼ˆä¸‹å›¾ä¸­ï¼Œthisã€aã€bã€c ç†è®ºä¸Šåº”è¯¥æœ‰ 4 ä¸ªå˜é‡ï¼Œc å¤ç”¨äº† b çš„æ§½ï¼‰</li></ul><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820220351757.png" alt="image-20220820220351757"></p><ul><li>åœ¨æ ˆå¸§ä¸­ï¼Œä¸æ€§èƒ½è°ƒä¼˜å…³ç³»æœ€ä¸ºå¯†åˆ‡çš„å°±æ˜¯å±€éƒ¨å˜é‡è¡¨ã€‚åœ¨æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºä½¿ç”¨å±€éƒ¨å˜é‡è¡¨å®Œæˆæ–¹æ³•çš„ä¼ é€’</li><li><strong>å±€éƒ¨å˜é‡è¡¨ä¸­çš„å˜é‡ä¹Ÿæ˜¯é‡è¦çš„åƒåœ¾å›æ”¶æ ¹èŠ‚ç‚¹ï¼Œåªè¦è¢«å±€éƒ¨å˜é‡è¡¨ä¸­ç›´æ¥æˆ–é—´æ¥å¼•ç”¨çš„å¯¹è±¡éƒ½ä¸ä¼šè¢«å›æ”¶</strong></li></ul><h4 id="_2-4-2-æ“ä½œæ•°æ ˆ" tabindex="-1"><a class="header-anchor" href="#_2-4-2-æ“ä½œæ•°æ ˆ" aria-hidden="true">#</a> 2.4.2. æ“ä½œæ•°æ ˆ</h4><ul><li>æ¯ä¸ªç‹¬ç«‹çš„æ ˆå¸§ä¸­é™¤äº†åŒ…å«å±€éƒ¨å˜é‡è¡¨ä¹‹å¤–ï¼Œè¿˜åŒ…å«ä¸€ä¸ª<strong>åè¿›å…ˆå‡º</strong>ï¼ˆLast-In-First-Outï¼‰çš„æ“ä½œæ•°æ ˆï¼Œä¹Ÿå¯ä»¥ç§°ä¸º<strong>è¡¨è¾¾å¼æ ˆ</strong>ï¼ˆExpression Stackï¼‰</li><li><strong>æ“ä½œæ•°æ ˆï¼Œåœ¨æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ ¹æ®å­—èŠ‚ç æŒ‡ä»¤ï¼Œå¾€æ“ä½œæ•°æ ˆä¸­å†™å…¥æ•°æ®æˆ–æå–æ•°æ®ï¼Œå³å…¥æ ˆï¼ˆpushï¼‰ã€å‡ºæ ˆï¼ˆpopï¼‰</strong></li><li>æŸäº›å­—èŠ‚ç æŒ‡ä»¤å°†å€¼å‹å…¥æ“ä½œæ•°æ ˆï¼Œå…¶ä½™çš„å­—èŠ‚ç æŒ‡ä»¤å°†æ“ä½œæ•°å–å‡ºæ ˆã€‚ä½¿ç”¨å®ƒä»¬åå†æŠŠç»“æœå‹å…¥æ ˆã€‚æ¯”å¦‚ï¼Œæ‰§è¡Œå¤åˆ¶ã€äº¤æ¢ã€æ±‚å’Œç­‰æ“ä½œ</li></ul><h5 id="_2-4-2-1-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#_2-4-2-1-æ¦‚è¿°" aria-hidden="true">#</a> 2.4.2.1 æ¦‚è¿°</h5><ul><li>æ“ä½œæ•°æ ˆï¼Œ<strong>ä¸»è¦ç”¨äºä¿å­˜è®¡ç®—è¿‡ç¨‹çš„ä¸­é—´ç»“æœï¼ŒåŒæ—¶ä½œä¸ºè®¡ç®—è¿‡ç¨‹ä¸­å˜é‡ä¸´æ—¶çš„å­˜å‚¨ç©ºé—´</strong></li><li>æ“ä½œæ•°æ ˆå°±æ˜¯ JVM æ‰§è¡Œå¼•æ“çš„ä¸€ä¸ªå·¥ä½œåŒºï¼Œå½“ä¸€ä¸ªæ–¹æ³•åˆšå¼€å§‹æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€ä¸ªæ–°çš„æ ˆå¸§ä¹Ÿä¼šéšä¹‹è¢«åˆ›å»ºå‡ºæ¥ï¼Œ<strong>æ­¤æ—¶è¿™ä¸ªæ–¹æ³•çš„æ“ä½œæ•°æ ˆæ˜¯ç©ºçš„</strong></li><li>æ¯ä¸€ä¸ªæ“ä½œæ•°æ ˆéƒ½ä¼šæ‹¥æœ‰ä¸€ä¸ªæ˜ç¡®çš„æ ˆæ·±åº¦ç”¨äºå­˜å‚¨æ•°å€¼ï¼Œå…¶æ‰€éœ€çš„æœ€å¤§æ·±åº¦åœ¨ç¼–è¯‘æœŸå°±å®šä¹‰å¥½äº†ï¼Œä¿å­˜åœ¨æ–¹æ³•çš„ Code å±æ€§çš„ <code>max_stack</code> æ•°æ®é¡¹ä¸­</li><li>æ ˆä¸­çš„ä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½å¯ä»¥æ˜¯ä»»æ„çš„ Java æ•°æ®ç±»å‹ <ul><li>32bit çš„ç±»å‹å ç”¨ä¸€ä¸ªæ ˆå•ä½æ·±åº¦</li><li>64bit çš„ç±»å‹å ç”¨ä¸¤ä¸ªæ ˆå•ä½æ·±åº¦</li></ul></li><li>æ“ä½œæ•°æ ˆå¹¶éé‡‡ç”¨è®¿é—®ç´¢å¼•çš„æ–¹å¼æ¥è¿›è¡Œæ•°æ®è®¿é—®çš„ï¼Œè€Œæ˜¯åªèƒ½é€šè¿‡æ ‡å‡†çš„å…¥æ ˆå’Œå‡ºæ ˆæ“ä½œæ¥å®Œæˆä¸€æ¬¡æ•°æ®è®¿é—®</li><li><strong>å¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•å¸¦æœ‰è¿”å›å€¼çš„è¯ï¼Œå…¶è¿”å›å€¼å°†ä¼šè¢«å‹å…¥å½“å‰æ ˆå¸§çš„æ“ä½œæ•°æ ˆä¸­</strong>ï¼Œå¹¶æ›´æ–° PC å¯„å­˜å™¨ä¸­ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤</li><li>æ“ä½œæ•°æ ˆä¸­å…ƒç´ çš„æ•°æ®ç±»å‹å¿…é¡»ä¸å­—èŠ‚ç æŒ‡ä»¤çš„åºåˆ—ä¸¥æ ¼åŒ¹é…ï¼Œè¿™ç”±ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´è¿›è¡ŒéªŒè¯ï¼ŒåŒæ—¶åœ¨ç±»åŠ è½½è¿‡ç¨‹ä¸­çš„ç±»æ£€éªŒé˜¶æ®µçš„æ•°æ®æµåˆ†æé˜¶æ®µè¦å†æ¬¡éªŒè¯</li><li>å¦å¤–ï¼Œæˆ‘ä»¬è¯´<strong>Javaè™šæ‹Ÿæœºçš„è§£é‡Šå¼•æ“æ˜¯åŸºäºæ ˆçš„æ‰§è¡Œå¼•æ“</strong>ï¼Œå…¶ä¸­çš„æ ˆæŒ‡çš„å°±æ˜¯æ“ä½œæ•°æ ˆ</li></ul><h5 id="_2-4-2-2-æ ˆé¡¶ç¼“å­˜-top-of-stack-cashing" tabindex="-1"><a class="header-anchor" href="#_2-4-2-2-æ ˆé¡¶ç¼“å­˜-top-of-stack-cashing" aria-hidden="true">#</a> 2.4.2.2 æ ˆé¡¶ç¼“å­˜ï¼ˆTop-of-stack-Cashingï¼‰</h5><p>HotSpot çš„æ‰§è¡Œå¼•æ“é‡‡ç”¨çš„å¹¶éæ˜¯åŸºäºå¯„å­˜å™¨çš„æ¶æ„ï¼Œä½†è¿™å¹¶ä¸ä»£è¡¨ HotSpot VM çš„å®ç°å¹¶æ²¡æœ‰é—´æ¥åˆ©ç”¨åˆ°å¯„å­˜å™¨èµ„æºã€‚å¯„å­˜å™¨æ˜¯ç‰©ç† CPU ä¸­çš„ç»„æˆéƒ¨åˆ†ä¹‹ä¸€ï¼Œå®ƒåŒæ—¶ä¹Ÿæ˜¯ CPU ä¸­éå¸¸é‡è¦çš„é«˜é€Ÿå­˜å‚¨èµ„æºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå¯„å­˜å™¨çš„è¯»/å†™é€Ÿåº¦éå¸¸è¿…é€Ÿï¼Œç”šè‡³å¯ä»¥æ¯”å†…å­˜çš„è¯»/å†™é€Ÿåº¦å¿«ä¸Šå‡ åå€ä¸æ­¢ï¼Œä¸è¿‡å¯„å­˜å™¨èµ„æºå´éå¸¸æœ‰é™ï¼Œä¸åŒå¹³å°ä¸‹çš„CPU å¯„å­˜å™¨æ•°é‡æ˜¯ä¸åŒå’Œä¸è§„å¾‹çš„ã€‚å¯„å­˜å™¨ä¸»è¦ç”¨äºç¼“å­˜æœ¬åœ°æœºå™¨æŒ‡ä»¤ã€æ•°å€¼å’Œä¸‹ä¸€æ¡éœ€è¦è¢«æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€ç­‰æ•°æ®ã€‚</p><p>åŸºäºæ ˆå¼æ¶æ„çš„è™šæ‹Ÿæœºæ‰€ä½¿ç”¨çš„é›¶åœ°å€æŒ‡ä»¤æ›´åŠ ç´§å‡‘ï¼Œä½†å®Œæˆä¸€é¡¹æ“ä½œçš„æ—¶å€™å¿…ç„¶éœ€è¦ä½¿ç”¨æ›´å¤šçš„å…¥æ ˆå’Œå‡ºæ ˆæŒ‡ä»¤ï¼Œè¿™åŒæ—¶ä¹Ÿå°±æ„å‘³ç€å°†éœ€è¦æ›´å¤šçš„æŒ‡ä»¤åˆ†æ´¾ï¼ˆinstruction dispatchï¼‰æ¬¡æ•°å’Œå†…å­˜è¯»/å†™æ¬¡æ•°ã€‚ç”±äºæ“ä½œæ•°æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œå› æ­¤é¢‘ç¹çš„æ‰§è¡Œå†…å­˜è¯»/å†™æ“ä½œå¿…ç„¶ä¼šå½±å“æ‰§è¡Œé€Ÿåº¦ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHotSpot JVM è®¾è®¡è€…ä»¬æå‡ºäº†æ ˆé¡¶ç¼“å­˜æŠ€æœ¯ï¼Œ<strong>å°†æ ˆé¡¶å…ƒç´ å…¨éƒ¨ç¼“å­˜åœ¨ç‰©ç† CPU çš„å¯„å­˜å™¨ä¸­ï¼Œä»¥æ­¤é™ä½å¯¹å†…å­˜çš„è¯»/å†™æ¬¡æ•°ï¼Œæå‡æ‰§è¡Œå¼•æ“çš„æ‰§è¡Œæ•ˆç‡</strong></p><h4 id="_2-4-3-åŠ¨æ€é“¾æ¥-æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨" tabindex="-1"><a class="header-anchor" href="#_2-4-3-åŠ¨æ€é“¾æ¥-æŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨" aria-hidden="true">#</a> 2.4.3. åŠ¨æ€é“¾æ¥ï¼ˆæŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± çš„æ–¹æ³•å¼•ç”¨ï¼‰</h4><ul><li><strong>æ¯ä¸€ä¸ªæ ˆå¸§å†…éƒ¨éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘è¿è¡Œæ—¶å¸¸é‡æ± ä¸­è¯¥æ ˆå¸§æ‰€å±æ–¹æ³•çš„å¼•ç”¨</strong>ã€‚åŒ…å«è¿™ä¸ªå¼•ç”¨çš„ç›®çš„å°±æ˜¯ä¸ºäº†æ”¯æŒå½“å‰æ–¹æ³•çš„ä»£ç èƒ½å¤Ÿå®ç°åŠ¨æ€é“¾æ¥(Dynamic Linking)ã€‚</li><li>åœ¨ Java æºæ–‡ä»¶è¢«ç¼–è¯‘åˆ°å­—èŠ‚ç æ–‡ä»¶ä¸­æ—¶ï¼Œæ‰€æœ‰çš„å˜é‡å’Œæ–¹æ³•å¼•ç”¨éƒ½ä½œä¸º<strong>ç¬¦å·å¼•ç”¨</strong>ï¼ˆSymbolic Referenceï¼‰ä¿å­˜åœ¨ Class æ–‡ä»¶çš„å¸¸é‡æ± ä¸­ã€‚æ¯”å¦‚ï¼šæè¿°ä¸€ä¸ªæ–¹æ³•è°ƒç”¨äº†å¦å¤–çš„å…¶ä»–æ–¹æ³•æ—¶ï¼Œå°±æ˜¯é€šè¿‡å¸¸é‡æ± ä¸­æŒ‡å‘æ–¹æ³•çš„ç¬¦å·å¼•ç”¨æ¥è¡¨ç¤ºçš„ï¼Œé‚£ä¹ˆ<strong>åŠ¨æ€é“¾æ¥çš„ä½œç”¨å°±æ˜¯ä¸ºäº†å°†è¿™äº›ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨</strong></li></ul><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820222433741.png" alt="image-20220820222433741"></p><h5 id="_2-4-3-1-jvm-æ˜¯å¦‚ä½•æ‰§è¡Œæ–¹æ³•è°ƒç”¨çš„" tabindex="-1"><a class="header-anchor" href="#_2-4-3-1-jvm-æ˜¯å¦‚ä½•æ‰§è¡Œæ–¹æ³•è°ƒç”¨çš„" aria-hidden="true">#</a> 2.4.3.1 JVM æ˜¯å¦‚ä½•æ‰§è¡Œæ–¹æ³•è°ƒç”¨çš„</h5><p>æ–¹æ³•è°ƒç”¨ä¸åŒäºæ–¹æ³•æ‰§è¡Œï¼Œæ–¹æ³•è°ƒç”¨é˜¶æ®µçš„å”¯ä¸€ä»»åŠ¡å°±æ˜¯ç¡®å®šè¢«è°ƒç”¨æ–¹æ³•çš„ç‰ˆæœ¬ï¼ˆå³è°ƒç”¨å“ªä¸€ä¸ªæ–¹æ³•ï¼‰ï¼Œæš‚æ—¶è¿˜ä¸æ¶‰åŠæ–¹æ³•å†…éƒ¨çš„å…·ä½“è¿è¡Œè¿‡ç¨‹ã€‚Class æ–‡ä»¶çš„ç¼–è¯‘è¿‡ç¨‹ä¸­ä¸åŒ…æ‹¬ä¼ ç»Ÿç¼–è¯‘å™¨ä¸­çš„è¿æ¥æ­¥éª¤ï¼Œä¸€åˆ‡æ–¹æ³•è°ƒç”¨åœ¨ Classæ–‡ä»¶é‡Œé¢å­˜å‚¨çš„éƒ½æ˜¯<strong>ç¬¦å·å¼•ç”¨</strong>ï¼Œè€Œä¸æ˜¯æ–¹æ³•åœ¨å®é™…è¿è¡Œæ—¶å†…å­˜å¸ƒå±€ä¸­çš„å…¥å£åœ°å€ï¼ˆ<strong>ç›´æ¥å¼•ç”¨</strong>ï¼‰ã€‚ä¹Ÿå°±æ˜¯éœ€è¦åœ¨ç±»åŠ è½½é˜¶æ®µï¼Œç”šè‡³åˆ°è¿è¡ŒæœŸæ‰èƒ½ç¡®å®šç›®æ ‡æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ã€‚</p><blockquote><p>ã€è¿™ä¸€å—å†…å®¹ï¼Œé™¤äº†æ–¹æ³•è°ƒç”¨ï¼Œè¿˜åŒ…æ‹¬è§£æã€åˆ†æ´¾ï¼ˆé™æ€åˆ†æ´¾ã€åŠ¨æ€åˆ†æ´¾ã€å•åˆ†æ´¾ä¸å¤šåˆ†æ´¾ï¼‰ï¼Œè¿™é‡Œå…ˆä¸ä»‹ç»ï¼Œåç»­å†æŒ–ã€‘</p></blockquote><p>åœ¨ JVM ä¸­ï¼Œå°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºè°ƒç”¨æ–¹æ³•çš„ç›´æ¥å¼•ç”¨ä¸æ–¹æ³•çš„ç»‘å®šæœºåˆ¶æœ‰å…³</p><ul><li><strong>é™æ€é“¾æ¥</strong>ï¼šå½“ä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶è¢«è£…è½½è¿› JVM å†…éƒ¨æ—¶ï¼Œå¦‚æœè¢«è°ƒç”¨çš„<strong>ç›®æ ‡æ–¹æ³•åœ¨ç¼–è¯‘æœŸå¯çŸ¥</strong>ï¼Œä¸”è¿è¡ŒæœŸä¿æŒä¸å˜æ—¶ã€‚è¿™ç§æƒ…å†µä¸‹å°†è°ƒç”¨æ–¹æ³•çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºé™æ€é“¾æ¥</li><li><strong>åŠ¨æ€é“¾æ¥</strong>ï¼šå¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•åœ¨ç¼–è¯‘æœŸæ— æ³•è¢«ç¡®å®šä¸‹æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªèƒ½åœ¨ç¨‹åºè¿è¡ŒæœŸå°†è°ƒç”¨æ–¹æ³•çš„ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ï¼Œç”±äºè¿™ç§å¼•ç”¨è½¬æ¢è¿‡ç¨‹å…·å¤‡åŠ¨æ€æ€§ï¼Œå› æ­¤ä¹Ÿå°±è¢«ç§°ä¹‹ä¸ºåŠ¨æ€é“¾æ¥</li></ul><p>å¯¹åº”çš„æ–¹æ³•çš„ç»‘å®šæœºåˆ¶ä¸ºï¼šæ—©æœŸç»‘å®šï¼ˆEarly Bindingï¼‰å’Œæ™šæœŸç»‘å®šï¼ˆLate Bindingï¼‰ã€‚<strong>ç»‘å®šæ˜¯ä¸€ä¸ªå­—æ®µã€æ–¹æ³•æˆ–è€…ç±»åœ¨ç¬¦å·å¼•ç”¨è¢«æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ï¼Œè¿™ä»…ä»…å‘ç”Ÿä¸€æ¬¡</strong>ã€‚</p><ul><li>æ—©æœŸç»‘å®šï¼š<strong>æ—©æœŸç»‘å®šå°±æ˜¯æŒ‡è¢«è°ƒç”¨çš„ç›®æ ‡æ–¹æ³•å¦‚æœåœ¨ç¼–è¯‘æœŸå¯çŸ¥ï¼Œä¸”è¿è¡ŒæœŸä¿æŒä¸å˜æ—¶</strong>ï¼Œå³å¯å°†è¿™ä¸ªæ–¹æ³•ä¸æ‰€å±çš„ç±»å‹è¿›è¡Œç»‘å®šï¼Œè¿™æ ·ä¸€æ¥ï¼Œç”±äºæ˜ç¡®äº†è¢«è°ƒç”¨çš„ç›®æ ‡æ–¹æ³•ç©¶ç«Ÿæ˜¯å“ªä¸€ä¸ªï¼Œå› æ­¤ä¹Ÿå°±å¯ä»¥ä½¿ç”¨é™æ€é“¾æ¥çš„æ–¹å¼å°†ç¬¦å·å¼•ç”¨è½¬æ¢ä¸ºç›´æ¥å¼•ç”¨ã€‚</li><li>æ™šæœŸç»‘å®šï¼šå¦‚æœè¢«è°ƒç”¨çš„æ–¹æ³•åœ¨ç¼–è¯‘å™¨æ— æ³•è¢«ç¡®å®šä¸‹æ¥ï¼Œåªèƒ½å¤Ÿåœ¨ç¨‹åºè¿è¡ŒæœŸæ ¹æ®å®é™…çš„ç±»å‹ç»‘å®šç›¸å…³çš„æ–¹æ³•ï¼Œè¿™ç§ç»‘å®šæ–¹å¼å°±è¢«ç§°ä¸ºæ™šæœŸç»‘å®šã€‚</li></ul><h5 id="_2-4-3-2-è™šæ–¹æ³•å’Œéè™šæ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_2-4-3-2-è™šæ–¹æ³•å’Œéè™šæ–¹æ³•" aria-hidden="true">#</a> 2.4.3.2 è™šæ–¹æ³•å’Œéè™šæ–¹æ³•</h5><ul><li>å¦‚æœæ–¹æ³•åœ¨ç¼–è¯‘å™¨å°±ç¡®å®šäº†å…·ä½“çš„è°ƒç”¨ç‰ˆæœ¬ï¼Œè¿™ä¸ªç‰ˆæœ¬åœ¨è¿è¡Œæ—¶æ˜¯ä¸å¯å˜çš„ã€‚è¿™æ ·çš„æ–¹æ³•ç§°ä¸ºéè™šæ–¹æ³•ï¼Œæ¯”å¦‚é™æ€æ–¹æ³•ã€ç§æœ‰æ–¹æ³•ã€final æ–¹æ³•ã€å®ä¾‹æ„é€ å™¨ã€çˆ¶ç±»æ–¹æ³•éƒ½æ˜¯éè™šæ–¹æ³•</li><li>å…¶ä»–æ–¹æ³•ç§°ä¸ºè™šæ–¹æ³•</li></ul><h5 id="_2-4-3-3-è™šæ–¹æ³•è¡¨" tabindex="-1"><a class="header-anchor" href="#_2-4-3-3-è™šæ–¹æ³•è¡¨" aria-hidden="true">#</a> 2.4.3.3 è™šæ–¹æ³•è¡¨</h5><p>åœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œä¼šé¢‘ç¹çš„ä½¿ç”¨åˆ°åŠ¨æ€åˆ†æ´¾ï¼Œå¦‚æœæ¯æ¬¡åŠ¨æ€åˆ†æ´¾éƒ½è¦é‡æ–°åœ¨ç±»çš„æ–¹æ³•å…ƒæ•°æ®ä¸­æœç´¢åˆé€‚çš„ç›®æ ‡æœ‰å¯èƒ½ä¼šå½±å“åˆ°æ‰§è¡Œæ•ˆç‡ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼ŒJVM é‡‡ç”¨åœ¨ç±»çš„æ–¹æ³•åŒºå»ºç«‹ä¸€ä¸ªè™šæ–¹æ³•è¡¨ï¼ˆvirtual method tableï¼‰ï¼Œä½¿ç”¨ç´¢å¼•è¡¨æ¥ä»£æ›¿æŸ¥æ‰¾ã€‚éè™šæ–¹æ³•ä¸ä¼šå‡ºç°åœ¨è¡¨ä¸­ã€‚</p><p>æ¯ä¸ªç±»ä¸­éƒ½æœ‰ä¸€ä¸ªè™šæ–¹æ³•è¡¨ï¼Œè¡¨ä¸­å­˜æ”¾ç€å„ä¸ªæ–¹æ³•çš„å®é™…å…¥å£ã€‚</p><p>è™šæ–¹æ³•è¡¨ä¼šåœ¨ç±»åŠ è½½çš„è¿æ¥é˜¶æ®µè¢«åˆ›å»ºå¹¶å¼€å§‹åˆå§‹åŒ–ï¼Œç±»çš„å˜é‡åˆå§‹å€¼å‡†å¤‡å®Œæˆä¹‹åï¼ŒJVM ä¼šæŠŠè¯¥ç±»çš„æ–¹æ³•è¡¨ä¹Ÿåˆå§‹åŒ–å®Œæ¯•ã€‚</p><h4 id="_2-4-4-æ–¹æ³•è¿”å›åœ°å€-return-address" tabindex="-1"><a class="header-anchor" href="#_2-4-4-æ–¹æ³•è¿”å›åœ°å€-return-address" aria-hidden="true">#</a> 2.4.4. æ–¹æ³•è¿”å›åœ°å€ï¼ˆreturn addressï¼‰</h4><p>ç”¨æ¥å­˜æ”¾è°ƒç”¨è¯¥æ–¹æ³•çš„ PC å¯„å­˜å™¨çš„å€¼ã€‚</p><p>ä¸€ä¸ªæ–¹æ³•çš„ç»“æŸï¼Œæœ‰ä¸¤ç§æ–¹å¼</p><ul><li>æ­£å¸¸æ‰§è¡Œå®Œæˆ</li><li>å‡ºç°æœªå¤„ç†çš„å¼‚å¸¸ï¼Œéæ­£å¸¸é€€å‡º</li></ul><p>æ— è®ºé€šè¿‡å“ªç§æ–¹å¼é€€å‡ºï¼Œåœ¨æ–¹æ³•é€€å‡ºåéƒ½è¿”å›åˆ°è¯¥æ–¹æ³•è¢«è°ƒç”¨çš„ä½ç½®ã€‚æ–¹æ³•æ­£å¸¸é€€å‡ºæ—¶ï¼Œè°ƒç”¨è€…çš„ PC è®¡æ•°å™¨çš„å€¼ä½œä¸ºè¿”å›åœ°å€ï¼Œå³è°ƒç”¨è¯¥æ–¹æ³•çš„æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€‚è€Œé€šè¿‡å¼‚å¸¸é€€å‡ºçš„ï¼Œè¿”å›åœ°å€æ˜¯è¦é€šè¿‡å¼‚å¸¸è¡¨æ¥ç¡®å®šçš„ï¼Œæ ˆå¸§ä¸­ä¸€èˆ¬ä¸ä¼šä¿å­˜è¿™éƒ¨åˆ†ä¿¡æ¯ã€‚</p><p>å½“ä¸€ä¸ªæ–¹æ³•å¼€å§‹æ‰§è¡Œåï¼Œåªæœ‰ä¸¤ç§æ–¹å¼å¯ä»¥é€€å‡ºè¿™ä¸ªæ–¹æ³•ï¼š</p><ol><li><p>æ‰§è¡Œå¼•æ“é‡åˆ°ä»»æ„ä¸€ä¸ªæ–¹æ³•è¿”å›çš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œä¼šæœ‰è¿”å›å€¼ä¼ é€’ç»™ä¸Šå±‚çš„æ–¹æ³•è°ƒç”¨è€…ï¼Œç®€ç§°<strong>æ­£å¸¸å®Œæˆå‡ºå£</strong></p><p>ä¸€ä¸ªæ–¹æ³•çš„æ­£å¸¸è°ƒç”¨å®Œæˆä¹‹åç©¶ç«Ÿéœ€è¦ä½¿ç”¨å“ªä¸€ä¸ªè¿”å›æŒ‡ä»¤è¿˜éœ€è¦æ ¹æ®æ–¹æ³•è¿”å›å€¼çš„å®é™…æ•°æ®ç±»å‹è€Œå®š</p><p>åœ¨å­—èŠ‚ç æŒ‡ä»¤ä¸­ï¼Œè¿”å›æŒ‡ä»¤åŒ…å« ireturn(å½“è¿”å›å€¼æ˜¯ booleanã€byteã€charã€short å’Œ int ç±»å‹æ—¶ä½¿ç”¨)ã€lreturnã€freturnã€dreturn ä»¥åŠ areturnï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ª return æŒ‡ä»¤ä¾›å£°æ˜ä¸º void çš„æ–¹æ³•ã€å®ä¾‹åˆå§‹åŒ–æ–¹æ³•ã€ç±»å’Œæ¥å£çš„åˆå§‹åŒ–æ–¹æ³•ä½¿ç”¨ã€‚</p></li><li><p>åœ¨æ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­é‡åˆ°äº†å¼‚å¸¸ï¼Œå¹¶ä¸”è¿™ä¸ªå¼‚å¸¸æ²¡æœ‰åœ¨æ–¹æ³•å†…è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯åªè¦åœ¨æœ¬æ–¹æ³•çš„å¼‚å¸¸è¡¨ä¸­æ²¡æœ‰æœç´¢åˆ°åŒ¹é…çš„å¼‚å¸¸å¤„ç†å™¨ï¼Œå°±ä¼šå¯¼è‡´æ–¹æ³•é€€å‡ºã€‚ç®€ç§°<strong>å¼‚å¸¸å®Œæˆå‡ºå£</strong></p><p>æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸æ—¶çš„å¼‚å¸¸å¤„ç†ï¼Œå­˜å‚¨åœ¨ä¸€ä¸ªå¼‚å¸¸å¤„ç†è¡¨ï¼Œæ–¹ä¾¿åœ¨å‘ç”Ÿå¼‚å¸¸çš„æ—¶å€™æ‰¾åˆ°å¤„ç†å¼‚å¸¸çš„ä»£ç ã€‚</p></li></ol><p>æœ¬è´¨ä¸Šï¼Œ<strong>æ–¹æ³•çš„é€€å‡ºå°±æ˜¯å½“å‰æ ˆå¸§å‡ºæ ˆçš„è¿‡ç¨‹</strong>ã€‚æ­¤æ—¶ï¼Œéœ€è¦æ¢å¤ä¸Šå±‚æ–¹æ³•çš„å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€å°†è¿”å›å€¼å‹å…¥è°ƒç”¨è€…æ ˆå¸§çš„æ“ä½œæ•°æ ˆã€è®¾ç½®PCå¯„å­˜å™¨å€¼ç­‰ï¼Œè®©è°ƒç”¨è€…æ–¹æ³•ç»§ç»­æ‰§è¡Œä¸‹å»ã€‚</p><p>æ­£å¸¸å®Œæˆå‡ºå£å’Œå¼‚å¸¸å®Œæˆå‡ºå£çš„åŒºåˆ«åœ¨äºï¼š<strong>é€šè¿‡å¼‚å¸¸å®Œæˆå‡ºå£é€€å‡ºçš„ä¸ä¼šç»™ä»–çš„ä¸Šå±‚è°ƒç”¨è€…äº§ç”Ÿä»»ä½•çš„è¿”å›å€¼</strong></p><h4 id="_2-4-5-é™„åŠ ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_2-4-5-é™„åŠ ä¿¡æ¯" aria-hidden="true">#</a> 2.4.5. é™„åŠ ä¿¡æ¯</h4><p>æ ˆå¸§ä¸­è¿˜å…è®¸æºå¸¦ä¸ Java è™šæ‹Ÿæœºå®ç°ç›¸å…³çš„ä¸€äº›é™„åŠ ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå¯¹ç¨‹åºè°ƒè¯•æä¾›æ”¯æŒçš„ä¿¡æ¯ï¼Œä½†è¿™äº›ä¿¡æ¯å–å†³äºå…·ä½“çš„è™šæ‹Ÿæœºå®ç°ã€‚</p><h2 id="_3-æœ¬åœ°æ–¹æ³•æ ˆ" tabindex="-1"><a class="header-anchor" href="#_3-æœ¬åœ°æ–¹æ³•æ ˆ" aria-hidden="true">#</a> 3. æœ¬åœ°æ–¹æ³•æ ˆ</h2><h3 id="_3-1-æœ¬åœ°æ–¹æ³•æ¥å£" tabindex="-1"><a class="header-anchor" href="#_3-1-æœ¬åœ°æ–¹æ³•æ¥å£" aria-hidden="true">#</a> 3.1 æœ¬åœ°æ–¹æ³•æ¥å£</h3><p>ç®€å•çš„è®²ï¼Œä¸€ä¸ª Native Method å°±æ˜¯ä¸€ä¸ª Java è°ƒç”¨é Java ä»£ç çš„æ¥å£ã€‚æˆ‘ä»¬çŸ¥é“çš„ Unsafe ç±»å°±æœ‰å¾ˆå¤šæœ¬åœ°æ–¹æ³•ã€‚</p><blockquote><p>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æœ¬åœ°æ–¹æ³•ï¼ˆNative Methodï¼‰?</p></blockquote><p>Java ä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œç„¶è€Œæœ‰äº›å±‚æ¬¡çš„ä»»åŠ¡ç”¨ Java å®ç°èµ·æ¥ä¹Ÿä¸å®¹æ˜“ï¼Œæˆ–è€…æˆ‘ä»¬å¯¹ç¨‹åºçš„æ•ˆç‡å¾ˆåœ¨æ„æ—¶ï¼Œé—®é¢˜å°±æ¥äº†</p><ul><li>ä¸ Java ç¯å¢ƒå¤–äº¤äº’ï¼šæœ‰æ—¶ Java åº”ç”¨éœ€è¦ä¸ Java å¤–é¢çš„ç¯å¢ƒäº¤äº’ï¼Œè¿™å°±æ˜¯æœ¬åœ°æ–¹æ³•å­˜åœ¨çš„åŸå› ã€‚</li><li>ä¸æ“ä½œç³»ç»Ÿäº¤äº’ï¼šJVM æ”¯æŒ Java è¯­è¨€æœ¬èº«å’Œè¿è¡Œæ—¶åº“ï¼Œä½†æ˜¯æœ‰æ—¶ä»éœ€è¦ä¾èµ–ä¸€äº›åº•å±‚ç³»ç»Ÿçš„æ”¯æŒã€‚é€šè¿‡æœ¬åœ°æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°ç”¨ Java ä¸å®ç°äº† jre çš„åº•å±‚ç³»ç»Ÿäº¤äº’ï¼Œ JVM çš„ä¸€äº›éƒ¨åˆ†å°±æ˜¯ C è¯­è¨€å†™çš„ã€‚</li><li>Sun&#39;s Javaï¼šSunçš„è§£é‡Šå™¨å°±æ˜¯Cå®ç°çš„ï¼Œè¿™ä½¿å¾—å®ƒèƒ½åƒä¸€äº›æ™®é€šçš„Cä¸€æ ·ä¸å¤–éƒ¨äº¤äº’ã€‚jreå¤§éƒ¨åˆ†éƒ½æ˜¯ç”¨ Java å®ç°çš„ï¼Œå®ƒä¹Ÿé€šè¿‡ä¸€äº›æœ¬åœ°æ–¹æ³•ä¸å¤–ç•Œäº¤äº’ã€‚æ¯”å¦‚ï¼Œç±» <code>java.lang.Thread</code> çš„ <code>setPriority()</code> çš„æ–¹æ³•æ˜¯ç”¨Java å®ç°çš„ï¼Œä½†å®ƒå®ç°è°ƒç”¨çš„æ˜¯è¯¥ç±»çš„æœ¬åœ°æ–¹æ³• <code>setPrioruty()</code>ï¼Œè¯¥æ–¹æ³•æ˜¯Cå®ç°çš„ï¼Œå¹¶è¢«æ¤å…¥ JVM å†…éƒ¨ã€‚</li></ul><h3 id="_3-2-æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" tabindex="-1"><a class="header-anchor" href="#_3-2-æœ¬åœ°æ–¹æ³•æ ˆ-native-method-stack" aria-hidden="true">#</a> 3.2 æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</h3><ul><li>Java è™šæ‹Ÿæœºæ ˆç”¨äºç®¡ç† Java æ–¹æ³•çš„è°ƒç”¨ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆç”¨äºç®¡ç†æœ¬åœ°æ–¹æ³•çš„è°ƒç”¨</li><li>æœ¬åœ°æ–¹æ³•æ ˆä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„</li><li>å…è®¸çº¿ç¨‹å›ºå®šæˆ–è€…å¯åŠ¨æ€æ‰©å±•çš„å†…å­˜å¤§å° <ul><li>å¦‚æœçº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡æœ¬åœ°æ–¹æ³•æ ˆå…è®¸çš„æœ€å¤§å®¹é‡ï¼ŒJava è™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ª <code>StackOverflowError</code> å¼‚å¸¸</li><li>å¦‚æœæœ¬åœ°æ–¹æ³•æ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œå¹¶ä¸”åœ¨å°è¯•æ‰©å±•çš„æ—¶å€™æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ï¼Œæˆ–è€…åœ¨åˆ›å»ºæ–°çš„çº¿ç¨‹æ—¶æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å»åˆ›å»ºå¯¹åº”çš„æœ¬åœ°æ–¹æ³•æ ˆï¼Œé‚£ä¹ˆ Javaè™šæ‹Ÿæœºå°†ä¼šæŠ›å‡ºä¸€ä¸ª<code>OutofMemoryError</code>å¼‚å¸¸</li></ul></li><li>æœ¬åœ°æ–¹æ³•æ˜¯ä½¿ç”¨ C è¯­è¨€å®ç°çš„</li><li>å®ƒçš„å…·ä½“åšæ³•æ˜¯ <code>Native Method Stack</code> ä¸­ç™»è®° native æ–¹æ³•ï¼Œåœ¨ <code>Execution Engine</code> æ‰§è¡Œæ—¶åŠ è½½æœ¬åœ°æ–¹æ³•åº“å½“æŸä¸ªçº¿ç¨‹è°ƒç”¨ä¸€ä¸ªæœ¬åœ°æ–¹æ³•æ—¶ï¼Œå®ƒå°±è¿›å…¥äº†ä¸€ä¸ªå…¨æ–°çš„å¹¶ä¸”ä¸å†å—è™šæ‹Ÿæœºé™åˆ¶çš„ä¸–ç•Œã€‚å®ƒå’Œè™šæ‹Ÿæœºæ‹¥æœ‰åŒæ ·çš„æƒé™ã€‚</li><li>æœ¬åœ°æ–¹æ³•å¯ä»¥é€šè¿‡æœ¬åœ°æ–¹æ³•æ¥å£æ¥è®¿é—®è™šæ‹Ÿæœºå†…éƒ¨çš„è¿è¡Œæ—¶æ•°æ®åŒºï¼Œå®ƒç”šè‡³å¯ä»¥ç›´æ¥ä½¿ç”¨æœ¬åœ°å¤„ç†å™¨ä¸­çš„å¯„å­˜å™¨ï¼Œç›´æ¥ä»æœ¬åœ°å†…å­˜çš„å †ä¸­åˆ†é…ä»»æ„æ•°é‡çš„å†…å­˜</li><li>å¹¶ä¸æ˜¯æ‰€æœ‰ JVM éƒ½æ”¯æŒæœ¬åœ°æ–¹æ³•ã€‚å› ä¸º Java è™šæ‹Ÿæœºè§„èŒƒå¹¶æ²¡æœ‰æ˜ç¡®è¦æ±‚æœ¬åœ°æ–¹æ³•æ ˆçš„ä½¿ç”¨è¯­è¨€ã€å…·ä½“å®ç°æ–¹å¼ã€æ•°æ®ç»“æ„ç­‰ã€‚å¦‚æœ JVM äº§å“ä¸æ‰“ç®—æ”¯æŒ native æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æ— éœ€å®ç°æœ¬åœ°æ–¹æ³•æ ˆ</li><li>åœ¨ Hotspot JVM ä¸­ï¼Œç›´æ¥å°†æœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€</li></ul><hr><blockquote><p><strong>æ ˆæ˜¯è¿è¡Œæ—¶çš„å•ä½ï¼Œè€Œå †æ˜¯å­˜å‚¨çš„å•ä½</strong>ã€‚</p><p>æ ˆè§£å†³ç¨‹åºçš„è¿è¡Œé—®é¢˜ï¼Œå³ç¨‹åºå¦‚ä½•æ‰§è¡Œï¼Œæˆ–è€…è¯´å¦‚ä½•å¤„ç†æ•°æ®ã€‚å †è§£å†³çš„æ˜¯æ•°æ®å­˜å‚¨çš„é—®é¢˜ï¼Œå³æ•°æ®æ€ä¹ˆæ”¾ã€æ”¾åœ¨å“ªã€‚</p></blockquote><h2 id="_4-å †å†…å­˜" tabindex="-1"><a class="header-anchor" href="#_4-å †å†…å­˜" aria-hidden="true">#</a> 4. å †å†…å­˜</h2><h3 id="_4-1-å†…å­˜åˆ’åˆ†" tabindex="-1"><a class="header-anchor" href="#_4-1-å†…å­˜åˆ’åˆ†" aria-hidden="true">#</a> 4.1 å†…å­˜åˆ’åˆ†</h3><p>å¯¹äºå¤§å¤šæ•°åº”ç”¨ï¼ŒJava å †æ˜¯ Java è™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œè¢«æ‰€æœ‰çº¿ç¨‹å…±äº«ã€‚æ­¤å†…å­˜åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹ä»¥åŠæ•°æ®éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚</p><p>ä¸ºäº†è¿›è¡Œé«˜æ•ˆçš„åƒåœ¾å›æ”¶ï¼Œè™šæ‹ŸæœºæŠŠå †å†…å­˜<strong>é€»è¾‘ä¸Š</strong>åˆ’åˆ†æˆä¸‰å—åŒºåŸŸï¼ˆåˆ†ä»£çš„å”¯ä¸€ç†ç”±å°±æ˜¯ä¼˜åŒ– GC æ€§èƒ½ï¼‰ï¼š</p><ul><li>æ–°ç”Ÿä»£ï¼ˆå¹´è½»ä»£ï¼‰ï¼šæ–°å¯¹è±¡å’Œæ²¡è¾¾åˆ°ä¸€å®šå¹´é¾„çš„å¯¹è±¡éƒ½åœ¨æ–°ç”Ÿä»£</li><li>è€å¹´ä»£ï¼ˆå…»è€åŒºï¼‰ï¼šè¢«é•¿æ—¶é—´ä½¿ç”¨çš„å¯¹è±¡ï¼Œè€å¹´ä»£çš„å†…å­˜ç©ºé—´åº”è¯¥è¦æ¯”å¹´è½»ä»£æ›´å¤§</li><li>å…ƒç©ºé—´ï¼ˆJDK1.8 ä¹‹å‰å«æ°¸ä¹…ä»£ï¼‰ï¼šåƒä¸€äº›æ–¹æ³•ä¸­çš„æ“ä½œä¸´æ—¶å¯¹è±¡ç­‰ï¼ŒJDK1.8 ä¹‹å‰æ˜¯å ç”¨ JVM å†…å­˜ï¼ŒJDK1.8 ä¹‹åç›´æ¥ä½¿ç”¨ç‰©ç†å†…å­˜</li></ul><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820224711555.png" alt="image-20220820224711555"></p><p>Java è™šæ‹Ÿæœºè§„èŒƒè§„å®šï¼ŒJava å †å¯ä»¥æ˜¯å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œåªè¦é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„å³å¯ï¼Œåƒç£ç›˜ç©ºé—´ä¸€æ ·ã€‚å®ç°æ—¶ï¼Œæ—¢å¯ä»¥æ˜¯å›ºå®šå¤§å°ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯æ‰©å±•çš„ï¼Œä¸»æµè™šæ‹Ÿæœºéƒ½æ˜¯å¯æ‰©å±•çš„ï¼ˆé€šè¿‡ <code>-Xmx</code> å’Œ <code>-Xms</code> æ§åˆ¶ï¼‰ï¼Œå¦‚æœå †ä¸­æ²¡æœ‰å®Œæˆå®ä¾‹åˆ†é…ï¼Œå¹¶ä¸”å †æ— æ³•å†æ‰©å±•æ—¶ï¼Œå°±ä¼šæŠ›å‡º <code>OutOfMemoryError</code> å¼‚å¸¸ã€‚</p><h4 id="_4-1-1-å¹´è½»ä»£-young-generation" tabindex="-1"><a class="header-anchor" href="#_4-1-1-å¹´è½»ä»£-young-generation" aria-hidden="true">#</a> 4.1.1 å¹´è½»ä»£ (Young Generation)</h4><p>å¹´è½»ä»£æ˜¯æ‰€æœ‰æ–°å¯¹è±¡åˆ›å»ºçš„åœ°æ–¹ã€‚å½“å¡«å……å¹´è½»ä»£æ—¶ï¼Œæ‰§è¡Œåƒåœ¾æ”¶é›†ã€‚è¿™ç§åƒåœ¾æ”¶é›†ç§°ä¸º <strong>Minor GC</strong>ã€‚å¹´è½»ä¸€ä»£è¢«åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†â€”â€”ä¼Šç”¸å›­ï¼ˆ<strong>Eden Memory</strong>ï¼‰å’Œä¸¤ä¸ªå¹¸å­˜åŒºï¼ˆ<strong>Survivor Memory</strong>ï¼Œè¢«ç§°ä¸ºfrom/toæˆ–s0/s1ï¼‰ï¼Œé»˜è®¤æ¯”ä¾‹æ˜¯<code>8:1:1</code></p><ul><li>å¤§å¤šæ•°æ–°åˆ›å»ºçš„å¯¹è±¡éƒ½ä½äº Eden å†…å­˜ç©ºé—´ä¸­</li><li>å½“ Eden ç©ºé—´è¢«å¯¹è±¡å¡«å……æ—¶ï¼Œæ‰§è¡Œ<strong>Minor GC</strong>ï¼Œå¹¶å°†æ‰€æœ‰å¹¸å­˜è€…å¯¹è±¡ç§»åŠ¨åˆ°ä¸€ä¸ªå¹¸å­˜è€…ç©ºé—´ä¸­</li><li>Minor GC æ£€æŸ¥å¹¸å­˜è€…å¯¹è±¡ï¼Œå¹¶å°†å®ƒä»¬ç§»åŠ¨åˆ°å¦ä¸€ä¸ªå¹¸å­˜è€…ç©ºé—´ã€‚æ‰€ä»¥æ¯æ¬¡ï¼Œä¸€ä¸ªå¹¸å­˜è€…ç©ºé—´æ€»æ˜¯ç©ºçš„</li><li>ç»è¿‡å¤šæ¬¡ GC å¾ªç¯åå­˜æ´»ä¸‹æ¥çš„å¯¹è±¡è¢«ç§»åŠ¨åˆ°è€å¹´ä»£ã€‚é€šå¸¸ï¼Œè¿™æ˜¯é€šè¿‡è®¾ç½®å¹´è½»ä¸€ä»£å¯¹è±¡çš„å¹´é¾„é˜ˆå€¼æ¥å®ç°çš„ï¼Œç„¶åä»–ä»¬æ‰æœ‰èµ„æ ¼æå‡åˆ°è€ä¸€ä»£</li></ul><h4 id="_4-1-2-è€å¹´ä»£-old-generation" tabindex="-1"><a class="header-anchor" href="#_4-1-2-è€å¹´ä»£-old-generation" aria-hidden="true">#</a> 4.1.2 è€å¹´ä»£(Old Generation)</h4><p>æ—§çš„ä¸€ä»£å†…å­˜åŒ…å«é‚£äº›ç»è¿‡è®¸å¤šè½®å°å‹ GC åä»ç„¶å­˜æ´»çš„å¯¹è±¡ã€‚é€šå¸¸ï¼Œåƒåœ¾æ”¶é›†æ˜¯åœ¨è€å¹´ä»£å†…å­˜æ»¡æ—¶æ‰§è¡Œçš„ã€‚è€å¹´ä»£åƒåœ¾æ”¶é›†ç§°ä¸º ä¸»GCï¼ˆMajor GCï¼‰ï¼Œé€šå¸¸éœ€è¦æ›´é•¿çš„æ—¶é—´ã€‚</p><p>å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼ˆå¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„å¯¹è±¡ï¼‰ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯é¿å…åœ¨ Eden åŒºå’Œä¸¤ä¸ªSurvivor åŒºä¹‹é—´å‘ç”Ÿå¤§é‡çš„å†…å­˜æ‹·è´</p><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820224936999.png" alt="image-20220820224936999"></p><h4 id="_4-1-3-å…ƒç©ºé—´" tabindex="-1"><a class="header-anchor" href="#_4-1-3-å…ƒç©ºé—´" aria-hidden="true">#</a> 4.1.3 å…ƒç©ºé—´</h4><p>ä¸ç®¡æ˜¯ JDK8 ä¹‹å‰çš„æ°¸ä¹…ä»£ï¼Œè¿˜æ˜¯ JDK8 åŠä»¥åçš„å…ƒç©ºé—´ï¼Œéƒ½å¯ä»¥çœ‹ä½œæ˜¯ Java è™šæ‹Ÿæœºè§„èŒƒä¸­æ–¹æ³•åŒºçš„å®ç°ã€‚</p><p>è™½ç„¶ Java è™šæ‹Ÿæœºè§„èŒƒæŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒå´æœ‰ä¸€ä¸ªåˆ«åå« Non-Heapï¼ˆéå †ï¼‰ï¼Œç›®çš„åº”è¯¥æ˜¯ä¸ Java å †åŒºåˆ†å¼€ã€‚</p><p>æ‰€ä»¥å…ƒç©ºé—´æ”¾åœ¨åè¾¹çš„æ–¹æ³•åŒºå†è¯´ã€‚</p><h3 id="_4-2-è®¾ç½®å †å†…å­˜å¤§å°å’Œ-oom" tabindex="-1"><a class="header-anchor" href="#_4-2-è®¾ç½®å †å†…å­˜å¤§å°å’Œ-oom" aria-hidden="true">#</a> 4.2 è®¾ç½®å †å†…å­˜å¤§å°å’Œ OOM</h3><p>Java å †ç”¨äºå­˜å‚¨ Java å¯¹è±¡å®ä¾‹ï¼Œé‚£ä¹ˆå †çš„å¤§å°åœ¨ JVM å¯åŠ¨çš„æ—¶å€™å°±ç¡®å®šäº†ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>-Xmx</code> å’Œ <code>-Xms</code> æ¥è®¾å®š</p><ul><li><code>-Xms</code> ç”¨æ¥è¡¨ç¤ºå †çš„èµ·å§‹å†…å­˜ï¼Œç­‰ä»·äº <code>-XX:InitialHeapSize</code></li><li><code>-Xmx</code> ç”¨æ¥è¡¨ç¤ºå †çš„æœ€å¤§å†…å­˜ï¼Œç­‰ä»·äº <code>-XX:MaxHeapSize</code></li></ul><p>å¦‚æœå †çš„å†…å­˜å¤§å°è¶…è¿‡ <code>-Xmx</code> è®¾å®šçš„æœ€å¤§å†…å­˜ï¼Œ å°±ä¼šæŠ›å‡º <code>OutOfMemoryError</code> å¼‚å¸¸ã€‚</p><p>æˆ‘ä»¬é€šå¸¸ä¼šå°† <code>-Xmx</code> å’Œ <code>-Xms</code> ä¸¤ä¸ªå‚æ•°é…ç½®ä¸ºç›¸åŒçš„å€¼ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†èƒ½å¤Ÿåœ¨åƒåœ¾å›æ”¶æœºåˆ¶æ¸…ç†å®Œå †åŒºåä¸å†éœ€è¦é‡æ–°åˆ†éš”è®¡ç®—å †çš„å¤§å°ï¼Œä»è€Œæé«˜æ€§èƒ½</p><ul><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œåˆå§‹å †å†…å­˜å¤§å°ä¸ºï¼šç”µè„‘å†…å­˜å¤§å°/64</li><li>é»˜è®¤æƒ…å†µä¸‹ï¼Œæœ€å¤§å †å†…å­˜å¤§å°ä¸ºï¼šç”µè„‘å†…å­˜å¤§å°/4</li></ul><p>å¯ä»¥é€šè¿‡ä»£ç è·å–åˆ°æˆ‘ä»¬çš„è®¾ç½®å€¼ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ¨¡æ‹Ÿ OOMï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token comment">//è¿”å› JVM å †å¤§å°</span>
  <span class="token keyword">long</span> initalMemory <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">;</span>
  <span class="token comment">//è¿”å› JVM å †çš„æœ€å¤§å†…å­˜</span>
  <span class="token keyword">long</span> maxMemory <span class="token operator">=</span> <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">/</span><span class="token number">1024</span><span class="token punctuation">;</span>

  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-Xms : &quot;</span><span class="token operator">+</span>initalMemory <span class="token operator">+</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;-Xmx : &quot;</span><span class="token operator">+</span>maxMemory <span class="token operator">+</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»ç»Ÿå†…å­˜å¤§å°ï¼š&quot;</span> <span class="token operator">+</span> initalMemory <span class="token operator">*</span> <span class="token number">64</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">+</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»ç»Ÿå†…å­˜å¤§å°ï¼š&quot;</span> <span class="token operator">+</span> maxMemory <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">/</span> <span class="token number">1024</span> <span class="token operator">+</span> <span class="token string">&quot;G&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4-2-1-æŸ¥çœ‹-jvm-å †å†…å­˜åˆ†é…" tabindex="-1"><a class="header-anchor" href="#_4-2-1-æŸ¥çœ‹-jvm-å †å†…å­˜åˆ†é…" aria-hidden="true">#</a> 4.2.1 æŸ¥çœ‹ JVM å †å†…å­˜åˆ†é…</h4><ol><li><p>åœ¨é»˜è®¤ä¸é…ç½® JVM å †å†…å­˜å¤§å°çš„æƒ…å†µä¸‹ï¼ŒJVM æ ¹æ®é»˜è®¤å€¼æ¥é…ç½®å½“å‰å†…å­˜å¤§å°</p></li><li><p>é»˜è®¤æƒ…å†µä¸‹æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¯”ä¾‹æ˜¯ 1:2ï¼Œå¯ä»¥é€šè¿‡ <code>â€“XX:NewRatio</code> æ¥é…ç½®</p><ul><li>æ–°ç”Ÿä»£ä¸­çš„ <strong>Eden</strong>:<strong>From Survivor</strong>:<strong>To Survivor</strong> çš„æ¯”ä¾‹æ˜¯ <strong>8:1:1</strong>ï¼Œå¯ä»¥é€šè¿‡ <code>-XX:SurvivorRatio</code> æ¥é…ç½®</li></ul></li><li><p>è‹¥åœ¨ JDK 7 ä¸­å¼€å¯äº† <code>-XX:+UseAdaptiveSizePolicy</code>ï¼ŒJVM ä¼šåŠ¨æ€è°ƒæ•´ JVM å †ä¸­å„ä¸ªåŒºåŸŸçš„å¤§å°ä»¥åŠè¿›å…¥è€å¹´ä»£çš„å¹´é¾„</p><p>æ­¤æ—¶ <code>â€“XX:NewRatio</code> å’Œ <code>-XX:SurvivorRatio</code> å°†ä¼šå¤±æ•ˆï¼Œè€Œ JDK 8 æ˜¯é»˜è®¤å¼€å¯<code>-XX:+UseAdaptiveSizePolicy</code></p><p>åœ¨ JDK 8ä¸­ï¼Œ<strong>ä¸è¦éšæ„å…³é—­</strong><code>-XX:+UseAdaptiveSizePolicy</code>ï¼Œé™¤éå¯¹å †å†…å­˜çš„åˆ’åˆ†æœ‰æ˜ç¡®çš„è§„åˆ’</p></li></ol><p>æ¯æ¬¡ GC åéƒ½ä¼šé‡æ–°è®¡ç®— Edenã€From Survivorã€To Survivor çš„å¤§å°</p><p>è®¡ç®—ä¾æ®æ˜¯<strong>GCè¿‡ç¨‹</strong>ä¸­ç»Ÿè®¡çš„<strong>GCæ—¶é—´</strong>ã€<strong>ååé‡</strong>ã€<strong>å†…å­˜å ç”¨é‡</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>java -XX:+PrintFlagsFinal -version | grep HeapSize
    uintx ErgoHeapSizeLimit                         = 0                                   {product}
    uintx HeapSizePerGCThread                       = 87241520                            {product}
    uintx InitialHeapSize                          := 134217728                           {product}
    uintx LargePageHeapSizeThreshold                = 134217728                           {product}
    uintx MaxHeapSize                              := 2147483648                          {product}
java version &quot;1.8.0_211&quot;
Java(TM) SE Runtime Environment (build 1.8.0_211-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.211-b12, mixed mode)

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>$ jmap -heap è¿›ç¨‹å·
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_4-3-å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" tabindex="-1"><a class="header-anchor" href="#_4-3-å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ" aria-hidden="true">#</a> 4.3 å¯¹è±¡åœ¨å †ä¸­çš„ç”Ÿå‘½å‘¨æœŸ</h3><ol><li>åœ¨ JVM å†…å­˜æ¨¡å‹çš„å †ä¸­ï¼Œå †è¢«åˆ’åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ <ul><li>æ–°ç”Ÿä»£åˆè¢«è¿›ä¸€æ­¥åˆ’åˆ†ä¸º <strong>EdenåŒº</strong> å’Œ <strong>SurvivoråŒº</strong>ï¼ŒSurvivor åŒºç”± <strong>From Survivor</strong> å’Œ <strong>To Survivor</strong> ç»„æˆ</li></ul></li><li>å½“åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¯¹è±¡ä¼šè¢«ä¼˜å…ˆåˆ†é…åˆ°æ–°ç”Ÿä»£çš„ Eden åŒº <ul><li>æ­¤æ—¶ JVM ä¼šç»™å¯¹è±¡å®šä¹‰ä¸€ä¸ª<strong>å¯¹è±¡å¹´è½»è®¡æ•°å™¨</strong>ï¼ˆ<code>-XX:MaxTenuringThreshold</code>ï¼‰</li></ul></li><li>å½“ Eden ç©ºé—´ä¸è¶³æ—¶ï¼ŒJVM å°†æ‰§è¡Œæ–°ç”Ÿä»£çš„åƒåœ¾å›æ”¶ï¼ˆMinor GCï¼‰ <ul><li>JVM ä¼šæŠŠå­˜æ´»çš„å¯¹è±¡è½¬ç§»åˆ° Survivor ä¸­ï¼Œå¹¶ä¸”å¯¹è±¡å¹´é¾„ +1</li><li>å¯¹è±¡åœ¨ Survivor ä¸­åŒæ ·ä¹Ÿä¼šç»å† Minor GCï¼Œæ¯ç»å†ä¸€æ¬¡ Minor GCï¼Œå¯¹è±¡å¹´é¾„éƒ½ä¼š+1</li></ul></li><li>å¦‚æœåˆ†é…çš„å¯¹è±¡è¶…è¿‡äº†<code>-XX:PetenureSizeThreshold</code>ï¼Œå¯¹è±¡ä¼š<strong>ç›´æ¥è¢«åˆ†é…åˆ°è€å¹´ä»£</strong></li></ol><h3 id="_4-4-å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#_4-4-å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹" aria-hidden="true">#</a> 4.4 å¯¹è±¡çš„åˆ†é…è¿‡ç¨‹</h3><p>ä¸ºå¯¹è±¡åˆ†é…å†…å­˜æ˜¯ä¸€ä»¶éå¸¸ä¸¥è°¨å’Œå¤æ‚çš„ä»»åŠ¡ï¼ŒJVM çš„è®¾è®¡è€…ä»¬ä¸ä»…éœ€è¦è€ƒè™‘å†…å­˜å¦‚ä½•åˆ†é…ã€åœ¨å“ªé‡Œåˆ†é…ç­‰é—®é¢˜ï¼Œå¹¶ä¸”ç”±äºå†…å­˜åˆ†é…ç®—æ³•å’Œå†…å­˜å›æ”¶ç®—æ³•å¯†åˆ‡ç›¸å…³ï¼Œæ‰€ä»¥è¿˜éœ€è¦è€ƒè™‘ GC æ‰§è¡Œå®Œå†…å­˜å›æ”¶åæ˜¯å¦ä¼šåœ¨å†…å­˜ç©ºé—´ä¸­äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</p><ol><li>new çš„å¯¹è±¡å…ˆæ”¾åœ¨ä¼Šç”¸å›­åŒºï¼Œæ­¤åŒºæœ‰å¤§å°é™åˆ¶</li><li>å½“ä¼Šç”¸å›­çš„ç©ºé—´å¡«æ»¡æ—¶ï¼Œç¨‹åºåˆéœ€è¦åˆ›å»ºå¯¹è±¡ï¼ŒJVM çš„åƒåœ¾å›æ”¶å™¨å°†å¯¹ä¼Šç”¸å›­åŒºè¿›è¡Œåƒåœ¾å›æ”¶ï¼ˆMinor GCï¼‰ï¼Œå°†ä¼Šç”¸å›­åŒºä¸­çš„ä¸å†è¢«å…¶ä»–å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œé”€æ¯ã€‚å†åŠ è½½æ–°çš„å¯¹è±¡æ”¾åˆ°ä¼Šç”¸å›­åŒº</li><li>ç„¶åå°†ä¼Šç”¸å›­ä¸­çš„å‰©ä½™å¯¹è±¡ç§»åŠ¨åˆ°å¹¸å­˜è€… 0 åŒº</li><li>å¦‚æœå†æ¬¡è§¦å‘åƒåœ¾å›æ”¶ï¼Œæ­¤æ—¶ä¸Šæ¬¡å¹¸å­˜ä¸‹æ¥çš„æ”¾åˆ°å¹¸å­˜è€… 0 åŒºï¼Œå¦‚æœæ²¡æœ‰å›æ”¶ï¼Œå°±ä¼šæ”¾åˆ°å¹¸å­˜è€… 1 åŒº</li><li>å¦‚æœå†æ¬¡ç»å†åƒåœ¾å›æ”¶ï¼Œæ­¤æ—¶ä¼šé‡æ–°æ”¾å›å¹¸å­˜è€… 0 åŒºï¼Œæ¥ç€å†å»å¹¸å­˜è€… 1 åŒº</li><li>ä»€ä¹ˆæ—¶å€™æ‰ä¼šå»å…»è€åŒºå‘¢ï¼Ÿ é»˜è®¤æ˜¯ 15 æ¬¡å›æ”¶æ ‡è®°</li><li>åœ¨å…»è€åŒºï¼Œç›¸å¯¹æ‚ é—²ã€‚å½“å…»è€åŒºå†…å­˜ä¸è¶³æ—¶ï¼Œå†æ¬¡è§¦å‘ Major GCï¼Œè¿›è¡Œå…»è€åŒºçš„å†…å­˜æ¸…ç†</li><li>è‹¥å…»è€åŒºæ‰§è¡Œäº† Major GC ä¹‹åå‘ç°ä¾ç„¶æ— æ³•è¿›è¡Œå¯¹è±¡çš„ä¿å­˜ï¼Œå°±ä¼šäº§ç”Ÿ OOM å¼‚å¸¸</li></ol><h3 id="_4-5-gc-åƒåœ¾å›æ”¶ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#_4-5-gc-åƒåœ¾å›æ”¶ç®€ä»‹" aria-hidden="true">#</a> 4.5 GC åƒåœ¾å›æ”¶ç®€ä»‹</h3><h4 id="_4-5-1-minor-gcã€major-gcã€full-gc" tabindex="-1"><a class="header-anchor" href="#_4-5-1-minor-gcã€major-gcã€full-gc" aria-hidden="true">#</a> 4.5.1 Minor GCã€Major GCã€Full GC</h4><p>JVM åœ¨è¿›è¡Œ GC æ—¶ï¼Œå¹¶éæ¯æ¬¡éƒ½å¯¹å †å†…å­˜ï¼ˆæ–°ç”Ÿä»£ã€è€å¹´ä»£ï¼›æ–¹æ³•åŒºï¼‰åŒºåŸŸä¸€èµ·å›æ”¶çš„ï¼Œå¤§éƒ¨åˆ†æ—¶å€™å›æ”¶çš„éƒ½æ˜¯æŒ‡æ–°ç”Ÿä»£ã€‚</p><p>é’ˆå¯¹ HotSpot VM çš„å®ç°ï¼Œå®ƒé‡Œé¢çš„ GC æŒ‰ç…§å›æ”¶åŒºåŸŸåˆåˆ†ä¸ºä¸¤å¤§ç±»ï¼šéƒ¨åˆ†æ”¶é›†ï¼ˆPartial GCï¼‰ï¼Œæ•´å †æ”¶é›†ï¼ˆFull GCï¼‰</p><ul><li>éƒ¨åˆ†æ”¶é›†ï¼šä¸æ˜¯å®Œæ•´æ”¶é›†æ•´ä¸ª Java å †çš„åƒåœ¾æ”¶é›†ã€‚å…¶ä¸­åˆåˆ†ä¸ºï¼š <ul><li>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC/Young GCï¼‰ï¼šåªæ˜¯æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†</li><li>è€å¹´ä»£æ”¶é›†ï¼ˆMajor GC/Old GCï¼‰ï¼šåªæ˜¯è€å¹´ä»£çš„åƒåœ¾æ”¶é›† <ul><li>ç›®å‰ï¼Œåªæœ‰ CMS GC ä¼šæœ‰å•ç‹¬æ”¶é›†è€å¹´ä»£çš„è¡Œä¸º</li><li>å¾ˆå¤šæ—¶å€™ Major GC ä¼šå’Œ Full GC æ··åˆä½¿ç”¨ï¼Œéœ€è¦å…·ä½“åˆ†è¾¨æ˜¯è€å¹´ä»£å›æ”¶è¿˜æ˜¯æ•´å †å›æ”¶</li></ul></li><li>æ··åˆæ”¶é›†ï¼ˆMixed GCï¼‰ï¼šæ”¶é›†æ•´ä¸ªæ–°ç”Ÿä»£ä»¥åŠéƒ¨åˆ†è€å¹´ä»£çš„åƒåœ¾æ”¶é›† <ul><li>ç›®å‰åªæœ‰ G1 GC ä¼šæœ‰è¿™ç§è¡Œä¸º</li></ul></li></ul></li><li>æ•´å †æ”¶é›†ï¼ˆFull GCï¼‰ï¼šæ”¶é›†æ•´ä¸ª Java å †å’Œæ–¹æ³•åŒºçš„åƒåœ¾</li></ul><h3 id="_4-6-tlab" tabindex="-1"><a class="header-anchor" href="#_4-6-tlab" aria-hidden="true">#</a> 4.6 TLAB</h3><h4 id="_4-6-1-ä»€ä¹ˆæ˜¯-tlab-thread-local-allocation-buffer" tabindex="-1"><a class="header-anchor" href="#_4-6-1-ä»€ä¹ˆæ˜¯-tlab-thread-local-allocation-buffer" aria-hidden="true">#</a> 4.6.1 ä»€ä¹ˆæ˜¯ TLAB ï¼ˆThread Local Allocation Bufferï¼‰?</h4><ul><li>ä»å†…å­˜æ¨¡å‹è€Œä¸æ˜¯åƒåœ¾å›æ”¶çš„è§’åº¦ï¼Œå¯¹ Eden åŒºåŸŸç»§ç»­è¿›è¡Œåˆ’åˆ†ï¼ŒJVM ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…äº†ä¸€ä¸ªç§æœ‰ç¼“å­˜åŒºåŸŸï¼Œå®ƒåŒ…å«åœ¨ Eden ç©ºé—´å†…</li><li>å¤šçº¿ç¨‹åŒæ—¶åˆ†é…å†…å­˜æ—¶ï¼Œä½¿ç”¨ TLAB å¯ä»¥é¿å…ä¸€ç³»åˆ—çš„éçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ŒåŒæ—¶è¿˜èƒ½æå‡å†…å­˜åˆ†é…çš„ååé‡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¿™ç§å†…å­˜åˆ†é…æ–¹å¼ç§°ä¸º<strong>å¿«é€Ÿåˆ†é…ç­–ç•¥</strong></li><li>OpenJDK è¡ç”Ÿå‡ºæ¥çš„ JVM å¤§éƒ½æä¾›äº† TLAB è®¾è®¡</li></ul><h4 id="_4-6-2-ä¸ºä»€ä¹ˆè¦æœ‰-tlab" tabindex="-1"><a class="header-anchor" href="#_4-6-2-ä¸ºä»€ä¹ˆè¦æœ‰-tlab" aria-hidden="true">#</a> 4.6.2 ä¸ºä»€ä¹ˆè¦æœ‰ TLAB ?</h4><ul><li>å †åŒºæ˜¯çº¿ç¨‹å…±äº«çš„ï¼Œä»»ä½•çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®åˆ°å †åŒºä¸­çš„å…±äº«æ•°æ®</li><li>ç”±äºå¯¹è±¡å®ä¾‹çš„åˆ›å»ºåœ¨ JVM ä¸­éå¸¸é¢‘ç¹ï¼Œå› æ­¤åœ¨å¹¶å‘ç¯å¢ƒä¸‹ä»å †åŒºä¸­åˆ’åˆ†å†…å­˜ç©ºé—´æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„</li><li>ä¸ºé¿å…å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€åœ°å€ï¼Œéœ€è¦ä½¿ç”¨åŠ é”ç­‰æœºåˆ¶ï¼Œè¿›è€Œå½±å“åˆ†é…é€Ÿåº¦</li></ul><p>å°½ç®¡ä¸æ˜¯æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½èƒ½å¤Ÿåœ¨ TLAB ä¸­æˆåŠŸåˆ†é…å†…å­˜ï¼Œä½† JVM ç¡®å®æ˜¯å°† TLAB ä½œä¸ºå†…å­˜åˆ†é…çš„é¦–é€‰ã€‚</p><p>åœ¨ç¨‹åºä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>-XX:UseTLAB</code> è®¾ç½®æ˜¯å¦å¼€å¯ TLAB ç©ºé—´ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒTLAB ç©ºé—´çš„å†…å­˜éå¸¸å°ï¼Œä»…å æœ‰æ•´ä¸ª Eden ç©ºé—´çš„ 1%ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>-XX:TLABWasteTargetPercent</code> è®¾ç½® TLAB ç©ºé—´æ‰€å ç”¨ Eden ç©ºé—´çš„ç™¾åˆ†æ¯”å¤§å°ã€‚</p><p>ä¸€æ—¦å¯¹è±¡åœ¨ TLAB ç©ºé—´åˆ†é…å†…å­˜å¤±è´¥æ—¶ï¼ŒJVM å°±ä¼šå°è¯•ç€é€šè¿‡ä½¿ç”¨åŠ é”æœºåˆ¶ç¡®ä¿æ•°æ®æ“ä½œçš„åŸå­æ€§ï¼Œä»è€Œç›´æ¥åœ¨ Eden ç©ºé—´ä¸­åˆ†é…å†…å­˜ã€‚</p><h3 id="_4-7-å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" tabindex="-1"><a class="header-anchor" href="#_4-7-å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—" aria-hidden="true">#</a> 4.7 å †æ˜¯åˆ†é…å¯¹è±¡å­˜å‚¨çš„å”¯ä¸€é€‰æ‹©å—</h3><blockquote><p>éšç€ JIT ç¼–è¯‘æœŸçš„å‘å±•å’Œé€ƒé€¸åˆ†ææŠ€æœ¯çš„é€æ¸æˆç†Ÿï¼Œæ ˆä¸Šåˆ†é…ã€æ ‡é‡æ›¿æ¢ä¼˜åŒ–æŠ€æœ¯å°†ä¼šå¯¼è‡´ä¸€äº›å¾®å¦™çš„å˜åŒ–ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½åˆ†é…åˆ°å †ä¸Šä¹Ÿæ¸æ¸å˜å¾—ä¸é‚£ä¹ˆâ€œç»å¯¹â€äº†ã€‚ â€”â€”ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹</p></blockquote><h4 id="_4-7-1-é€ƒé€¸åˆ†æ" tabindex="-1"><a class="header-anchor" href="#_4-7-1-é€ƒé€¸åˆ†æ" aria-hidden="true">#</a> 4.7.1 é€ƒé€¸åˆ†æ</h4><p>*<em>é€ƒé€¸åˆ†æ(Escape Analysis)*<em>æ˜¯ç›®å‰ Java è™šæ‹Ÿæœºä¸­æ¯”è¾ƒå‰æ²¿çš„ä¼˜åŒ–æŠ€æœ¯ã€‚è¿™æ˜¯ä¸€ç§å¯ä»¥æœ‰æ•ˆå‡å°‘ Java ç¨‹åºä¸­åŒæ­¥è´Ÿè½½å’Œå†…å­˜å †åˆ†é…å‹åŠ›çš„è·¨å‡½æ•°å…¨å±€æ•°æ®æµåˆ†æç®—æ³•</em></em>ã€‚é€šè¿‡é€ƒé€¸åˆ†æï¼ŒJava Hotspot ç¼–è¯‘å™¨èƒ½å¤Ÿåˆ†æå‡ºä¸€ä¸ªæ–°çš„å¯¹è±¡çš„å¼•ç”¨çš„ä½¿ç”¨èŒƒå›´ä»è€Œå†³å®šæ˜¯å¦è¦å°†è¿™ä¸ªå¯¹è±¡åˆ†é…åˆ°å †ä¸Šã€‚</p><p>é€ƒé€¸åˆ†æçš„åŸºæœ¬è¡Œä¸ºå°±æ˜¯åˆ†æå¯¹è±¡åŠ¨æ€ä½œç”¨åŸŸï¼š</p><ul><li>å½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œå¯¹è±¡åªåœ¨æ–¹æ³•å†…éƒ¨ä½¿ç”¨ï¼Œåˆ™è®¤ä¸ºæ²¡æœ‰å‘ç”Ÿé€ƒé€¸ã€‚</li><li>å½“ä¸€ä¸ªå¯¹è±¡åœ¨æ–¹æ³•ä¸­è¢«å®šä¹‰åï¼Œå®ƒè¢«å¤–éƒ¨æ–¹æ³•æ‰€å¼•ç”¨ï¼Œåˆ™è®¤ä¸ºå‘ç”Ÿé€ƒé€¸ã€‚ä¾‹å¦‚ä½œä¸ºè°ƒç”¨å‚æ•°ä¼ é€’åˆ°å…¶ä»–åœ°æ–¹ä¸­ï¼Œç§°ä¸ºæ–¹æ³•é€ƒé€¸ã€‚</li></ul><p>ä¾‹å¦‚ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">StringBuffer</span> <span class="token function">craeteStringBuffer</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> sb<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>StringBuffer sb</code>æ˜¯ä¸€ä¸ªæ–¹æ³•å†…éƒ¨å˜é‡ï¼Œä¸Šè¿°ä»£ç ä¸­ç›´æ¥å°†sbè¿”å›ï¼Œè¿™æ ·è¿™ä¸ª StringBuffer æœ‰å¯èƒ½è¢«å…¶ä»–æ–¹æ³•æ‰€æ”¹å˜ï¼Œè¿™æ ·å®ƒçš„ä½œç”¨åŸŸå°±ä¸åªæ˜¯åœ¨æ–¹æ³•å†…éƒ¨ï¼Œè™½ç„¶å®ƒæ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œä½†æ˜¯å…¶é€ƒé€¸åˆ°äº†æ–¹æ³•å¤–éƒ¨ã€‚ç”šè‡³è¿˜æœ‰å¯èƒ½è¢«å¤–éƒ¨çº¿ç¨‹è®¿é—®åˆ°ï¼Œè­¬å¦‚èµ‹å€¼ç»™ç±»å˜é‡æˆ–å¯ä»¥åœ¨å…¶ä»–çº¿ç¨‹ä¸­è®¿é—®çš„å®ä¾‹å˜é‡ï¼Œç§°ä¸ºçº¿ç¨‹é€ƒé€¸ã€‚</p><p>ä¸Šè¿°ä»£ç å¦‚æœæƒ³è¦ <code>StringBuffer sb</code>ä¸é€ƒå‡ºæ–¹æ³•ï¼Œå¯ä»¥è¿™æ ·å†™ï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createStringBuffer</span><span class="token punctuation">(</span><span class="token class-name">String</span> s1<span class="token punctuation">,</span> <span class="token class-name">String</span> s2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token class-name">StringBuffer</span> sb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s1<span class="token punctuation">)</span><span class="token punctuation">;</span>
   sb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>s2<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">return</span> sb<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¸ç›´æ¥è¿”å› StringBufferï¼Œé‚£ä¹ˆ StringBuffer å°†ä¸ä¼šé€ƒé€¸å‡ºæ–¹æ³•ã€‚</p><p><strong>å‚æ•°è®¾ç½®ï¼š</strong></p><ul><li>åœ¨ JDK 6u23 ç‰ˆæœ¬ä¹‹åï¼ŒHotSpot ä¸­é»˜è®¤å°±å·²ç»å¼€å¯äº†é€ƒé€¸åˆ†æ</li><li>å¦‚æœä½¿ç”¨è¾ƒæ—©ç‰ˆæœ¬ï¼Œå¯ä»¥é€šè¿‡<code>-XX&quot;+DoEscapeAnalysis</code>æ˜¾å¼å¼€å¯</li></ul><p>å¼€å‘ä¸­ä½¿ç”¨å±€éƒ¨å˜é‡ï¼Œå°±ä¸è¦åœ¨æ–¹æ³•å¤–å®šä¹‰ã€‚</p><p>ä½¿ç”¨é€ƒé€¸åˆ†æï¼Œç¼–è¯‘å™¨å¯ä»¥å¯¹ä»£ç åšä¼˜åŒ–ï¼š</p><ul><li><strong>æ ˆä¸Šåˆ†é…</strong>ï¼šå°†å †åˆ†é…è½¬åŒ–ä¸ºæ ˆåˆ†é…ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨å­ç¨‹åºä¸­è¢«åˆ†é…ï¼Œè¦ä½¿æŒ‡å‘è¯¥å¯¹è±¡çš„æŒ‡é’ˆæ°¸è¿œä¸ä¼šé€ƒé€¸ï¼Œå¯¹è±¡å¯èƒ½æ˜¯æ ˆåˆ†é…çš„å€™é€‰ï¼Œè€Œä¸æ˜¯å †åˆ†é…</li><li><strong>åŒæ­¥çœç•¥</strong>ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡è¢«å‘ç°åªèƒ½ä»ä¸€ä¸ªçº¿ç¨‹è¢«è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå¯¹äºè¿™ä¸ªå¯¹è±¡çš„æ“ä½œå¯ä»¥ä¸è€ƒè™‘åŒæ­¥</li><li><strong>åˆ†ç¦»å¯¹è±¡æˆ–æ ‡é‡æ›¿æ¢</strong>ï¼šæœ‰çš„å¯¹è±¡å¯èƒ½ä¸éœ€è¦ä½œä¸ºä¸€ä¸ªè¿ç»­çš„å†…å­˜ç»“æ„å­˜åœ¨ä¹Ÿå¯ä»¥è¢«è®¿é—®åˆ°ï¼Œé‚£ä¹ˆå¯¹è±¡çš„éƒ¨åˆ†ï¼ˆæˆ–å…¨éƒ¨ï¼‰å¯ä»¥ä¸å­˜å‚¨åœ¨å†…å­˜ï¼Œè€Œå­˜å‚¨åœ¨ CPU å¯„å­˜å™¨</li></ul><p>JIT ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸé—´æ ¹æ®é€ƒé€¸åˆ†æçš„ç»“æœï¼Œå‘ç°å¦‚æœä¸€ä¸ªå¯¹è±¡å¹¶æ²¡æœ‰é€ƒé€¸å‡ºæ–¹æ³•çš„è¯ï¼Œå°±å¯èƒ½è¢«ä¼˜åŒ–æˆæ ˆä¸Šåˆ†é…ã€‚åˆ†é…å®Œæˆåï¼Œç»§ç»­åœ¨è°ƒç”¨æ ˆå†…æ‰§è¡Œï¼Œæœ€åçº¿ç¨‹ç»“æŸï¼Œæ ˆç©ºé—´è¢«å›æ”¶ï¼Œå±€éƒ¨å˜é‡å¯¹è±¡ä¹Ÿè¢«å›æ”¶ã€‚è¿™æ ·å°±æ— éœ€è¿›è¡Œåƒåœ¾å›æ”¶äº†ã€‚</p><p>å¸¸è§æ ˆä¸Šåˆ†é…çš„åœºæ™¯ï¼šæˆå‘˜å˜é‡èµ‹å€¼ã€æ–¹æ³•è¿”å›å€¼ã€å®ä¾‹å¼•ç”¨ä¼ é€’</p><h5 id="ä»£ç ä¼˜åŒ–ä¹‹åŒæ­¥çœç•¥-æ¶ˆé™¤" tabindex="-1"><a class="header-anchor" href="#ä»£ç ä¼˜åŒ–ä¹‹åŒæ­¥çœç•¥-æ¶ˆé™¤" aria-hidden="true">#</a> ä»£ç ä¼˜åŒ–ä¹‹åŒæ­¥çœç•¥ï¼ˆæ¶ˆé™¤ï¼‰</h5><ul><li>çº¿ç¨‹åŒæ­¥çš„ä»£ä»·æ˜¯ç›¸å½“é«˜çš„ï¼ŒåŒæ­¥çš„åæœæ˜¯é™ä½å¹¶å‘æ€§å’Œæ€§èƒ½</li><li>åœ¨åŠ¨æ€ç¼–è¯‘åŒæ­¥å—çš„æ—¶å€™ï¼ŒJIT ç¼–è¯‘å™¨å¯ä»¥å€ŸåŠ©é€ƒé€¸åˆ†ææ¥åˆ¤æ–­åŒæ­¥å—æ‰€ä½¿ç”¨çš„é”å¯¹è±¡æ˜¯å¦èƒ½å¤Ÿè¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®è€Œæ²¡æœ‰è¢«å‘å¸ƒåˆ°å…¶ä»–çº¿ç¨‹ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£ä¹ˆ JIT ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿™ä¸ªåŒæ­¥å—çš„æ—¶å€™å°±ä¼šå–æ¶ˆå¯¹è¿™ä¸ªä»£ç çš„åŒæ­¥ã€‚è¿™æ ·å°±èƒ½å¤§å¤§æé«˜å¹¶å‘æ€§å’Œæ€§èƒ½ã€‚è¿™ä¸ªå–æ¶ˆåŒæ­¥çš„è¿‡ç¨‹å°±å«åš<strong>åŒæ­¥çœç•¥ï¼Œä¹Ÿå«é”æ¶ˆé™¤</strong>ã€‚</li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">keep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Object</span> keeper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">synchronized</span><span class="token punctuation">(</span>keeper<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>keeper<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦‚ä¸Šä»£ç ï¼Œä»£ç ä¸­å¯¹ keeper è¿™ä¸ªå¯¹è±¡è¿›è¡ŒåŠ é”ï¼Œä½†æ˜¯ keeper å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸåªåœ¨ <code>keep()</code>æ–¹æ³•ä¸­ï¼Œå¹¶ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æ‰€è®¿é—®åˆ°ï¼Œæ‰€ä»¥åœ¨ JITç¼–è¯‘é˜¶æ®µå°±ä¼šè¢«ä¼˜åŒ–æ‰ã€‚ä¼˜åŒ–æˆï¼š</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">keep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Object</span> keeper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>keeper<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="ä»£ç ä¼˜åŒ–ä¹‹æ ‡é‡æ›¿æ¢" tabindex="-1"><a class="header-anchor" href="#ä»£ç ä¼˜åŒ–ä¹‹æ ‡é‡æ›¿æ¢" aria-hidden="true">#</a> ä»£ç ä¼˜åŒ–ä¹‹æ ‡é‡æ›¿æ¢</h5><p><strong>æ ‡é‡</strong>ï¼ˆScalarï¼‰æ˜¯æŒ‡ä¸€ä¸ªæ— æ³•å†åˆ†è§£æˆæ›´å°çš„æ•°æ®çš„æ•°æ®ã€‚Java ä¸­çš„åŸå§‹æ•°æ®ç±»å‹å°±æ˜¯æ ‡é‡ã€‚</p><p>ç›¸å¯¹çš„ï¼Œé‚£äº›çš„è¿˜å¯ä»¥åˆ†è§£çš„æ•°æ®å«åš<strong>èšåˆé‡</strong>ï¼ˆAggregateï¼‰ï¼ŒJava ä¸­çš„å¯¹è±¡å°±æ˜¯èšåˆé‡ï¼Œå› ä¸ºå…¶è¿˜å¯ä»¥åˆ†è§£æˆå…¶ä»–èšåˆé‡å’Œæ ‡é‡ã€‚</p><p>åœ¨ JIT é˜¶æ®µï¼Œé€šè¿‡é€ƒé€¸åˆ†æç¡®å®šè¯¥å¯¹è±¡ä¸ä¼šè¢«å¤–éƒ¨è®¿é—®ï¼Œå¹¶ä¸”å¯¹è±¡å¯ä»¥è¢«è¿›ä¸€æ­¥åˆ†è§£æ—¶ï¼ŒJVM ä¸ä¼šåˆ›å»ºè¯¥å¯¹è±¡ï¼Œè€Œä¼šå°†è¯¥å¯¹è±¡æˆå‘˜å˜é‡åˆ†è§£è‹¥å¹²ä¸ªè¢«è¿™ä¸ªæ–¹æ³•ä½¿ç”¨çš„æˆå‘˜å˜é‡æ‰€ä»£æ›¿ã€‚è¿™äº›ä»£æ›¿çš„æˆå‘˜å˜é‡åœ¨æ ˆå¸§æˆ–å¯„å­˜å™¨ä¸Šåˆ†é…ç©ºé—´ã€‚è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯<strong>æ ‡é‡æ›¿æ¢</strong>ã€‚</p><p>é€šè¿‡ <code>-XX:+EliminateAllocations</code> å¯ä»¥å¼€å¯æ ‡é‡æ›¿æ¢ï¼Œ<code>-XX:+PrintEliminateAllocations</code> æŸ¥çœ‹æ ‡é‡æ›¿æ¢æƒ…å†µã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token class-name">Point</span> point <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Point</span>ï¼ˆ<span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span>ï¼‰<span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;point.x=&quot;</span><span class="token operator">+</span>point<span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token string">&quot;; point.y=&quot;</span><span class="token operator">+</span>point<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Point</span><span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> x<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç ä¸­ï¼Œpoint å¯¹è±¡å¹¶æ²¡æœ‰é€ƒé€¸å‡º <code>alloc()</code> æ–¹æ³•ï¼Œå¹¶ä¸” point å¯¹è±¡æ˜¯å¯ä»¥æ‹†è§£æˆæ ‡é‡çš„ã€‚é‚£ä¹ˆï¼ŒJIT å°±ä¸ä¼šç›´æ¥åˆ›å»º Point å¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ä¸¤ä¸ªæ ‡é‡ int x ï¼Œint y æ¥æ›¿ä»£ Point å¯¹è±¡ã€‚</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">alloc</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">int</span> x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
   <span class="token keyword">int</span> y <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
   <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;point.x=&quot;</span><span class="token operator">+</span>x<span class="token operator">+</span><span class="token string">&quot;; point.y=&quot;</span><span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="ä»£ç ä¼˜åŒ–ä¹‹æ ˆä¸Šåˆ†é…" tabindex="-1"><a class="header-anchor" href="#ä»£ç ä¼˜åŒ–ä¹‹æ ˆä¸Šåˆ†é…" aria-hidden="true">#</a> ä»£ç ä¼˜åŒ–ä¹‹æ ˆä¸Šåˆ†é…</h5><p>æˆ‘ä»¬é€šè¿‡ JVM å†…å­˜åˆ†é…å¯ä»¥çŸ¥é“ JAVA ä¸­çš„å¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸Šè¿›è¡Œåˆ†é…ï¼Œå½“å¯¹è±¡æ²¡æœ‰è¢«å¼•ç”¨çš„æ—¶å€™ï¼Œéœ€è¦ä¾é  GC è¿›è¡Œå›æ”¶å†…å­˜ï¼Œå¦‚æœå¯¹è±¡æ•°é‡è¾ƒå¤šçš„æ—¶å€™ï¼Œä¼šç»™ GC å¸¦æ¥è¾ƒå¤§å‹åŠ›ï¼Œä¹Ÿé—´æ¥å½±å“äº†åº”ç”¨çš„æ€§èƒ½ã€‚ä¸ºäº†å‡å°‘ä¸´æ—¶å¯¹è±¡åœ¨å †å†…åˆ†é…çš„æ•°é‡ï¼ŒJVM é€šè¿‡é€ƒé€¸åˆ†æç¡®å®šè¯¥å¯¹è±¡ä¸ä¼šè¢«å¤–éƒ¨è®¿é—®ã€‚é‚£å°±é€šè¿‡æ ‡é‡æ›¿æ¢å°†è¯¥å¯¹è±¡åˆ†è§£åœ¨æ ˆä¸Šåˆ†é…å†…å­˜ï¼Œè¿™æ ·è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å°±å¯ä»¥éšæ ˆå¸§å‡ºæ ˆè€Œé”€æ¯ï¼Œå°±å‡è½»äº†åƒåœ¾å›æ”¶çš„å‹åŠ›ã€‚</p><p><strong>æ€»ç»“ï¼š</strong></p><p>å…³äºé€ƒé€¸åˆ†æçš„è®ºæ–‡åœ¨1999å¹´å°±å·²ç»å‘è¡¨äº†ï¼Œä½†ç›´åˆ°JDK 1.6æ‰æœ‰å®ç°ï¼Œè€Œä¸”è¿™é¡¹æŠ€æœ¯åˆ°å¦‚ä»Šä¹Ÿå¹¶ä¸æ˜¯ååˆ†æˆç†Ÿçš„ã€‚</p><p><strong>å…¶æ ¹æœ¬åŸå› å°±æ˜¯æ— æ³•ä¿è¯é€ƒé€¸åˆ†æçš„æ€§èƒ½æ¶ˆè€—ä¸€å®šèƒ½é«˜äºä»–çš„æ¶ˆè€—ã€‚è™½ç„¶ç»è¿‡é€ƒé€¸åˆ†æå¯ä»¥åšæ ‡é‡æ›¿æ¢ã€æ ˆä¸Šåˆ†é…ã€å’Œé”æ¶ˆé™¤ã€‚ä½†æ˜¯é€ƒé€¸åˆ†æè‡ªèº«ä¹Ÿæ˜¯éœ€è¦è¿›è¡Œä¸€ç³»åˆ—å¤æ‚çš„åˆ†æçš„ï¼Œè¿™å…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªç›¸å¯¹è€—æ—¶çš„è¿‡ç¨‹ã€‚</strong></p><p>ä¸€ä¸ªæç«¯çš„ä¾‹å­ï¼Œå°±æ˜¯ç»è¿‡é€ƒé€¸åˆ†æä¹‹åï¼Œå‘ç°æ²¡æœ‰ä¸€ä¸ªå¯¹è±¡æ˜¯ä¸é€ƒé€¸çš„ã€‚é‚£è¿™ä¸ªé€ƒé€¸åˆ†æçš„è¿‡ç¨‹å°±ç™½ç™½æµªè´¹æ‰äº†ã€‚</p><p>è™½ç„¶è¿™é¡¹æŠ€æœ¯å¹¶ä¸ååˆ†æˆç†Ÿï¼Œä½†æ˜¯ä»–ä¹Ÿæ˜¯å³æ—¶ç¼–è¯‘å™¨ä¼˜åŒ–æŠ€æœ¯ä¸­ä¸€ä¸ªååˆ†é‡è¦çš„æ‰‹æ®µã€‚</p><h2 id="_5-æ–¹æ³•åŒº" tabindex="-1"><a class="header-anchor" href="#_5-æ–¹æ³•åŒº" aria-hidden="true">#</a> 5. æ–¹æ³•åŒº</h2><ul><li>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰ä¸ Java å †ä¸€æ ·ï¼Œæ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸã€‚</li><li>è™½ç„¶ Java è™šæ‹Ÿæœºè§„èŒƒæŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒå´æœ‰ä¸€ä¸ªåˆ«åå« Non-Heapï¼ˆéå †ï¼‰ï¼Œç›®çš„åº”è¯¥æ˜¯ä¸ Java å †åŒºåˆ†å¼€ã€‚</li><li>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ã€‚Class æ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬/å­—æ®µ/æ–¹æ³•/æ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ˜¯å¸¸é‡æ± ï¼ˆConstant Pool Tableï¼‰ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å†…å®¹å°†ç±»åœ¨åŠ è½½åè¿›å…¥æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­å­˜æ”¾ã€‚è¿è¡ŒæœŸé—´ä¹Ÿå¯èƒ½å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­ï¼Œè¿™ç§ç‰¹æ€§è¢«å¼€å‘äººå‘˜åˆ©ç”¨å¾—æ¯”è¾ƒå¤šçš„æ˜¯ <code>String.intern()</code>æ–¹æ³•ã€‚å—æ–¹æ³•åŒºå†…å­˜çš„é™åˆ¶ï¼Œå½“å¸¸é‡æ± æ— æ³•å†ç”³è¯·åˆ°å†…å­˜æ—¶ä¼šæŠ›å‡º <code>OutOfMemoryErro</code>r å¼‚å¸¸ã€‚</li><li>æ–¹æ³•åŒºçš„å¤§å°å’Œå †ç©ºé—´ä¸€æ ·ï¼Œå¯ä»¥é€‰æ‹©å›ºå®šå¤§å°ä¹Ÿå¯é€‰æ‹©å¯æ‰©å±•ï¼Œæ–¹æ³•åŒºçš„å¤§å°å†³å®šäº†ç³»ç»Ÿå¯ä»¥æ”¾å¤šå°‘ä¸ªç±»ï¼Œå¦‚æœç³»ç»Ÿç±»å¤ªå¤šï¼Œå¯¼è‡´æ–¹æ³•åŒºæº¢å‡ºï¼Œè™šæ‹ŸæœºåŒæ ·ä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºé”™è¯¯</li><li>JVM å…³é—­åæ–¹æ³•åŒºå³è¢«é‡Šæ”¾</li></ul><h3 id="_5-1-è§£æƒ‘" tabindex="-1"><a class="header-anchor" href="#_5-1-è§£æƒ‘" aria-hidden="true">#</a> 5.1 è§£æƒ‘</h3><p>ä½ æ˜¯å¦ä¹Ÿæœ‰çœ‹ä¸åŒçš„å‚è€ƒèµ„æ–™ï¼Œæœ‰çš„å†…å­˜ç»“æ„å›¾æœ‰æ–¹æ³•åŒºï¼Œæœ‰çš„åˆæ˜¯æ°¸ä¹…ä»£ï¼Œå…ƒæ•°æ®åŒºï¼Œä¸€è„¸æ‡µé€¼çš„æ—¶å€™ï¼Ÿ</p><ul><li><strong>æ–¹æ³•åŒºï¼ˆmethod areaï¼‰åªæ˜¯ JVM è§„èŒƒä¸­å®šä¹‰çš„ä¸€ä¸ªæ¦‚å¿µ</strong>ï¼Œç”¨äºå­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡æ± ã€é™æ€å˜é‡ã€JITç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ï¼Œå¹¶æ²¡æœ‰è§„å®šå¦‚ä½•å»å®ç°å®ƒï¼Œä¸åŒçš„å‚å•†æœ‰ä¸åŒçš„å®ç°ã€‚è€Œ<strong>æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰æ˜¯Hotspot è™šæ‹Ÿæœºç‰¹æœ‰çš„æ¦‚å¿µ</strong>ï¼Œ Java8 çš„æ—¶å€™åˆè¢«<strong>å…ƒç©ºé—´</strong>å–ä»£äº†ï¼Œæ°¸ä¹…ä»£å’Œå…ƒç©ºé—´éƒ½å¯ä»¥ç†è§£ä¸ºæ–¹æ³•åŒºçš„è½åœ°å®ç°ã€‚</li><li>æ°¸ä¹…ä»£ç‰©ç†æ˜¯å †çš„ä¸€éƒ¨åˆ†ï¼Œå’Œæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£åœ°å€æ˜¯è¿ç»­çš„ï¼ˆå—åƒåœ¾å›æ”¶å™¨ç®¡ç†ï¼‰ï¼Œè€Œå…ƒç©ºé—´å­˜åœ¨äºæœ¬åœ°å†…å­˜ï¼ˆæˆ‘ä»¬å¸¸è¯´çš„å †å¤–å†…å­˜ï¼Œä¸å—åƒåœ¾å›æ”¶å™¨ç®¡ç†ï¼‰ï¼Œè¿™æ ·å°±ä¸å— JVM é™åˆ¶äº†ï¼Œä¹Ÿæ¯”è¾ƒéš¾å‘ç”ŸOOMï¼ˆéƒ½ä¼šæœ‰æº¢å‡ºå¼‚å¸¸ï¼‰</li><li>Java7 ä¸­æˆ‘ä»¬é€šè¿‡<code>-XX:PermSize</code> å’Œ <code>-xx:MaxPermSize</code> æ¥è®¾ç½®æ°¸ä¹…ä»£å‚æ•°ï¼ŒJava8 ä¹‹åï¼Œéšç€æ°¸ä¹…ä»£çš„å–æ¶ˆï¼Œè¿™äº›å‚æ•°ä¹Ÿå°±éšä¹‹å¤±æ•ˆäº†ï¼Œæ”¹ä¸ºé€šè¿‡<code>-XX:MetaspaceSize</code> å’Œ <code>-XX:MaxMetaspaceSize</code> ç”¨æ¥è®¾ç½®å…ƒç©ºé—´å‚æ•°</li><li>å­˜å‚¨å†…å®¹ä¸åŒï¼Œå…ƒç©ºé—´å­˜å‚¨ç±»çš„å…ƒä¿¡æ¯ï¼Œé™æ€å˜é‡å’Œå¸¸é‡æ± ç­‰å¹¶å…¥å †ä¸­ã€‚ç›¸å½“äºæ°¸ä¹…ä»£çš„æ•°æ®è¢«åˆ†åˆ°äº†å †å’Œå…ƒç©ºé—´ä¸­</li><li>å¦‚æœæ–¹æ³•åŒºåŸŸä¸­çš„å†…å­˜ä¸èƒ½ç”¨äºæ»¡è¶³åˆ†é…è¯·æ±‚ï¼Œåˆ™ Java è™šæ‹ŸæœºæŠ›å‡º <code>OutOfMemoryError</code></li><li>JVM è§„èŒƒè¯´æ–¹æ³•åŒºåœ¨é€»è¾‘ä¸Šæ˜¯å †çš„ä¸€éƒ¨åˆ†ï¼Œä½†ç›®å‰å®é™…ä¸Šæ˜¯ä¸ Java å †åˆ†å¼€çš„ï¼ˆNon-Heapï¼‰</li></ul><p>æ‰€ä»¥å¯¹äºæ–¹æ³•åŒºï¼ŒJava8 ä¹‹åçš„å˜åŒ–ï¼š</p><ul><li>ç§»é™¤äº†æ°¸ä¹…ä»£ï¼ˆPermGenï¼‰ï¼Œæ›¿æ¢ä¸ºå…ƒç©ºé—´ï¼ˆMetaspaceï¼‰ï¼›</li><li>æ°¸ä¹…ä»£ä¸­çš„ class metadata è½¬ç§»åˆ°äº† native memoryï¼ˆæœ¬åœ°å†…å­˜ï¼Œè€Œä¸æ˜¯è™šæ‹Ÿæœºï¼‰ï¼›</li><li>æ°¸ä¹…ä»£ä¸­çš„ interned Strings å’Œ class static variables è½¬ç§»åˆ°äº† Java heapï¼›</li><li>æ°¸ä¹…ä»£å‚æ•° ï¼ˆPermSize MaxPermSizeï¼‰ -&gt; å…ƒç©ºé—´å‚æ•°ï¼ˆMetaspaceSize MaxMetaspaceSizeï¼‰</li></ul><h3 id="_5-2-è®¾ç½®æ–¹æ³•åŒºå†…å­˜çš„å¤§å°" tabindex="-1"><a class="header-anchor" href="#_5-2-è®¾ç½®æ–¹æ³•åŒºå†…å­˜çš„å¤§å°" aria-hidden="true">#</a> 5.2 è®¾ç½®æ–¹æ³•åŒºå†…å­˜çš„å¤§å°</h3><p>JDK8 åŠä»¥åï¼š</p><ul><li>å…ƒæ•°æ®åŒºå¤§å°å¯ä»¥ä½¿ç”¨å‚æ•° <code>-XX:MetaspaceSize</code> å’Œ <code>-XX:MaxMetaspaceSize</code> æŒ‡å®šï¼Œæ›¿ä»£ä¸Šè¿°åŸæœ‰çš„ä¸¤ä¸ªå‚æ•°</li><li>é»˜è®¤å€¼ä¾èµ–äºå¹³å°ã€‚Windows ä¸‹ï¼Œ<code>-XX:MetaspaceSize</code> æ˜¯ 21Mï¼Œ<code>-XX:MaxMetaspacaSize</code> çš„å€¼æ˜¯ -1ï¼Œå³æ²¡æœ‰é™åˆ¶</li><li>ä¸æ°¸ä¹…ä»£ä¸åŒï¼Œå¦‚æœä¸æŒ‡å®šå¤§å°ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè™šæ‹Ÿæœºä¼šè€—å°½æ‰€æœ‰çš„å¯ç”¨ç³»ç»Ÿå†…å­˜ã€‚å¦‚æœå…ƒæ•°æ®å‘ç”Ÿæº¢å‡ºï¼Œè™šæ‹Ÿæœºä¸€æ ·ä¼šæŠ›å‡ºå¼‚å¸¸ <code>OutOfMemoryError:Metaspace</code></li><li><code>-XX:MetaspaceSize</code> ï¼šè®¾ç½®åˆå§‹çš„å…ƒç©ºé—´å¤§å°ã€‚å¯¹äºä¸€ä¸ª 64 ä½çš„æœåŠ¡å™¨ç«¯ JVM æ¥è¯´ï¼Œå…¶é»˜è®¤çš„ <code>-XX:MetaspaceSize</code> çš„å€¼ä¸º20.75MBï¼Œè¿™å°±æ˜¯åˆå§‹çš„é«˜æ°´ä½çº¿ï¼Œä¸€æ—¦è§¦åŠè¿™ä¸ªæ°´ä½çº¿ï¼ŒFull GC å°†ä¼šè¢«è§¦å‘å¹¶å¸è½½æ²¡ç”¨çš„ç±»ï¼ˆå³è¿™äº›ç±»å¯¹åº”çš„ç±»åŠ è½½å™¨ä¸å†å­˜æ´»ï¼‰ï¼Œç„¶åè¿™ä¸ªé«˜æ°´ä½çº¿å°†ä¼šé‡ç½®ï¼Œæ–°çš„é«˜æ°´ä½çº¿çš„å€¼å–å†³äº GC åé‡Šæ”¾äº†å¤šå°‘å…ƒç©ºé—´ã€‚å¦‚æœé‡Šæ”¾çš„ç©ºé—´ä¸è¶³ï¼Œé‚£ä¹ˆåœ¨ä¸è¶…è¿‡ <code>MaxMetaspaceSize</code>æ—¶ï¼Œé€‚å½“æé«˜è¯¥å€¼ã€‚å¦‚æœé‡Šæ”¾ç©ºé—´è¿‡å¤šï¼Œåˆ™é€‚å½“é™ä½è¯¥å€¼</li><li>å¦‚æœåˆå§‹åŒ–çš„é«˜æ°´ä½çº¿è®¾ç½®è¿‡ä½ï¼Œä¸Šè¿°é«˜æ°´ä½çº¿è°ƒæ•´æƒ…å†µä¼šå‘ç”Ÿå¾ˆå¤šæ¬¡ï¼Œé€šè¿‡åƒåœ¾å›æ”¶çš„æ—¥å¿—å¯è§‚å¯Ÿåˆ° Full GC å¤šæ¬¡è°ƒç”¨ã€‚ä¸ºäº†é¿å…é¢‘ç¹ GCï¼Œå»ºè®®å°† <code>-XX:MetaspaceSize</code> è®¾ç½®ä¸ºä¸€ä¸ªç›¸å¯¹è¾ƒé«˜çš„å€¼ã€‚</li></ul><h3 id="_5-3-æ–¹æ³•åŒºå†…éƒ¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_5-3-æ–¹æ³•åŒºå†…éƒ¨ç»“æ„" aria-hidden="true">#</a> 5.3 æ–¹æ³•åŒºå†…éƒ¨ç»“æ„</h3><p>æ–¹æ³•åŒºç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»å‹ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç¼“å­˜ç­‰ã€‚</p><h4 id="_5-3-1-ç±»å‹ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_5-3-1-ç±»å‹ä¿¡æ¯" aria-hidden="true">#</a> 5.3.1 ç±»å‹ä¿¡æ¯</h4><p>å¯¹æ¯ä¸ªåŠ è½½çš„ç±»å‹ï¼ˆç±» classã€æ¥å£ interfaceã€æšä¸¾ enumã€æ³¨è§£ annotationï¼‰ï¼ŒJVM å¿…é¡»åœ¨æ–¹æ³•åŒºä¸­å­˜å‚¨ä»¥ä¸‹ç±»å‹ä¿¡æ¯</p><ul><li>è¿™ä¸ªç±»å‹çš„å®Œæ•´æœ‰æ•ˆåç§°ï¼ˆå…¨å=åŒ…å.ç±»åï¼‰</li><li>è¿™ä¸ªç±»å‹ç›´æ¥çˆ¶ç±»çš„å®Œæ•´æœ‰æ•ˆåï¼ˆå¯¹äº interfaceæˆ–æ˜¯ java.lang.Objectï¼Œéƒ½æ²¡æœ‰çˆ¶ç±»ï¼‰</li><li>è¿™ä¸ªç±»å‹çš„ä¿®é¥°ç¬¦ï¼ˆpublicï¼Œabstractï¼Œfinal çš„æŸä¸ªå­é›†ï¼‰</li><li>è¿™ä¸ªç±»å‹ç›´æ¥æ¥å£çš„ä¸€ä¸ªæœ‰åºåˆ—è¡¨</li></ul><h4 id="_5-3-2-åŸŸ-field-ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_5-3-2-åŸŸ-field-ä¿¡æ¯" aria-hidden="true">#</a> 5.3.2 åŸŸï¼ˆFieldï¼‰ä¿¡æ¯</h4><ul><li>JVM å¿…é¡»åœ¨æ–¹æ³•åŒºä¸­ä¿å­˜ç±»å‹çš„æ‰€æœ‰åŸŸçš„ç›¸å…³ä¿¡æ¯ä»¥åŠåŸŸçš„å£°æ˜é¡ºåº</li><li>åŸŸçš„ç›¸å…³ä¿¡æ¯åŒ…æ‹¬ï¼šåŸŸåç§°ã€åŸŸç±»å‹ã€åŸŸä¿®é¥°ç¬¦ï¼ˆpublicã€privateã€protectedã€staticã€finalã€volatileã€transient çš„æŸä¸ªå­é›†ï¼‰</li></ul><h4 id="_5-3-3-æ–¹æ³•-method-ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#_5-3-3-æ–¹æ³•-method-ä¿¡æ¯" aria-hidden="true">#</a> 5.3.3 æ–¹æ³•ï¼ˆMethodï¼‰ä¿¡æ¯</h4><p>JVM å¿…é¡»ä¿å­˜æ‰€æœ‰æ–¹æ³•çš„</p><ul><li>æ–¹æ³•åç§°</li><li>æ–¹æ³•çš„è¿”å›ç±»å‹</li><li>æ–¹æ³•å‚æ•°çš„æ•°é‡å’Œç±»å‹</li><li>æ–¹æ³•çš„ä¿®é¥°ç¬¦ï¼ˆpublicï¼Œprivateï¼Œprotectedï¼Œstaticï¼Œfinalï¼Œsynchronizedï¼Œnativeï¼Œabstract çš„ä¸€ä¸ªå­é›†ï¼‰</li><li>æ–¹æ³•çš„å­—ç¬¦ç ï¼ˆbytecodesï¼‰ã€æ“ä½œæ•°æ ˆã€å±€éƒ¨å˜é‡è¡¨åŠå¤§å°ï¼ˆabstract å’Œ native æ–¹æ³•é™¤å¤–ï¼‰</li><li>å¼‚å¸¸è¡¨ï¼ˆabstract å’Œ native æ–¹æ³•é™¤å¤–ï¼‰ <ul><li>æ¯ä¸ªå¼‚å¸¸å¤„ç†çš„å¼€å§‹ä½ç½®ã€ç»“æŸä½ç½®ã€ä»£ç å¤„ç†åœ¨ç¨‹åºè®¡æ•°å™¨ä¸­çš„åç§»åœ°å€ã€è¢«æ•è·çš„å¼‚å¸¸ç±»çš„å¸¸é‡æ± ç´¢å¼•</li></ul></li></ul><p><strong>æ ˆã€å †ã€æ–¹æ³•åŒºçš„äº¤äº’å…³ç³»</strong></p><h3 id="_5-4-è¿è¡Œæ—¶å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#_5-4-è¿è¡Œæ—¶å¸¸é‡æ± " aria-hidden="true">#</a> 5.4 è¿è¡Œæ—¶å¸¸é‡æ± </h3><p>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œç†è§£è¿è¡Œæ—¶å¸¸é‡æ± çš„è¯ï¼Œæˆ‘ä»¬å…ˆæ¥è¯´è¯´å­—èŠ‚ç æ–‡ä»¶ï¼ˆClass æ–‡ä»¶ï¼‰ä¸­çš„å¸¸é‡æ± ï¼ˆå¸¸é‡æ± è¡¨ï¼‰</p><h4 id="_5-4-1-å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#_5-4-1-å¸¸é‡æ± " aria-hidden="true">#</a> 5.4.1 å¸¸é‡æ± </h4><p>ä¸€ä¸ªæœ‰æ•ˆçš„å­—èŠ‚ç æ–‡ä»¶ä¸­é™¤äº†åŒ…å«ç±»çš„ç‰ˆæœ¬ä¿¡æ¯ã€å­—æ®µã€æ–¹æ³•ä»¥åŠæ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜åŒ…å«ä¸€é¡¹ä¿¡æ¯é‚£å°±æ˜¯å¸¸é‡æ± è¡¨ï¼ˆConstant Pool Tableï¼‰ï¼ŒåŒ…å«å„ç§å­—é¢é‡å’Œå¯¹ç±»å‹ã€åŸŸå’Œæ–¹æ³•çš„ç¬¦å·å¼•ç”¨ã€‚</p><h5 id="ä¸ºä»€ä¹ˆéœ€è¦å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆéœ€è¦å¸¸é‡æ± " aria-hidden="true">#</a> ä¸ºä»€ä¹ˆéœ€è¦å¸¸é‡æ± ï¼Ÿ</h5><p>ä¸€ä¸ª Java æºæ–‡ä»¶ä¸­çš„ç±»ã€æ¥å£ï¼Œç¼–è¯‘åäº§ç”Ÿä¸€ä¸ªå­—èŠ‚ç æ–‡ä»¶ã€‚è€Œ Java ä¸­çš„å­—èŠ‚ç éœ€è¦æ•°æ®æ”¯æŒï¼Œé€šå¸¸è¿™ç§æ•°æ®ä¼šå¾ˆå¤§ä»¥è‡³äºä¸èƒ½ç›´æ¥å­˜åˆ°å­—èŠ‚ç é‡Œï¼Œæ¢å¦ä¸€ç§æ–¹å¼ï¼Œå¯ä»¥å­˜åˆ°å¸¸é‡æ± ï¼Œè¿™ä¸ªå­—èŠ‚ç åŒ…å«äº†æŒ‡å‘å¸¸é‡æ± çš„å¼•ç”¨ã€‚åœ¨åŠ¨æ€é“¾æ¥çš„æ—¶å€™ç”¨åˆ°çš„å°±æ˜¯è¿è¡Œæ—¶å¸¸é‡æ± ã€‚</p><p>å¦‚ä¸‹ï¼Œæˆ‘ä»¬é€šè¿‡ jclasslib æŸ¥çœ‹ä¸€ä¸ªåªæœ‰ Main æ–¹æ³•çš„ç®€å•ç±»ï¼Œå­—èŠ‚ç ä¸­çš„ #2 æŒ‡å‘çš„å°±æ˜¯ Constant Pool</p><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820232434106.png" alt="image-20220820232434106"></p><p>å¸¸é‡æ± å¯ä»¥çœ‹ä½œæ˜¯ä¸€å¼ è¡¨ï¼Œè™šæ‹ŸæœºæŒ‡ä»¤æ ¹æ®è¿™å¼ å¸¸é‡è¡¨æ‰¾åˆ°è¦æ‰§è¡Œçš„ç±»åã€æ–¹æ³•åã€å‚æ•°ç±»å‹ã€å­—é¢é‡ç­‰ç±»å‹ã€‚</p><h4 id="_5-4-2-è¿è¡Œæ—¶å¸¸é‡æ± " tabindex="-1"><a class="header-anchor" href="#_5-4-2-è¿è¡Œæ—¶å¸¸é‡æ± " aria-hidden="true">#</a> 5.4.2 è¿è¡Œæ—¶å¸¸é‡æ± </h4><ul><li>åœ¨åŠ è½½ç±»å’Œç»“æ„åˆ°è™šæ‹Ÿæœºåï¼Œå°±ä¼šåˆ›å»ºå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± </li><li>å¸¸é‡æ± è¡¨ï¼ˆConstant Pool Tableï¼‰æ˜¯ Class æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå­˜å‚¨ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œ<strong>è¿™éƒ¨åˆ†å†…å®¹å°†åœ¨ç±»åŠ è½½åå­˜æ”¾åˆ°æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­</strong></li><li>JVM ä¸ºæ¯ä¸ªå·²åŠ è½½çš„ç±»å‹ï¼ˆç±»æˆ–æ¥å£ï¼‰éƒ½ç»´æŠ¤ä¸€ä¸ªå¸¸é‡æ± ã€‚æ± ä¸­çš„æ•°æ®é¡¹åƒæ•°ç»„é¡¹ä¸€æ ·ï¼Œæ˜¯é€šè¿‡ç´¢å¼•è®¿é—®çš„</li><li>è¿è¡Œæ—¶å¸¸é‡æ± ä¸­åŒ…å«å„ç§ä¸åŒçš„å¸¸é‡ï¼ŒåŒ…æ‹¬ç¼–è¯‘å™¨å°±å·²ç»æ˜ç¡®çš„æ•°å€¼å­—é¢é‡ï¼Œä¹ŸåŒ…æ‹¬åˆ°è¿è¡ŒæœŸè§£æåæ‰èƒ½å¤Ÿè·å¾—çš„æ–¹æ³•æˆ–å­—æ®µå¼•ç”¨ã€‚æ­¤æ—¶ä¸å†æ˜¯å¸¸é‡æ± ä¸­çš„ç¬¦å·åœ°å€äº†ï¼Œè¿™é‡Œæ¢ä¸ºçœŸå®åœ°å€ <ul><li>è¿è¡Œæ—¶å¸¸é‡æ± ï¼Œç›¸å¯¹äº Class æ–‡ä»¶å¸¸é‡æ± çš„å¦ä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯ï¼š<strong>åŠ¨æ€æ€§</strong>ï¼ŒJava è¯­è¨€å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰ç¼–è¯‘æœŸé—´æ‰èƒ½äº§ç”Ÿï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯ä»¥å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­ï¼ŒString ç±»çš„ <code>intern()</code> æ–¹æ³•å°±æ˜¯è¿™æ ·çš„</li></ul></li><li>å½“åˆ›å»ºç±»æˆ–æ¥å£çš„è¿è¡Œæ—¶å¸¸é‡æ± æ—¶ï¼Œå¦‚æœæ„é€ è¿è¡Œæ—¶å¸¸é‡æ± æ‰€éœ€çš„å†…å­˜ç©ºé—´è¶…è¿‡äº†æ–¹æ³•åŒºæ‰€èƒ½æä¾›çš„æœ€å¤§å€¼ï¼Œåˆ™ JVM ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚</li></ul><h3 id="_5-5-æ–¹æ³•åŒºåœ¨-jdk6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚" tabindex="-1"><a class="header-anchor" href="#_5-5-æ–¹æ³•åŒºåœ¨-jdk6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚" aria-hidden="true">#</a> 5.5 æ–¹æ³•åŒºåœ¨ JDK6ã€7ã€8ä¸­çš„æ¼”è¿›ç»†èŠ‚</h3><p>åªæœ‰ HotSpot æ‰æœ‰æ°¸ä¹…ä»£çš„æ¦‚å¿µ</p><table><thead><tr><th>jdk1.6åŠä¹‹å‰</th><th>æœ‰æ°¸ä¹…ä»£ï¼Œé™æ€å˜é‡å­˜æ”¾åœ¨æ°¸ä¹…ä»£ä¸Š</th></tr></thead><tbody><tr><td>jdk1.7</td><td>æœ‰æ°¸ä¹…ä»£ï¼Œä½†å·²ç»é€æ­¥â€œå»æ°¸ä¹…ä»£â€ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ã€é™æ€å˜é‡ç§»é™¤ï¼Œä¿å­˜åœ¨å †ä¸­</td></tr><tr><td>jdk1.8åŠä¹‹å</td><td>å–æ¶ˆæ°¸ä¹…ä»£ï¼Œç±»å‹ä¿¡æ¯ã€å­—æ®µã€æ–¹æ³•ã€å¸¸é‡ä¿å­˜åœ¨æœ¬åœ°å†…å­˜çš„å…ƒç©ºé—´ï¼Œä½†å­—ç¬¦ä¸²å¸¸é‡æ± ã€é™æ€å˜é‡ä»åœ¨å †ä¸­</td></tr></tbody></table><h4 id="ç§»é™¤æ°¸ä¹…ä»£åŸå› " tabindex="-1"><a class="header-anchor" href="#ç§»é™¤æ°¸ä¹…ä»£åŸå› " aria-hidden="true">#</a> ç§»é™¤æ°¸ä¹…ä»£åŸå› </h4><p><a href="http://openjdk.java.net/jeps/122" target="_blank" rel="noopener noreferrer">http://openjdk.java.net/jeps/122<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><img src="https://abelsun-1256449468.cos.ap-beijing.myqcloud.com/image/image-20220820232807873.png" alt="image-20220820232807873"></p><ul><li><p>å› ä¸ºæ°¸ä¹…ä»£è®¾ç½®ç©ºé—´å¤§å°æ˜¯å¾ˆéš¾ç¡®å®šçš„ã€‚</p><p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œå¦‚æœåŠ¨æ€åŠ è½½ç±»è¿‡å¤šï¼Œå®¹æ˜“äº§ç”Ÿ Perm åŒºçš„ OOMã€‚å¦‚æœæŸä¸ªå®é™… Web å·¥ç¨‹ä¸­ï¼Œå› ä¸ºåŠŸèƒ½ç‚¹æ¯”è¾ƒå¤šï¼Œåœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œè¦ä¸æ–­åŠ¨æ€åŠ è½½å¾ˆå¤šç±»ï¼Œç»å¸¸å‡ºç° OOMã€‚è€Œå…ƒç©ºé—´å’Œæ°¸ä¹…ä»£æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œå…ƒç©ºé—´ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œæ‰€ä»¥é»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç©ºé—´çš„å¤§å°ä»…å—æœ¬åœ°å†…å­˜é™åˆ¶</p></li><li><p>å¯¹æ°¸ä¹…ä»£è¿›è¡Œè°ƒä¼˜è¾ƒå›°éš¾</p></li></ul><h3 id="_5-6-æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶" tabindex="-1"><a class="header-anchor" href="#_5-6-æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶" aria-hidden="true">#</a> 5.6 æ–¹æ³•åŒºçš„åƒåœ¾å›æ”¶</h3><p>æ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†ä¸»è¦å›æ”¶ä¸¤éƒ¨åˆ†å†…å®¹ï¼š<strong>å¸¸é‡æ± ä¸­åºŸå¼ƒçš„å¸¸é‡å’Œä¸å†ä½¿ç”¨çš„ç±»å‹</strong>ã€‚</p><p>å…ˆæ¥è¯´è¯´æ–¹æ³•åŒºå†…å¸¸é‡æ± ä¹‹ä¸­ä¸»è¦å­˜æ”¾çš„ä¸¤å¤§ç±»å¸¸é‡ï¼šå­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚å­—é¢é‡æ¯”è¾ƒæ¥è¿‘ Java è¯­è¨€å±‚æ¬¡çš„å¸¸é‡æ¦‚å¿µï¼Œå¦‚æ–‡æœ¬å­—ç¬¦ä¸²ã€è¢«å£°æ˜ä¸º final çš„å¸¸é‡å€¼ç­‰ã€‚è€Œç¬¦å·å¼•ç”¨åˆ™å±äºç¼–è¯‘åŸç†æ–¹é¢çš„æ¦‚å¿µï¼ŒåŒ…æ‹¬ä¸‹é¢ä¸‰ç±»å¸¸é‡ï¼š</p><ul><li>ç±»å’Œæ¥å£çš„å…¨é™å®šå</li><li>å­—æ®µçš„åç§°å’Œæè¿°ç¬¦</li><li>æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦</li></ul><p>HotSpot è™šæ‹Ÿæœºå¯¹å¸¸é‡æ± çš„å›æ”¶ç­–ç•¥æ˜¯å¾ˆæ˜ç¡®çš„ï¼Œåªè¦å¸¸é‡æ± ä¸­çš„å¸¸é‡æ²¡æœ‰è¢«ä»»ä½•åœ°æ–¹å¼•ç”¨ï¼Œå°±å¯ä»¥è¢«å›æ”¶</p><p>åˆ¤å®šä¸€ä¸ªç±»å‹æ˜¯å¦å±äºâ€œä¸å†è¢«ä½¿ç”¨çš„ç±»â€ï¼Œéœ€è¦åŒæ—¶æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š</p><ul><li>è¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»åŠå…¶ä»»ä½•æ´¾ç”Ÿå­ç±»çš„å®ä¾‹</li><li>åŠ è½½è¯¥ç±»çš„ç±»åŠ è½½å™¨å·²ç»è¢«å›æ”¶ï¼Œè¿™ä¸ªæ¡ä»¶é™¤éæ˜¯ç»è¿‡ç²¾å¿ƒè®¾è®¡çš„å¯æ›¿æ¢ç±»åŠ è½½å™¨çš„åœºæ™¯ï¼Œå¦‚ OSGiã€JSP çš„é‡åŠ è½½ç­‰ï¼Œå¦åˆ™é€šå¸¸å¾ˆéš¾è¾¾æˆ</li><li>è¯¥ç±»å¯¹åº”çš„ java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•</li></ul><p>Java è™šæ‹Ÿæœºè¢«å…è®¸å †æ»¡è¶³ä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶çš„æ— ç”¨ç±»è¿›è¡Œå›æ”¶ï¼Œè¿™é‡Œè¯´çš„ä»…ä»…æ˜¯â€œè¢«å…è®¸â€ï¼Œè€Œå¹¶ä¸æ˜¯å’Œå¯¹è±¡ä¸€æ ·ï¼Œä¸ä½¿ç”¨äº†å°±å¿…ç„¶ä¼šå›æ”¶ã€‚æ˜¯å¦å¯¹ç±»è¿›è¡Œå›æ”¶ï¼ŒHotSpot è™šæ‹Ÿæœºæä¾›äº† <code>-Xnoclassgc</code> å‚æ•°è¿›è¡Œæ§åˆ¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ <code>-verbose:class</code> ä»¥åŠ <code>-XX:+TraceClassLoading</code> ã€<code>-XX:+TraceClassUnLoading</code> æŸ¥çœ‹ç±»åŠ è½½å’Œå¸è½½ä¿¡æ¯ã€‚</p><p>åœ¨å¤§é‡ä½¿ç”¨åå°„ã€åŠ¨æ€ä»£ç†ã€CGLib ç­‰ ByteCode æ¡†æ¶ã€åŠ¨æ€ç”Ÿæˆ JSP ä»¥åŠ OSGi è¿™ç±»é¢‘ç¹è‡ªå®šä¹‰ ClassLoader çš„åœºæ™¯éƒ½éœ€è¦è™šæ‹Ÿæœºå…·å¤‡ç±»å¸è½½çš„åŠŸèƒ½ï¼Œä»¥ä¿è¯æ°¸ä¹…ä»£ä¸ä¼šæº¢å‡ºã€‚</p><h2 id="å‚è€ƒæ–‡ç« " tabindex="-1"><a class="header-anchor" href="#å‚è€ƒæ–‡ç« " aria-hidden="true">#</a> å‚è€ƒæ–‡ç« </h2><p><a href="https://pdai.tech/md/java/jvm/java-jvm-struct.html" target="_blank" rel="noopener noreferrer"><strong>JVM åŸºç¡€ - JVM å†…å­˜ç»“æ„</strong><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/token01/token01.github.io/edit/master/docs/java/jvm/java-jvm-struct.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/12/26 19:56:34</span></div><!----></footer><nav class="page-nav"><a href="/java/jvm/java-jvm-classload.html" class="nav-link prev" aria-label="JVM åŸºç¡€ - Java ç±»åŠ è½½æœºåˆ¶"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->JVM åŸºç¡€ - Java ç±»åŠ è½½æœºåˆ¶</div></a><a href="/java/jvm/java-jvm-heap-s.html" class="nav-link next" aria-label="JVM åŸºç¡€ - Javaå†…å­˜ç»“æ„(ç²¾ç®€ç‰ˆ)"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">JVM åŸºç¡€ - Javaå†…å­˜ç»“æ„(ç²¾ç®€ç‰ˆ)<!----></div></a></nav><div class="waline-wrapper" darkmode="false" style="display:block;"><div data-waline provider="Waline"><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="nick">æ˜µç§°</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="mail">é‚®ç®±</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="link">ç½‘å€</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="è¯·ç•™è¨€ã€‚(å¡«å†™é‚®ç®±å¯åœ¨è¢«å›å¤æ—¶æ”¶åˆ°é‚®ä»¶æé†’)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>é¢„è§ˆ:</h4><!-- eslint-disable-next-line vue/no-v-html --><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button class="wl-action" title="è¡¨æƒ…" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button class="wl-action" title="è¡¨æƒ…åŒ…"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="ä¸Šä¼ å›¾ç‰‡"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button class="wl-action" title="é¢„è§ˆ"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-text-number">0 <!--v-if--> Â å­—</div><button class="wl-btn">ç™»å½•</button><button class="wl-btn primary" title="Cmd|Ctrl + Enter"><!--[-->æäº¤<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="æœç´¢è¡¨æƒ…åŒ…"><div class="wl-gallery" style="gap:6px;"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> è¯„è®º</div><ul class="wl-sort"><!--[--><li class="active">æŒ‰æ­£åº</li><li class="">æŒ‰å€’åº</li><li class="">æŒ‰çƒ­åº¦</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><!-- Copyright Information --><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noreferrer"> Waline </a> v2.9.1</div></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"></div><div class="copyright">Copyright Â© 2022 Abel sun</div></footer><!--]--></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app.605999cc.js" defer></script>
  </body>
</html>
