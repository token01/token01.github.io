<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta property="og:url" content="https://abelsun.tech/python/pandas.html"><meta property="og:site_name" content="LearnNotes"><meta property="og:title" content="LearnNotes"><meta property="og:description" content="Pandas Pandas æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åˆ†æç»“æ„åŒ–æ•°æ®çš„å·¥å…·é›†ï¼Œå®ƒçš„ä½¿ç”¨åŸºç¡€æ˜¯ Numpyï¼ˆæä¾›é«˜æ€§èƒ½çš„çŸ©é˜µè¿ç®—ï¼‰ï¼Œç”¨äºæ•°æ®æŒ–æ˜å’Œæ•°æ®åˆ†æï¼ŒåŒæ—¶ä¹Ÿæä¾›æ•°æ®æ¸…æ´—åŠŸèƒ½ã€‚ å®˜æ–¹ å®˜æ–¹æ–‡æ¡£ (https://pandas.pydata.org/docs/reference/index.html#api); æºä»£ç  (https://github.com/pan..."><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-11-19T03:16:26.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-11-19T03:16:26.000Z"><title>LearnNotes | LearnNotes</title><meta name="description" content="Pandas Pandas æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åˆ†æç»“æ„åŒ–æ•°æ®çš„å·¥å…·é›†ï¼Œå®ƒçš„ä½¿ç”¨åŸºç¡€æ˜¯ Numpyï¼ˆæä¾›é«˜æ€§èƒ½çš„çŸ©é˜µè¿ç®—ï¼‰ï¼Œç”¨äºæ•°æ®æŒ–æ˜å’Œæ•°æ®åˆ†æï¼ŒåŒæ—¶ä¹Ÿæä¾›æ•°æ®æ¸…æ´—åŠŸèƒ½ã€‚ å®˜æ–¹ å®˜æ–¹æ–‡æ¡£ (https://pandas.pydata.org/docs/reference/index.html#api); æºä»£ç  (https://github.com/pan...">
    <meta name="keywords" content="è‡ªæˆ‘æå‡,æ•ˆç‡æå‡,å¼€æºå·¥å…·,å­¦ä¹ ç¬”è®°" />
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style.8e767305.css" as="style" /><link rel="stylesheet" href="/assets/style.8e767305.css" />
    <link rel="modulepreload" href="/assets/app.63c04501.js"><link rel="modulepreload" href="/assets/pandas.html.29783674.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/pandas.html.074392e8.js">
    <!-- çœ‹æ¿å¨˜åŒºå— -->
    <link href="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-y/font-awesome/6.0.0/css/all.min.css" type="text/css" rel="stylesheet" />
    <script src="/live2d-widget/autoload.js"></script>
    <!-- End çœ‹æ¿å¨˜åŒºå— -->
    <!-- Matomo æ­¤åŒºå—ä¸ºç»Ÿè®¡ä»£ç ï¼Œè¯·åˆ é™¤-->
    <script>
      var _paq = window._paq = window._paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="https://piwik.seoipo.com/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '7']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <!-- End Matomo Code æ­¤åŒºå—ä¸ºç»Ÿè®¡ä»£ç ï¼Œè¯·åˆ é™¤-->
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="LearnNotes"><!----><span class="site-name hide-in-pad">LearnNotes</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/blog.html" class="nav-link" aria-label="åšå®¢"><span class="icon iconfont icon-blog"></span>åšå®¢<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç¼–ç¨‹æŠ€æœ¯"><span class="title"><span class="icon iconfont icon-code"></span>ç¼–ç¨‹æŠ€æœ¯</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/code/basis/Markdown" class="nav-link" aria-label="/code/basis/Markdown"><!---->/code/basis/Markdown<!----></a></li><li class="dropdown-item"><a href="/code/basis/AutoHotkey" class="nav-link" aria-label="/code/basis/AutoHotkey"><!---->/code/basis/AutoHotkey<!----></a></li><li class="dropdown-item"><a href="/code/basis/Electron" class="nav-link" aria-label="/code/basis/Electron"><!---->/code/basis/Electron<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="åº”ç”¨"><span class="title"><span class="icon iconfont icon-app"></span>åº”ç”¨</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/apps/Applist.html" class="nav-link" aria-label="å¿…å¤‡åº”ç”¨"><span class="icon iconfont icon-list"></span>å¿…å¤‡åº”ç”¨<!----></a></li><li class="dropdown-item"><a href="/apps/AppNotes.html" class="nav-link" aria-label="åº”ç”¨ç¬”è®°"><span class="icon iconfont icon-plugin"></span>åº”ç”¨ç¬”è®°<!----></a></li><li class="dropdown-item"><a href="/apps/Chrome.html" class="nav-link" aria-label="Chrome æ‰©å±•"><span class="icon iconfont icon-chrome"></span>Chrome æ‰©å±•<!----></a></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>æœåŠ¡/ç³»ç»Ÿ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/services/NAS.html" class="nav-link" aria-label="NAS"><span class="icon iconfont icon-process"></span>NAS<!----></a></li><li class="dropdown-subitem"><a href="/windows/faq.html" class="nav-link" aria-label="Windows"><span class="icon iconfont icon-windows"></span>Windows<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç”Ÿæ´»"><span class="title"><span class="icon iconfont icon-emmet"></span>ç”Ÿæ´»</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/family/Diet.html" class="nav-link" aria-label="å¥åº·é¥®é£Ÿ"><span class="icon iconfont icon-enum"></span>å¥åº·é¥®é£Ÿ<!----></a></li><li class="dropdown-item"><a href="/family/Coupon.html" class="nav-link" aria-label="ç½‘è´­æ”»ç•¥"><span class="icon iconfont icon-free"></span>ç½‘è´­æ”»ç•¥<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><div class="nav-item"><a class="repo-link" href="https://github.com/token01/token01.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button class="outlook-button" tabindex="-1" ariahidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="outlook-dropdown"><!----></div></button></div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/DailyRoutine.html" class="nav-link sidebar-link sidebar-page" aria-label="æ¯æ—¥ä»ªå¼"><span class="icon iconfont icon-check"></span>æ¯æ—¥ä»ªå¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/Read.html" class="nav-link sidebar-link sidebar-page" aria-label="è¯»ä¹¦æ–¹æ³•"><span class="icon iconfont icon-read"></span>è¯»ä¹¦æ–¹æ³•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">ğŸš€ ç¼–ç¨‹æŠ€æœ¯</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/code/" class="nav-link sidebar-link sidebar-page" aria-label="ç¼–ç¨‹æ±‡æ€»ï¼ˆæ›´æ–°ä¸­ï¼‰"><span class="icon iconfont icon-code"></span>ç¼–ç¨‹æ±‡æ€»ï¼ˆæ›´æ–°ä¸­ï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/HTML.html" class="nav-link sidebar-link sidebar-page" aria-label="HTML"><span class="icon iconfont icon-html"></span>HTML<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/Javascript.html" class="nav-link sidebar-link sidebar-page" aria-label="JavaScript"><span class="icon iconfont icon-javascript"></span>JavaScript<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/AutoHotkey.html" class="nav-link sidebar-link sidebar-page" aria-label="AutoHotkey"><span class="icon iconfont icon-linter"></span>AutoHotkey<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/Markdown.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdown"><span class="icon iconfont icon-markdown"></span>Markdown<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/code/Electron.html" class="nav-link sidebar-link sidebar-page" aria-label="Electron"><span class="icon iconfont icon-layout"></span>Electron<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading active"><!----><span class="title">ğŸš€ python</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/python/Python.html" class="nav-link sidebar-link sidebar-page" aria-label="Python"><span class="icon iconfont icon-python"></span>Python<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/python/JupyterNotebook.html" class="nav-link sidebar-link sidebar-page" aria-label="LearnNotes"><span class="icon iconfont icon-note"></span>LearnNotes<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/python/WinHidden.html" class="nav-link sidebar-link sidebar-page" aria-label="LearnNotes"><span class="icon iconfont icon-note"></span>LearnNotes<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/python/pandas.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="LearnNotes"><span class="icon iconfont icon-note"></span>LearnNotes<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#pandas" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Pandas"><!---->Pandas<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#å®˜æ–¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å®˜æ–¹"><!---->å®˜æ–¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#éå®˜æ–¹" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="éå®˜æ–¹"><!---->éå®˜æ–¹<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#åŸºç¡€" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="åŸºç¡€"><!---->åŸºç¡€<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#æ—¶é—´å¤„ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="æ—¶é—´å¤„ç†"><!---->æ—¶é—´å¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/python/pandas.html#è¡¨æ ¼ä¸­çš„ç›´æ–¹å›¾-sparkline-å›¾å½¢" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="è¡¨æ ¼ä¸­çš„ç›´æ–¹å›¾ï¼Œsparkline å›¾å½¢"><!---->è¡¨æ ¼ä¸­çš„ç›´æ–¹å›¾ï¼Œsparkline å›¾å½¢<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/python/pySpark.html" class="nav-link sidebar-link sidebar-page" aria-label="Spark in Python"><!---->Spark in Python<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">ğŸ§° è½¯ä»¶åº”ç”¨</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/apps/Applist.html" class="nav-link sidebar-link sidebar-page" aria-label="å¿…å¤‡åº”ç”¨"><span class="icon iconfont icon-list"></span>å¿…å¤‡åº”ç”¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/apps/Chrome.html" class="nav-link sidebar-link sidebar-page" aria-label="Chrome æ‰©å±•"><span class="icon iconfont icon-chrome"></span>Chrome æ‰©å±•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/apps/AppNotes.html" class="nav-link sidebar-link sidebar-page" aria-label="åº”ç”¨ç¬”è®°"><span class="icon iconfont icon-plugin"></span>åº”ç”¨ç¬”è®°<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">ğŸŒ é¡µé¢å¼€å‘</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/web/VuePress.html" class="nav-link sidebar-link sidebar-page" aria-label="VuePress"><span class="icon iconfont icon-vue"></span>VuePress<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/web/docsify.html" class="nav-link sidebar-link sidebar-page" aria-label="docsify"><span class="icon iconfont icon-edit"></span>docsify<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/web/Comments.html" class="nav-link sidebar-link sidebar-page" aria-label="è¯„è®ºæ’ä»¶"><span class="icon iconfont icon-comment"></span>è¯„è®ºæ’ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">ğŸ—ï¸ ç½‘ç«™éƒ¨ç½²</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/deploy/Static.html" class="nav-link sidebar-link sidebar-page" aria-label="é™æ€éƒ¨ç½²"><span class="icon iconfont icon-generic"></span>é™æ€éƒ¨ç½²<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/deploy/VPS.html" class="nav-link sidebar-link sidebar-page" aria-label="æœåŠ¡å™¨ VPS"><span class="icon iconfont icon-IO"></span>æœåŠ¡å™¨ VPS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/deploy/GitHub.html" class="nav-link sidebar-link sidebar-page" aria-label="GitHub"><span class="icon iconfont icon-github"></span>GitHub<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/deploy/Cloudflare.html" class="nav-link sidebar-link sidebar-page" aria-label="Cloudflare"><span class="icon iconfont icon-proxy"></span>Cloudflare<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/deploy/DNS.html" class="nav-link sidebar-link sidebar-page" aria-label="åŸŸå DNS æ‰˜ç®¡"><span class="icon iconfont icon-sitemap"></span>åŸŸå DNS æ‰˜ç®¡<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">ğŸ‹ Linux æœåŠ¡</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/services/NAS.html" class="nav-link sidebar-link sidebar-page" aria-label="NAS"><span class="icon iconfont icon-process"></span>NAS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/services/Huginn.html" class="nav-link sidebar-link sidebar-page" aria-label="Huginn"><span class="icon iconfont icon-customize"></span>Huginn<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/services/TTRSS.html" class="nav-link sidebar-link sidebar-page" aria-label="Tiny Tiny RSS"><span class="icon iconfont icon-rss"></span>Tiny Tiny RSS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/services/Docker.html" class="nav-link sidebar-link sidebar-page" aria-label="Docker"><span class="icon iconfont icon-any"></span>Docker<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">ğŸ‘¥ ç³»ç»Ÿé—®é¢˜</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/windows/faq.html" class="nav-link sidebar-link sidebar-page" aria-label="Windows"><span class="icon iconfont icon-windows"></span>Windows<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/windows/NewSystem.html" class="nav-link sidebar-link sidebar-page" aria-label="ç³»ç»Ÿé‡è£…"><span class="icon iconfont icon-update"></span>ç³»ç»Ÿé‡è£…<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/windows/QTTabBar.html" class="nav-link sidebar-link sidebar-page" aria-label="QTTabBar"><span class="icon iconfont icon-tab"></span>QTTabBar<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title"> ç”Ÿæ´»è®°å½•</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/family/Diet.html" class="nav-link sidebar-link sidebar-page" aria-label="å¥åº·é¥®é£Ÿ"><span class="icon iconfont icon-enum"></span>å¥åº·é¥®é£Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/family/Coupon.html" class="nav-link sidebar-link sidebar-page" aria-label="ç½‘è´­æ”»ç•¥"><span class="icon iconfont icon-free"></span>ç½‘è´­æ”»ç•¥<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/family/HomeAutomation.html" class="nav-link sidebar-link sidebar-page" aria-label="æ™ºèƒ½å®¶å±…"><span class="icon iconfont icon-home"></span>æ™ºèƒ½å®¶å±…<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="icon iconfont icon-blog"></span><a href="/blog.html" class="title">åšå®¢æ–‡ç« </a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/_posts/2022-11-03-ffmpeg_screen_recording.html" class="nav-link sidebar-link sidebar-page" aria-label="3 åˆ†é’Ÿå…¥é—¨ FFmpegï¼ŒæŠ›å¼ƒåˆè´µåˆéš¾ç”¨çš„å½•å±è½¯ä»¶"><!---->3 åˆ†é’Ÿå…¥é—¨ FFmpegï¼ŒæŠ›å¼ƒåˆè´µåˆéš¾ç”¨çš„å½•å±è½¯ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-11-16-Introduction-to-technology.html" class="nav-link sidebar-link sidebar-page" aria-label="æµ…è°ˆæŠ€æœ¯-å›é¡¾"><!---->æµ…è°ˆæŠ€æœ¯-å›é¡¾<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-09-05-stable_diffusion_ai_painting.html" class="nav-link sidebar-link sidebar-page" aria-label="é›¶åŸºç¡€å…¥é—¨ Stable Diffusion - æ— éœ€æ˜¾å¡æŠŠ AI ç»˜ç”»å¼•æ“æ¬è¿›å®¶ç”¨ç”µè„‘"><!---->é›¶åŸºç¡€å…¥é—¨ Stable Diffusion - æ— éœ€æ˜¾å¡æŠŠ AI ç»˜ç”»å¼•æ“æ¬è¿›å®¶ç”¨ç”µè„‘<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-08-22-learndata_blog_to_knowledge_management.html" class="nav-link sidebar-link sidebar-page" aria-label="æŠ›å¼ƒ Notion çŸ¥è¯†ç®¡ç†è½¯ä»¶çš„å°è¯•ï¼šæŠŠåšå®¢å˜ä¸ºçŸ¥è¯†åº“"><!---->æŠ›å¼ƒ Notion çŸ¥è¯†ç®¡ç†è½¯ä»¶çš„å°è¯•ï¼šæŠŠåšå®¢å˜ä¸ºçŸ¥è¯†åº“<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-06-07-blog_md_to_wordpress.html" class="nav-link sidebar-link sidebar-page" aria-label="é›†è‡ªåŠ¨å‘å¸ƒã€æœ¬åœ°ç®¡ç†äºä¸€èº«ï¼šWordPress åšå®¢ç®¡ç†æ–¹æ¡ˆåˆ†äº«"><!---->é›†è‡ªåŠ¨å‘å¸ƒã€æœ¬åœ°ç®¡ç†äºä¸€èº«ï¼šWordPress åšå®¢ç®¡ç†æ–¹æ¡ˆåˆ†äº«<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-05-22-surveillance_video_for_myself.html" class="nav-link sidebar-link sidebar-page" aria-label="ç–«æƒ…å°æ§ä¸¤ä¸ªæœˆåï¼Œæˆ‘å¯¹è‡ªå·±å¼€å§‹ 24 å°æ—¶çš„è‡ªæˆ‘ç›‘æ§å½•åƒ"><!---->ç–«æƒ…å°æ§ä¸¤ä¸ªæœˆåï¼Œæˆ‘å¯¹è‡ªå·±å¼€å§‹ 24 å°æ—¶çš„è‡ªæˆ‘ç›‘æ§å½•åƒ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-04-21-uivision_rpa.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸æƒ³å­¦ Pythonï¼Œé›¶åŸºç¡€ä¹Ÿèƒ½ç”¨çš„è‡ªåŠ¨åŒ–å·¥å…·-UI.Vision RPA"><!---->ä¸æƒ³å­¦ Pythonï¼Œé›¶åŸºç¡€ä¹Ÿèƒ½ç”¨çš„è‡ªåŠ¨åŒ–å·¥å…·-UI.Vision RPA<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-04-20-survivorship_bias_in_shanghai_2022.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸Šæµ·æ²¡åƒçš„ï¼Ÿå‰²è£‚çš„åŸå¸‚ï¼Œæˆ‘çœŸçš„ç”Ÿæ´»åœ¨ä¸Šæµ·å—ï¼Ÿ"><!---->ä¸Šæµ·æ²¡åƒçš„ï¼Ÿå‰²è£‚çš„åŸå¸‚ï¼Œæˆ‘çœŸçš„ç”Ÿæ´»åœ¨ä¸Šæµ·å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-03-21-winget_the_strongest_software_manager_for_windows.html" class="nav-link sidebar-link sidebar-page" aria-label="ä¸€é”®å®‰è£… 99 ä¸ªç¨‹åºï¼ŒWindows æœ€å¼ºè½¯ä»¶ç®¡ç†å™¨"><!---->ä¸€é”®å®‰è£… 99 ä¸ªç¨‹åºï¼ŒWindows æœ€å¼ºè½¯ä»¶ç®¡ç†å™¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-03-17-rss_persistent_link_collection.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS æ±‡æ€»ç¯‡ï¼šRSS æ°¸ä¹…é“¾æ¥åˆé›†ï¼Œæ‹’ç» RSS å¤±æ•ˆ"><!---->RSS æ±‡æ€»ç¯‡ï¼šRSS æ°¸ä¹…é“¾æ¥åˆé›†ï¼Œæ‹’ç» RSS å¤±æ•ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-03-09-lenovo_black_card_member.html" class="nav-link sidebar-link sidebar-page" aria-label="è”æƒ³é»‘é‡‘è¶…æ ¸ä¼šå‘˜æƒ…æŠ¥åˆ†äº«"><!---->è”æƒ³é»‘é‡‘è¶…æ ¸ä¼šå‘˜æƒ…æŠ¥åˆ†äº«<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-02-19-microsoft_store_fixed.html" class="nav-link sidebar-link sidebar-page" aria-label="Windows åº”ç”¨å•†åº— (Microsoft store) æ‰“ä¸å¼€ï¼Ÿ100% è§£å†³æ–¹æ³• - å…¼å®¹ Win10ã€Win11"><!---->Windows åº”ç”¨å•†åº— (Microsoft store) æ‰“ä¸å¼€ï¼Ÿ100% è§£å†³æ–¹æ³• - å…¼å®¹ Win10ã€Win11<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-01-23-wechat_lucky_money_cover.html" class="nav-link sidebar-link sidebar-page" aria-label="æƒ³è¦ç‹¬ä¸€æ— äºŒçš„å¾®ä¿¡çº¢åŒ…ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±åš"><!---->æƒ³è¦ç‹¬ä¸€æ— äºŒçš„å¾®ä¿¡çº¢åŒ…ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±åš<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-10-23-nas_with_rsshub_and_huginn.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS å®Œç»“ç¯‡ï¼šèŠ‚çœåƒå…ƒæœåŠ¡è´¹ï¼ŒRSSHubã€Huginn è½¬ç§» NAS"><!---->RSS å®Œç»“ç¯‡ï¼šèŠ‚çœåƒå…ƒæœåŠ¡è´¹ï¼ŒRSSHubã€Huginn è½¬ç§» NAS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-05-31-principles_criticism_and_self-criticism.html" class="nav-link sidebar-link sidebar-page" aria-label="æ™®é€šäººçš„ç”Ÿæ´»åŸåˆ™ï¼æ‰¹è¯„ä¸è‡ªæˆ‘æ‰¹è¯„"><!---->æ™®é€šäººçš„ç”Ÿæ´»åŸåˆ™ï¼æ‰¹è¯„ä¸è‡ªæˆ‘æ‰¹è¯„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-03-22-live_streaming.html" class="nav-link sidebar-link sidebar-page" aria-label="ç›´æ’­æ–°æ‰‹æ”»ç•¥ï¼šä»å°ç™½å…¥é—¨åˆ°ç½‘çº¢è¾¾äºº"><!---->ç›´æ’­æ–°æ‰‹æ”»ç•¥ï¼šä»å°ç™½å…¥é—¨åˆ°ç½‘çº¢è¾¾äºº<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-01-27-blog_jekyll_to_wordpress.html" class="nav-link sidebar-link sidebar-page" aria-label="Jekyll åšå®¢è¿ç§»ï¼ä» Markdown åˆ° WordPress"><!---->Jekyll åšå®¢è¿ç§»ï¼ä» Markdown åˆ° WordPress<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2021-01-02-keepass_the_real_lastpassword.html" class="nav-link sidebar-link sidebar-page" aria-label="æŠ›å¼ƒ Lastpassï¼Œæ‹¥æŠ± KeePass-å…è´¹å¼€æºçš„ç»¿è‰²å¯†ç ç®¡ç†è½¯ä»¶"><!---->æŠ›å¼ƒ Lastpassï¼Œæ‹¥æŠ± KeePass-å…è´¹å¼€æºçš„ç»¿è‰²å¯†ç ç®¡ç†è½¯ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-11-27-rime_input.html" class="nav-link sidebar-link sidebar-page" aria-label="å°ç‹¼æ¯« 3 åˆ†é’Ÿå…¥é—¨åŠè¿›é˜¶æŒ‡å—"><!---->å°ç‹¼æ¯« 3 åˆ†é’Ÿå…¥é—¨åŠè¿›é˜¶æŒ‡å—<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-11-01-gym_equipment_throw_away.html" class="nav-link sidebar-link sidebar-page" aria-label="è¿™äº›å…¨ç½‘å–çˆ†çš„â€œå¿…å¤‡â€å“ï¼Œæˆ‘åŠä½ åˆ«ä¹°â€¦â€¦"><!---->è¿™äº›å…¨ç½‘å–çˆ†çš„â€œå¿…å¤‡â€å“ï¼Œæˆ‘åŠä½ åˆ«ä¹°â€¦â€¦<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-09-22-uefi_asus_board.html" class="nav-link sidebar-link sidebar-page" aria-label="ã€Œç¡¬ç›˜å¸ƒå±€ä¸å— UEFI å›ºä»¶æ”¯æŒã€ï¼åç¡•ä¸»æ¿è§£å†³æ–¹æ¡ˆ"><!---->ã€Œç¡¬ç›˜å¸ƒå±€ä¸å— UEFI å›ºä»¶æ”¯æŒã€ï¼åç¡•ä¸»æ¿è§£å†³æ–¹æ¡ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-10-25-dpc_watchdog_violation.html" class="nav-link sidebar-link sidebar-page" aria-label="çœŸÂ·DPC_WATCHDOG_VIOLATION è“å±è§£å†³æ–¹æ¡ˆ"><!---->çœŸÂ·DPC_WATCHDOG_VIOLATION è“å±è§£å†³æ–¹æ¡ˆ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-09-13-wifi_speed_up.html" class="nav-link sidebar-link sidebar-page" aria-label="æ— çº¿è·¯ç”±è°ƒæ•´ï¼ŒåŠ å¿« WIFI é€Ÿåº¦"><!---->æ— çº¿è·¯ç”±è°ƒæ•´ï¼ŒåŠ å¿« WIFI é€Ÿåº¦<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2020-03-25-rsshub_on_vps.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS é€Ÿæˆç¯‡ 2ï¼šRSSHub è‡ªéƒ¨ç½²"><!---->RSS é€Ÿæˆç¯‡ 2ï¼šRSSHub è‡ªéƒ¨ç½²<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2019-10-04-fake_aka_hospital_skin_care_products.html" class="nav-link sidebar-link sidebar-page" aria-label="è¿™äº›ã€ŒåŒ»é™¢æŠ¤è‚¤å“ã€ä½ ä¹°äº†å—ï¼Ÿ"><!---->è¿™äº›ã€ŒåŒ»é™¢æŠ¤è‚¤å“ã€ä½ ä¹°äº†å—ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2019-08-26-scrcpy_screen_projection.html" class="nav-link sidebar-link sidebar-page" aria-label="scrcpy - æ‰‹æœºæ— çº¿æŠ•å±åˆ°ç”µè„‘"><!---->scrcpy - æ‰‹æœºæ— çº¿æŠ•å±åˆ°ç”µè„‘<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2019-04-01-rsshub_noob.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS é€Ÿæˆç¯‡ï¼šRSSHub æ¡ç°æˆçš„è½®å­"><!---->RSS é€Ÿæˆç¯‡ï¼šRSSHub æ¡ç°æˆçš„è½®å­<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2019-03-31-openvpn_back_to_home.html" class="nav-link sidebar-link sidebar-page" aria-label="OpenVPN éšæ—¶éšåœ°å›å®¶çš„è·¯"><!---->OpenVPN éšæ—¶éšåœ°å›å®¶çš„è·¯<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-12-28-voice_input_try.html" class="nav-link sidebar-link sidebar-page" aria-label="ç­‰äº†åå¹´ï¼ŒPC ç«¯èƒ½ç”¨çš„è¯­éŸ³è¾“å…¥æ–¹æ¡ˆæ¥äº†"><!---->ç­‰äº†åå¹´ï¼ŒPC ç«¯èƒ½ç”¨çš„è¯­éŸ³è¾“å…¥æ–¹æ¡ˆæ¥äº†<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-10-07-huginn_scraping_any_website.html" class="nav-link sidebar-link sidebar-page" aria-label="RSS è¿›é˜¶ç¯‡ï¼šHuginn - çœŸÂ·ä¸ºä»»æ„ç½‘é¡µå®šåˆ¶ RSS æºï¼ˆPhantomJs æŠ“å–ï¼‰"><!---->RSS è¿›é˜¶ç¯‡ï¼šHuginn - çœŸÂ·ä¸ºä»»æ„ç½‘é¡µå®šåˆ¶ RSS æºï¼ˆPhantomJs æŠ“å–ï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-06-19-iptv_direckly.html" class="nav-link sidebar-link sidebar-page" aria-label="å®¢å…ã€ä¹¦æˆ¿ã€å§å®¤ï¼Œä»»æ„æ”¶çœ‹ IPTV ç›´æ’­ï¼ï¼ˆä¸Šæµ·ç”µä¿¡ï¼‰"><!---->å®¢å…ã€ä¹¦æˆ¿ã€å§å®¤ï¼Œä»»æ„æ”¶çœ‹ IPTV ç›´æ’­ï¼ï¼ˆä¸Šæµ·ç”µä¿¡ï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-06-10-koolproxy_https.html" class="nav-link sidebar-link sidebar-page" aria-label="koolproxy æ— æ³•ä¸‹è½½ https è¯ä¹¦ï¼Ÿ"><!---->koolproxy æ— æ³•ä¸‹è½½ https è¯ä¹¦ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-06-08-baizhuo_gp1700.html" class="nav-link sidebar-link sidebar-page" aria-label="å…‰çŒ«æ”¹é€  ç¯‡ä¸‰ï¼šç™¾å“ GP1700 è¿›é˜¶è®¾ç½® - ç«¯å£æ˜ å°„"><!---->å…‰çŒ«æ”¹é€  ç¯‡ä¸‰ï¼šç™¾å“ GP1700 è¿›é˜¶è®¾ç½® - ç«¯å£æ˜ å°„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-24-airtable_noob.html" class="nav-link sidebar-link sidebar-page" aria-label="çœŸÂ· Airtable 3 åˆ†é’Ÿèœé¸Ÿå…¥é—¨"><!---->çœŸÂ· Airtable 3 åˆ†é’Ÿèœé¸Ÿå…¥é—¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-15-aria2_a_new_download_tool.html" class="nav-link sidebar-link sidebar-page" aria-label="æŠ›å¼ƒè¿…é›·ï¼ŒAria2 æ–°æ‰‹å…¥é—¨"><!---->æŠ›å¼ƒè¿…é›·ï¼ŒAria2 æ–°æ‰‹å…¥é—¨<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-04-audition_cut_mp3.html" class="nav-link sidebar-link sidebar-page" aria-label="æ€ä¹ˆç”¨ Adobe Audition å¿«é€Ÿå‰ªåˆ‡éŸ³é¢‘ï¼Ÿ"><!---->æ€ä¹ˆç”¨ Adobe Audition å¿«é€Ÿå‰ªåˆ‡éŸ³é¢‘ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-03-jekyll_blog_autodeploy.html" class="nav-link sidebar-link sidebar-page" aria-label="Jekyll ç¯‡äºŒï¼šè‡ªåŠ¨éƒ¨ç½²æœåŠ¡å™¨åšå®¢"><!---->Jekyll ç¯‡äºŒï¼šè‡ªåŠ¨éƒ¨ç½²æœåŠ¡å™¨åšå®¢<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-02-jekyll_blog_on_vps.html" class="nav-link sidebar-link sidebar-page" aria-label="Jekyll æ‰©å±•ç¯‡ï¼šæœåŠ¡å™¨æ­å»º Jekyll åšå®¢"><!---->Jekyll æ‰©å±•ç¯‡ï¼šæœåŠ¡å™¨æ­å»º Jekyll åšå®¢<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-05-01-jekyll_blog_on_github_pages.html" class="nav-link sidebar-link sidebar-page" aria-label="Jekyll ç¯‡ä¸€ï¼š3 åˆ†é’Ÿæ­å»º Github Pages åšå®¢"><!---->Jekyll ç¯‡ä¸€ï¼š3 åˆ†é’Ÿæ­å»º Github Pages åšå®¢<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-04-30-baota_deploy_vps.html" class="nav-link sidebar-link sidebar-page" aria-label="æ–°æ‰‹å»ºç«™ç¥å™¨ - å®å¡”é¢æ¿"><!---->æ–°æ‰‹å»ºç«™ç¥å™¨ - å®å¡”é¢æ¿<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-03-06-no_more_dinner.html" class="nav-link sidebar-link sidebar-page" aria-label="ææ—©æ™šé¤ï¼Œé¥¿æ­»ç®—é€‘"><!---->ææ—©æ™šé¤ï¼Œé¥¿æ­»ç®—é€‘<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-01-31-hire_a_robot.html" class="nav-link sidebar-link sidebar-page" aria-label="é›‡ä¸ªæœºå™¨äººå¸®ä½ å¹²æ´»"><!---->é›‡ä¸ªæœºå™¨äººå¸®ä½ å¹²æ´»<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2018-01-19-forget_the_cdn.html" class="nav-link sidebar-link sidebar-page" aria-label="å°å‹ç½‘ç«™ç®¡ç†å‘˜ï¼Œå¿«æ”¾å¼ƒ CDNï¼"><!---->å°å‹ç½‘ç«™ç®¡ç†å‘˜ï¼Œå¿«æ”¾å¼ƒ CDNï¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-10-18-light_cat_port_forwarding.html" class="nav-link sidebar-link sidebar-page" aria-label="å…‰çŒ«æ”¹é€  ç¯‡äºŒï¼šå…‰çŒ« + è·¯ç”±å™¨ï¼Œå®ç°ç«¯å£æ˜ å°„"><!---->å…‰çŒ«æ”¹é€  ç¯‡äºŒï¼šå…‰çŒ« + è·¯ç”±å™¨ï¼Œå®ç°ç«¯å£æ˜ å°„<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-10-18-light_cat_e8-c-epon_admin.html" class="nav-link sidebar-link sidebar-page" aria-label="å…‰çŒ«æ”¹é€  ç¯‡ä¸€ï¼šè¶…çº§ç®¡ç†å‘˜å¯†ç ç ´è§£ï¼ˆE8-C-EPON RG201O-CA_V1A2)"><!---->å…‰çŒ«æ”¹é€  ç¯‡ä¸€ï¼šè¶…çº§ç®¡ç†å‘˜å¯†ç ç ´è§£ï¼ˆE8-C-EPON RG201O-CA_V1A2)<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-09-03-smb_lan_sharing.html" class="nav-link sidebar-link sidebar-page" aria-label="åŠ é€Ÿ SMB åè®®ï¼Œè®© PC å˜èº«å°å‹ NAS"><!---->åŠ é€Ÿ SMB åè®®ï¼Œè®© PC å˜èº«å°å‹ NAS<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-09-02-forced_shutdown.html" class="nav-link sidebar-link sidebar-page" aria-label="ç”µè„‘å…³æœºäº†ï¼Œç¬¬äºŒå¤©ä¸€çœ‹ç¡®åˆå¼€ç€çš„ï¼Ÿè®©ç³»ç»Ÿæ­£å¸¸å…³æœºï¼"><!---->ç”µè„‘å…³æœºäº†ï¼Œç¬¬äºŒå¤©ä¸€çœ‹ç¡®åˆå¼€ç€çš„ï¼Ÿè®©ç³»ç»Ÿæ­£å¸¸å…³æœºï¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-07-29-onenote_2016_cannot_be_logged_in.html" class="nav-link sidebar-link sidebar-page" aria-label="OneNote 2016 æ— æ³•ç™»é™†é—®é¢˜è§£å†³"><!---->OneNote 2016 æ— æ³•ç™»é™†é—®é¢˜è§£å†³<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-07-28-office_2016_installer_error.html" class="nav-link sidebar-link sidebar-page" aria-label="office 2016 å®‰è£…ç¨‹åºæŠ¥é”™è§£å†³åŠæ³•"><!---->office 2016 å®‰è£…ç¨‹åºæŠ¥é”™è§£å†³åŠæ³•<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2017-04-18-wechat_multi_open.html" class="nav-link sidebar-link sidebar-page" aria-label="ç”µè„‘ä¸Šå®ç°å¾®ä¿¡åŒå¼€ï¼Œæ— éœ€ç½‘é¡µç‰ˆæˆ–ç¬¬ä¸‰æ–¹è½¯ä»¶"><!---->ç”µè„‘ä¸Šå®ç°å¾®ä¿¡åŒå¼€ï¼Œæ— éœ€ç½‘é¡µç‰ˆæˆ–ç¬¬ä¸‰æ–¹è½¯ä»¶<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/_posts/2022-09-07-extreme_branding_thinking_with_mate50.html" class="nav-link sidebar-link sidebar-page" aria-label="ã€Œåä¸ºæ²¡ç”µä¹Ÿèƒ½æ‰“ç”µè¯ã€ã€ŒiPhone æ²¡ç”µä¹Ÿèƒ½åˆ·å…¬äº¤å¡ã€ï¼Œæ‰‹æœºå“ç‰Œæ˜¯è¢«ç»‘æ¶è¿˜æ˜¯è¡Œä¸šåº•çº¿å°±æ˜¯ä½ï¼Ÿ"><!---->ã€Œåä¸ºæ²¡ç”µä¹Ÿèƒ½æ‰“ç”µè¯ã€ã€ŒiPhone æ²¡ç”µä¹Ÿèƒ½åˆ·å…¬äº¤å¡ã€ï¼Œæ‰‹æœºå“ç‰Œæ˜¯è¢«ç»‘æ¶è¿˜æ˜¯è¡Œä¸šåº•çº¿å°±æ˜¯ä½ï¼Ÿ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="icon iconfont icon-note"></span>LearnNotes</h1><div class="page-info"><!----><!----><span class="words-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 5944 å­—</span><meta property="wordCount" content="5944"></span><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 20 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT20M"></span><span class="visitor-info" aria-label="è®¿é—®é‡ğŸ”¢" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon eye-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="eye icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 00-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z"></path></svg><span class="waline-pageview-count" data-path="/python/pandas.html">...</span></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#pandas" class="router-link-active router-link-exact-active toc-link level2">Pandas</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#å®˜æ–¹" class="router-link-active router-link-exact-active toc-link level3">å®˜æ–¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#éå®˜æ–¹" class="router-link-active router-link-exact-active toc-link level3">éå®˜æ–¹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#åŸºç¡€" class="router-link-active router-link-exact-active toc-link level3">åŸºç¡€</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#æ—¶é—´å¤„ç†" class="router-link-active router-link-exact-active toc-link level3">æ—¶é—´å¤„ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/python/pandas.html#è¡¨æ ¼ä¸­çš„ç›´æ–¹å›¾-sparkline-å›¾å½¢" class="router-link-active router-link-exact-active toc-link level3">è¡¨æ ¼ä¸­çš„ç›´æ–¹å›¾ï¼Œsparkline å›¾å½¢</a></li><!----><!--]--></ul><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="pandas" tabindex="-1"><a class="header-anchor" href="#pandas" aria-hidden="true">#</a> Pandas</h2><blockquote><p>Pandas æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åˆ†æç»“æ„åŒ–æ•°æ®çš„å·¥å…·é›†ï¼Œå®ƒçš„ä½¿ç”¨åŸºç¡€æ˜¯ Numpyï¼ˆæä¾›é«˜æ€§èƒ½çš„çŸ©é˜µè¿ç®—ï¼‰ï¼Œç”¨äºæ•°æ®æŒ–æ˜å’Œæ•°æ®åˆ†æï¼ŒåŒæ—¶ä¹Ÿæä¾›æ•°æ®æ¸…æ´—åŠŸèƒ½ã€‚</p></blockquote><h3 id="å®˜æ–¹" tabindex="-1"><a class="header-anchor" href="#å®˜æ–¹" aria-hidden="true">#</a> å®˜æ–¹</h3><ul><li><a href="https://pandas.pydata.org/docs/reference/index.html#api" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://github.com/pandas-dev/pandas" target="_blank" rel="noopener noreferrer">æºä»£ç <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="éå®˜æ–¹" tabindex="-1"><a class="header-anchor" href="#éå®˜æ–¹" aria-hidden="true">#</a> éå®˜æ–¹</h3><ul><li><a href="https://www.gairuo.com/p/pandas-tutorial" target="_blank" rel="noopener noreferrer">Pandas æ•™ç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.gairuo.com/p/numpy-tutorial" target="_blank" rel="noopener noreferrer">numpy æ•™ç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.gairuo.com/p/regular-expression" target="_blank" rel="noopener noreferrer">æ­£åˆ™è¡¨è¾¾å¼è¯­æ³•<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h3 id="åŸºç¡€" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€" aria-hidden="true">#</a> åŸºç¡€</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd  <span class="token comment"># æœ€æ–°ä¸º 1.0.4 ç‰ˆæœ¬ (2020-05-29)</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
<span class="token operator">%</span>matplotlib inline

<span class="token comment">#dfï¼šä»»æ„çš„ Pandas DataFrame å¯¹è±¡</span>
<span class="token comment">#sï¼šä»»æ„çš„ Pandas Series å¯¹è±¡</span>
<span class="token comment">#æ³¨ï¼šæœ‰äº›å±æ€§æ–¹æ³• df å’Œ s éƒ½å¯ä»¥ä½¿ç”¨</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å¯¼å…¥å¯¼å‡ºæ•°æ®" tabindex="-1"><a class="header-anchor" href="#å¯¼å…¥å¯¼å‡ºæ•°æ®" aria-hidden="true">#</a> å¯¼å…¥å¯¼å‡ºæ•°æ®</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># ä» CSV æ–‡ä»¶å¯¼å…¥æ•°æ®</span>
pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;file.csv&#39;</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;åˆ—å&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;åˆ—å2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># ä»é™å®šåˆ†éš”ç¬¦çš„æ–‡æœ¬æ–‡ä»¶å¯¼å…¥æ•°æ®</span>
pd<span class="token punctuation">.</span>read_table<span class="token punctuation">(</span>filename<span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># Excel å¯¼å…¥ï¼ŒæŒ‡å®š sheet å’Œè¡¨å¤´</span>
pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">&#39;file.xlsx&#39;</span><span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">&#39; è¡¨1&#39;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
<span class="token comment"># ä» SQL è¡¨/åº“å¯¼å…¥æ•°æ®</span>
pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span>query<span class="token punctuation">,</span> connection_object<span class="token punctuation">)</span>
<span class="token comment"># ä» JSON æ ¼å¼çš„å­—ç¬¦ä¸²å¯¼å…¥æ•°æ®</span>
pd<span class="token punctuation">.</span>read_json<span class="token punctuation">(</span>json_string<span class="token punctuation">)</span>
<span class="token comment"># è§£æ URLã€å­—ç¬¦ä¸²æˆ–è€… HTML æ–‡ä»¶ï¼ŒæŠ½å–å…¶ä¸­çš„ tables è¡¨æ ¼</span>
pd<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
<span class="token comment"># ä»ä½ çš„ç²˜è´´æ¿è·å–å†…å®¹ï¼Œå¹¶ä¼ ç»™ read_table()</span>
pd<span class="token punctuation">.</span>read_clipboard<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># ä»å­—å…¸å¯¹è±¡å¯¼å…¥æ•°æ®ï¼ŒKey æ˜¯åˆ—åï¼ŒValueæ˜¯æ•°æ®</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token builtin">dict</span><span class="token punctuation">)</span>
<span class="token comment"># å¯¼å…¥å­—ç¬¦ä¸²</span>
<span class="token keyword">from</span> io <span class="token keyword">import</span> StringIO
pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>StringIO<span class="token punctuation">(</span>web_data<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># å¯¼å‡ºæ•°æ®åˆ°CSVæ–‡ä»¶</span>
df<span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">&#39;filename.csv&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># å¯¼å‡ºæ•°æ®åˆ°Excelæ–‡ä»¶</span>
df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">&#39;filename.xlsx&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># å¯¼å‡ºæ•°æ®åˆ° SQL è¡¨</span>
df<span class="token punctuation">.</span>to_sql<span class="token punctuation">(</span>table_name<span class="token punctuation">,</span> connection_object<span class="token punctuation">)</span>
<span class="token comment"># ä»¥Jsonæ ¼å¼å¯¼å‡ºæ•°æ®åˆ°æ–‡æœ¬æ–‡ä»¶</span>
df<span class="token punctuation">.</span>to_json<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
<span class="token comment"># å…¶ä»–</span>
df<span class="token punctuation">.</span>to_html<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># æ˜¾ç¤º HTML ä»£ç </span>
df<span class="token punctuation">.</span>to_markdown<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æ˜¾ç¤º markdown ä»£ç </span>
df<span class="token punctuation">.</span>to_string<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æ˜¾ç¤ºæ ¼å¼åŒ–å­—ç¬¦</span>
df<span class="token punctuation">.</span>to_latex<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># LaTeX tabular, longtable</span>
df<span class="token punctuation">.</span>to_dict<span class="token punctuation">(</span><span class="token string">&#39;split&#39;</span><span class="token punctuation">)</span> <span class="token comment"># å­—å…¸, æ ¼å¼ list/series/records/index</span>
df<span class="token punctuation">.</span>to_clipboard<span class="token punctuation">(</span>sep<span class="token operator">=</span><span class="token string">&#39;,&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># å­˜å…¥ç³»ç»Ÿå‰ªè´´æ¿</span>

<span class="token comment"># å°†ä¸¤ä¸ªè¡¨æ ¼è¾“å‡ºåˆ°ä¸€ä¸ªexcelæ–‡ä»¶é‡Œé¢,å¯¼å‡ºåˆ°å¤šä¸ª sheet</span>
writer<span class="token operator">=</span>pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">&#39;new.xlsx&#39;</span><span class="token punctuation">)</span>
df_1<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">&#39;ç¬¬ä¸€ä¸ª&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
df_2<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">&#39;ç¬¬äºŒä¸ª&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
writer<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å¿…é¡»è¿è¡Œwriter.save()ï¼Œä¸ç„¶ä¸èƒ½è¾“å‡ºåˆ°æœ¬åœ°</span>

<span class="token comment"># å†™æ³•2</span>
<span class="token keyword">with</span> pd<span class="token punctuation">.</span>ExcelWriter<span class="token punctuation">(</span><span class="token string">&#39;new.xlsx&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> writer<span class="token punctuation">:</span>
    df1<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">&#39;ç¬¬ä¸€ä¸ª&#39;</span><span class="token punctuation">)</span>
    df2<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>writer<span class="token punctuation">,</span> sheet_name<span class="token operator">=</span><span class="token string">&#39;ç¬¬äºŒä¸ª&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># ç”¨ xlsxwriter å¯¼å‡ºæ”¯æŒåˆå¹¶å•å…ƒæ ¼ã€é¢œè‰²ã€å›¾è¡¨ç­‰å®šåˆ¶åŠŸèƒ½</span>
<span class="token comment"># https://xlsxwriter.readthedocs.io/working_with_pandas.html</span>
<span class="token comment"># pd.ExcelWriter(&#39;new.xlsx&#39;,engine=&#39;xlsxwriter&#39;)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æµ‹è¯•æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æµ‹è¯•æ•°æ®" aria-hidden="true">#</a> æµ‹è¯•æ•°æ®</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># åˆ›å»º20è¡Œ5åˆ—çš„éšæœºæ•°ç»„æˆçš„ DataFrame å¯¹è±¡</span>
pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># ä»å¯è¿­ä»£å¯¹è±¡ my_list åˆ›å»ºä¸€ä¸ª Series å¯¹è±¡</span>
pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span>my_list<span class="token punctuation">)</span>
<span class="token comment"># å¢åŠ ä¸€ä¸ªæ—¥æœŸç´¢å¼•</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span><span class="token string">&#39;1900/1/30&#39;</span><span class="token punctuation">,</span> periods<span class="token operator">=</span>df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># åˆ›å»ºéšæœºæ•°æ®é›†</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>makeDataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># åˆ›å»ºéšæœºæ—¥æœŸç´¢å¼•æ•°æ®é›†</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>makePeriodFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>makeTimeDataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># åˆ›å»ºéšæœºæ··åˆç±»å‹æ•°æ®é›†</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>util<span class="token punctuation">.</span>testing<span class="token punctuation">.</span>makeMixedDataFrame<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æŸ¥çœ‹ã€æ£€æŸ¥ã€ç»Ÿè®¡ã€å±æ€§" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹ã€æ£€æŸ¥ã€ç»Ÿè®¡ã€å±æ€§" aria-hidden="true">#</a> æŸ¥çœ‹ã€æ£€æŸ¥ã€ç»Ÿè®¡ã€å±æ€§</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>head<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># æŸ¥çœ‹ DataFrame å¯¹è±¡çš„å‰nè¡Œ</span>
df<span class="token punctuation">.</span>tail<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># æŸ¥çœ‹ DataFrame å¯¹è±¡çš„æœ€ånè¡Œ</span>
df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token comment"># æŸ¥çœ‹ n ä¸ªæ ·æœ¬ï¼Œéšæœº</span>
df<span class="token punctuation">.</span>shape <span class="token comment"># æŸ¥çœ‹è¡Œæ•°å’Œåˆ—æ•°</span>
df<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æŸ¥çœ‹ç´¢å¼•ã€æ•°æ®ç±»å‹å’Œå†…å­˜ä¿¡æ¯</span>
df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æŸ¥çœ‹æ•°å€¼å‹åˆ—çš„æ±‡æ€»ç»Ÿè®¡</span>
df<span class="token punctuation">.</span>dtypes <span class="token comment"># æŸ¥çœ‹å„å­—æ®µç±»å‹</span>
df<span class="token punctuation">.</span>axes <span class="token comment"># æ˜¾ç¤ºæ•°æ®è¡Œå’Œåˆ—å</span>
df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›æ‰€æœ‰åˆ—çš„å‡å€¼</span>
df<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›æ‰€æœ‰è¡Œçš„å‡å€¼ï¼Œä¸‹åŒ</span>
df<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›åˆ—ä¸åˆ—ä¹‹é—´çš„ç›¸å…³ç³»æ•°</span>
df<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›æ¯ä¸€åˆ—ä¸­çš„éç©ºå€¼çš„ä¸ªæ•°</span>
df<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›æ¯ä¸€åˆ—çš„æœ€å¤§å€¼</span>
df<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›æ¯ä¸€åˆ—çš„æœ€å°å€¼</span>
df<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›æ¯ä¸€åˆ—çš„ä¸­ä½æ•°</span>
df<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›æ¯ä¸€åˆ—çš„æ ‡å‡†å·®</span>
df<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æ–¹å·®</span>
s<span class="token punctuation">.</span>mode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># ä¼—æ•°</span>
s<span class="token punctuation">.</span>prod<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># è¿ä¹˜</span>
s<span class="token punctuation">.</span>cumprod<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># ç´¯ç§¯è¿ä¹˜,ç´¯ä¹˜</span>
df<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># ç´¯ç§¯è¿åŠ ,ç´¯åŠ </span>
s<span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å»é‡æ•°é‡ï¼Œä¸åŒå€¼çš„é‡</span>
df<span class="token punctuation">.</span>idxmax<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æ¯åˆ—æœ€å¤§çš„å€¼çš„ç´¢å¼•å</span>
df<span class="token punctuation">.</span>idxmin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æœ€å°</span>
df<span class="token punctuation">.</span>columns <span class="token comment"># æ˜¾ç¤ºæ‰€æœ‰åˆ—å</span>
df<span class="token punctuation">.</span>team<span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æ˜¾ç¤ºåˆ—ä¸­çš„ä¸é‡å¤å€¼</span>
<span class="token comment"># æŸ¥çœ‹ Series å¯¹è±¡çš„å”¯ä¸€å€¼å’Œè®¡æ•°, è®¡æ•°å æ¯”: normalize=True</span>
s<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span>dropna<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment"># æŸ¥çœ‹ DataFrame å¯¹è±¡ä¸­æ¯ä¸€åˆ—çš„å”¯ä¸€å€¼å’Œè®¡æ•°</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">.</span>value_counts<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>duplicated<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># é‡å¤è¡Œ</span>
df<span class="token punctuation">.</span>drop_duplicates<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤é‡å¤è¡Œ</span>
<span class="token comment"># set_optionã€reset_optionã€describe_option è®¾ç½®æ˜¾ç¤ºè¦æ±‚</span>
pd<span class="token punctuation">.</span>get_option<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># è®¾ç½®è¡Œåˆ—æœ€å¤§æ˜¾ç¤ºæ•°é‡ï¼ŒNone ä¸ºä¸é™åˆ¶(jupyter notebok)</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_rows <span class="token operator">=</span> <span class="token boolean">None</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_columns <span class="token operator">=</span> <span class="token boolean">None</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_colwidth <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token comment"># æ¢å¤é»˜è®¤å€¼</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_rows <span class="token operator">=</span> <span class="token number">60</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_columns <span class="token operator">=</span> <span class="token number">20</span>
pd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>display<span class="token punctuation">.</span>max_colwidth <span class="token operator">=</span> <span class="token number">50</span>
df<span class="token punctuation">.</span>col<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æœ€å¤§å€¼[æœ€å°å€¼ .argmax()] æ‰€åœ¨ä½ç½®çš„è‡ªåŠ¨ç´¢å¼•</span>
df<span class="token punctuation">.</span>col<span class="token punctuation">.</span>idxmin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æœ€å¤§å€¼[æœ€å°å€¼ .idxmax()] æ‰€åœ¨ä½ç½®çš„å®šä¹‰ç´¢å¼•</span>
<span class="token comment"># ç´¯è®¡ç»Ÿè®¡</span>
ds<span class="token punctuation">.</span>cumsum<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å‰è¾¹æ‰€æœ‰å€¼ä¹‹å’Œ</span>
ds<span class="token punctuation">.</span>cumprod<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å‰è¾¹æ‰€æœ‰å€¼ä¹‹ç§¯</span>
ds<span class="token punctuation">.</span>cummax<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å‰è¾¹æ‰€æœ‰å€¼çš„æœ€å¤§å€¼</span>
ds<span class="token punctuation">.</span>cummin<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å‰è¾¹æ‰€æœ‰å€¼çš„æœ€å°å€¼</span>
<span class="token comment"># çª—å£è®¡ç®—(æ»šåŠ¨è®¡ç®—)</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#ä¾æ¬¡è®¡ç®—ç›¸é‚»xä¸ªå…ƒç´ çš„å’Œ</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#ä¾æ¬¡è®¡ç®—ç›¸é‚»xä¸ªå…ƒç´ çš„ç®—æœ¯å¹³å‡</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#ä¾æ¬¡è®¡ç®—ç›¸é‚»xä¸ªå…ƒç´ çš„æ–¹å·®</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#ä¾æ¬¡è®¡ç®—ç›¸é‚»xä¸ªå…ƒç´ çš„æ ‡å‡†å·®</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#ä¾æ¬¡è®¡ç®—ç›¸é‚»xä¸ªå…ƒç´ çš„æœ€å°å€¼</span>
ds<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#ä¾æ¬¡è®¡ç®—ç›¸é‚»xä¸ªå…ƒç´ çš„æœ€å¤§å€¼</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ•°æ®æ¸…ç†" tabindex="-1"><a class="header-anchor" href="#æ•°æ®æ¸…ç†" aria-hidden="true">#</a> æ•°æ®æ¸…ç†</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;b&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;c&#39;</span><span class="token punctuation">]</span> <span class="token comment"># é‡å‘½ååˆ—å</span>
df<span class="token punctuation">.</span>columns <span class="token operator">=</span> df<span class="token punctuation">.</span>columns<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39; &#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;_&#39;</span><span class="token punctuation">)</span> <span class="token comment"># åˆ—åç©ºæ ¼æ¢ä¸‹åˆ’çº¿</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># æ‰¹é‡æ›´æ”¹åˆ—å</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;old_name&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;new_name&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># é€‰æ‹©æ€§æ›´æ”¹åˆ—å</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;column_one&#39;</span><span class="token punctuation">)</span> <span class="token comment"># æ›´æ”¹ç´¢å¼•åˆ—</span>
df<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># æ‰¹é‡é‡å‘½åç´¢å¼•</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>AAA <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;BBB&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;CCC&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">555</span> <span class="token comment"># æ›¿æ¢æ•°æ®</span>
df<span class="token punctuation">[</span><span class="token string">&#39;pf&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>site_id<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">&#39;å°ç¨‹åº&#39;</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">:</span><span class="token string">&#39;M ç«™&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># å°†æšä¸¾æ¢æˆåç§°</span>
pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æ£€æŸ¥DataFrameå¯¹è±¡ä¸­çš„ç©ºå€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ª Boolean æ•°ç»„</span>
pd<span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># æ£€æŸ¥DataFrameå¯¹è±¡ä¸­çš„éç©ºå€¼ï¼Œå¹¶è¿”å›ä¸€ä¸ª Boolean æ•°ç»„</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤åˆ—</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤è¡Œ</span>
df<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>df<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;colname&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;ä¸è¯¦&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;110&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>index<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment"># åˆ é™¤è¡Œ</span>
<span class="token keyword">del</span> df<span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span> <span class="token comment"># åˆ é™¤åˆ—</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤æ‰€æœ‰åŒ…å«ç©ºå€¼çš„è¡Œ</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤æ‰€æœ‰åŒ…å«ç©ºå€¼çš„åˆ—</span>
df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span>thresh<span class="token operator">=</span>n<span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤æ‰€æœ‰å°äº n ä¸ªéç©ºå€¼çš„è¡Œ</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token comment"># ç”¨xæ›¿æ¢DataFrameå¯¹è±¡ä¸­æ‰€æœ‰çš„ç©ºå€¼</span>
df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;prov&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;æœªçŸ¥&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># æŒ‡å®šåˆ—çš„ç©ºå€¼æ›¿æ¢ä¸ºæŒ‡å®šå†…å®¹</span>
s<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">float</span><span class="token punctuation">)</span> <span class="token comment"># å°†Seriesä¸­çš„æ•°æ®ç±»å‹æ›´æ”¹ä¸º float ç±»å‹</span>
df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;datetime64[ns]&#39;</span><span class="token punctuation">)</span> <span class="token comment"># è½¬åŒ–ä¸ºæ—¶é—´æ ¼å¼</span>
s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;one&#39;</span><span class="token punctuation">)</span> <span class="token comment"># ç”¨ â€˜oneâ€™ ä»£æ›¿æ‰€æœ‰ç­‰äº 1 çš„å€¼</span>
s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&#39;one&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;three&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># ç”¨&#39;one&#39;ä»£æ›¿ 1ï¼Œç”¨ &#39;three&#39; ä»£æ›¿ 3</span>
df<span class="token punctuation">[</span><span class="token string">&#39;æ˜¯å¦è®¾ç½®æç°è´¦å·&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;çŠ¶æ€&#39;</span><span class="token punctuation">]</span> <span class="token comment"># å¤åˆ¶ä¸€åˆ—</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># åˆ—é¡ºåºåè½¬</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token comment"># è¡Œé¡ºåºåè½¬, ä¸‹æ–¹ä¸ºé‡æ–°å®šä¹‰ç´¢å¼•</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># ä¿®æ”¹æŸä¸ªcell</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;colname&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;colname&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&#39;newvalue&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ•°æ®å¤„ç†ã€filterã€sort" tabindex="-1"><a class="header-anchor" href="#æ•°æ®å¤„ç†ã€filterã€sort" aria-hidden="true">#</a> æ•°æ®å¤„ç†ã€Filterã€Sort</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># ä¿ç•™å°æ•°ä½ï¼Œå››èˆå…­å…¥äº”æˆåŒ</span>
df<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># å…¨éƒ¨</span>
df<span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;C&#39;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment"># æŒ‡å®šåˆ—</span>
df<span class="token punctuation">[</span><span class="token string">&#39;Name&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>Name <span class="token comment"># å–åˆ—åçš„ä¸¤ä¸ªæ–¹æ³•</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>index <span class="token operator">==</span> <span class="token string">&#39;Jude&#39;</span><span class="token punctuation">]</span> <span class="token comment"># ç´¢å¼•åˆ—çš„æŸ¥è¯¢è¦ç”¨ .index</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">0.5</span><span class="token punctuation">]</span> <span class="token comment"># é€‰æ‹©colåˆ—çš„å€¼å¤§äº0.5çš„è¡Œ</span>
<span class="token comment"># å¤šæ¡ä»¶æŸ¥è¯¢</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;team&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>
   <span class="token punctuation">(</span> df<span class="token punctuation">[</span><span class="token string">&#39;Q1&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">80</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>
   df<span class="token punctuation">.</span>utype<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;è€å®¢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;è€è®¿å®¢&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># ç­›é€‰ä¸ºç©ºçš„å†…å®¹</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>order<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># ç±»ä¼¼ SQL where in</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>team<span class="token punctuation">.</span>isin<span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>team<span class="token operator">==</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">.</span>Q1 <span class="token operator">==</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token operator">~</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;team&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span> df<span class="token punctuation">[</span><span class="token string">&#39;Q1&#39;</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># éï¼Œæˆ–</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Name<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">&#39;å¼ &#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># åŒ…å«å­—ç¬¦</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>col1<span class="token punctuation">)</span> <span class="token comment"># æŒ‰ç…§åˆ—col1æ’åºæ•°æ®ï¼Œé»˜è®¤å‡åºæ’åˆ—</span>
df<span class="token punctuation">.</span>col1<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># åŒä¸Š, -&gt; s</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>col2<span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># æŒ‰ç…§åˆ— col1 é™åºæ’åˆ—æ•°æ®</span>
<span class="token comment"># å…ˆæŒ‰åˆ—col1å‡åºæ’åˆ—ï¼ŒåæŒ‰col2é™åºæ’åˆ—æ•°æ®</span>
df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>get_dummies<span class="token punctuation">(</span>df<span class="token punctuation">,</span> prefix<span class="token operator">=</span><span class="token string">&#39;t_&#39;</span><span class="token punctuation">)</span> <span class="token comment"># å°†æšä¸¾çš„é‚£äº›åˆ—å¸¦æšä¸¾è½¬åˆ°åˆ—ä¸Š</span>
s<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># å¤šç´¢å¼•å¤„ç†</span>
dd<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;utype&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;site_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;p_day&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
dd<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># æŒ‰ç´¢å¼•æ’åº</span>
dd<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;æ–°è®¿å®¢&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;2019-06-22&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>barh<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># loc ä¸­æŒ‰é¡ºåºæŒ‡å®šç´¢å¼•å†…å®¹</span>
<span class="token comment"># å‰100è¡Œ, ä¸èƒ½æŒ‡å®šè¡Œï¼Œå¦‚ï¼šdf[100]</span>
df<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100</span><span class="token punctuation">]</span>
<span class="token comment"># åªå–æŒ‡å®šè¡Œ</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;è®¾è®¡å¸ˆID&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;å§“å&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token comment"># å°†ageså¹³åˆ†æˆ5ä¸ªåŒºé—´å¹¶æŒ‡å®š labels</span>
ages <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">40</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">,</span><span class="token number">62</span><span class="token punctuation">,</span><span class="token number">77</span><span class="token punctuation">,</span><span class="token number">89</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>cut<span class="token punctuation">(</span>ages<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
       labels<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">u&quot;å©´å„¿&quot;</span><span class="token punctuation">,</span><span class="token string">u&quot;é’å¹´&quot;</span><span class="token punctuation">,</span><span class="token string">u&quot;ä¸­å¹´&quot;</span><span class="token punctuation">,</span><span class="token string">u&quot;å£®å¹´&quot;</span><span class="token punctuation">,</span><span class="token string">u&quot;è€å¹´&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

daily_index<span class="token punctuation">.</span>difference<span class="token punctuation">(</span>df_work_day<span class="token punctuation">.</span>index<span class="token punctuation">)</span> <span class="token comment"># å–å‡ºå·®åˆ«</span>
<span class="token comment"># æ ¼å¼åŒ–</span>
df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>name <span class="token comment"># ç´¢å¼•çš„åç§° str</span>
df<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>æ€»äººå£<span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span>
data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span> <span class="token comment"># å¯¹ DataFrame ä¸­çš„æ¯ä¸€åˆ—åº”ç”¨å‡½æ•° np.mean</span>
data<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># å¯¹ DataFrame ä¸­çš„æ¯ä¸€è¡Œåº”ç”¨å‡½æ•° np.max</span>
df<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;three&#39;</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> allow_duplicates<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># æ’å…¥åˆ— (ä½ç½®ã€åˆ—åã€[å€¼])</span>
df<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">&#39;class&#39;</span><span class="token punctuation">)</span> <span class="token comment"># åˆ é™¤åˆ—</span>
<span class="token comment"># å¢åŠ ä¸€è¡Œ</span>
df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;one&#39;</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
                        <span class="token string">&#39;two&#39;</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">,</span>
                        <span class="token string">&#39;three&#39;</span><span class="token punctuation">:</span> <span class="token number">4.4</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
                       index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;f&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          sort<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‡å®šæ–°åˆ—</span>
iris<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>sepal_ratio<span class="token operator">=</span>iris<span class="token punctuation">[</span><span class="token string">&#39;SepalWidth&#39;</span><span class="token punctuation">]</span> <span class="token operator">/</span> iris<span class="token punctuation">[</span><span class="token string">&#39;SepalLength&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>rate<span class="token operator">=</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">.</span>orders<span class="token operator">/</span>df<span class="token punctuation">.</span>uv<span class="token punctuation">)</span>
<span class="token comment"># shift å‡½æ•°æ˜¯å¯¹æ•°æ®è¿›è¡Œå¹³ç§»åŠ¨çš„æ“ä½œ</span>
df<span class="token punctuation">[</span><span class="token string">&#39;å¢å¹…&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;å›½å†…ç”Ÿäº§æ€»å€¼&#39;</span><span class="token punctuation">]</span> <span class="token operator">-</span> df<span class="token punctuation">[</span><span class="token string">&#39;å›½å†…ç”Ÿäº§æ€»å€¼&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>tshift<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># æ—¶é—´ç§»åŠ¨ï¼ŒæŒ‰å‘¨æœŸ</span>
<span class="token comment"># å’Œä¸Šç›¸åŒï¼Œdiff å‡½æ•°æ˜¯ç”¨æ¥å°†æ•°æ®è¿›è¡Œç§»åŠ¨ä¹‹åä¸åŸæ•°æ®å·®</span>
<span class="token comment"># å¼‚æ•°æ®ï¼Œç­‰äº df.shift()-df</span>
df<span class="token punctuation">[</span><span class="token string">&#39;å¢å¹…&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;å›½å†…ç”Ÿäº§æ€»å€¼&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diff<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># ç•™å­˜æ•°æ®ï¼Œå› ä¸ºæœ€å¤§ä¸€èˆ¬ä¸ºæ•°æ®æ± </span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token operator">/</span>x<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># å– best åˆ—ä¸­å€¼ä¸ºåˆ—åçš„å€¼å†™åˆ° name è¡Œä¸Š</span>
df<span class="token punctuation">[</span><span class="token string">&#39;value&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>lookup<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;best&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

s<span class="token punctuation">.</span>where<span class="token punctuation">(</span>s <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token comment"># æ»¡è¶³æ¡ä»¶ä¸‹æ•°æ®æ›¿æ¢ï¼ˆ10ï¼Œç©ºä¸º NaNï¼‰</span>
s<span class="token punctuation">.</span>mask<span class="token punctuation">(</span>s <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># ç•™ä¸‹æ»¡è¶³æ¡ä»¶çš„ï¼Œå…¶ä»–çš„é»˜è®¤ä¸º NaN</span>
<span class="token comment"># æ‰€æœ‰å€¼åŠ  1 (åŠ å‡ä¹˜é™¤ç­‰)</span>
df <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">/</span> df<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># ç®¡é“æ–¹æ³•ï¼Œé“¾å¼è°ƒç”¨å‡½æ•°ï¼Œf(df)=df.pipe(f)</span>
<span class="token keyword">def</span> <span class="token function">gb</span><span class="token punctuation">(</span>df<span class="token punctuation">,</span> by<span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> df<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    result <span class="token operator">=</span> result<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result
<span class="token comment"># è°ƒç”¨</span>
df<span class="token punctuation">.</span>pipe<span class="token punctuation">(</span>gb<span class="token punctuation">,</span> by<span class="token operator">=</span><span class="token string">&#39;team&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># çª—å£è®¡ç®— &#39;2s&#39; ä¸ºä¸¤ç§’</span>
df<span class="token punctuation">.</span>rolling<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># åœ¨çª—å£ç»“æœåŸºç¡€ä¸Šçš„çª—å£è®¡ç®—</span>
df<span class="token punctuation">.</span>expanding<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># è¶…å‡ºï¼ˆå¤§äºã€å°äºï¼‰çš„å€¼æ›¿æ¢æˆå¯¹åº”å€¼</span>
df<span class="token punctuation">.</span>clip<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
<span class="token comment"># AB ä¸¤åˆ—æƒ³åŠ å¢åŠ  C åˆ—</span>
df<span class="token punctuation">[</span><span class="token string">&#39;C&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">&#39;A+B&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># å’Œä¸Šç›¸åŒæ•ˆæœ</span>
df<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">&#39;C = A + B&#39;</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token comment"># æ•°åˆ—çš„å˜åŒ–ç™¾åˆ†æ¯”</span>
s<span class="token punctuation">.</span>pct_change<span class="token punctuation">(</span>periods<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># åˆ†ä½æ•°, å¯å®ç°æ—¶é—´çš„ä¸­é—´ç‚¹</span>
df<span class="token punctuation">.</span>quantile<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">)</span>
<span class="token comment"># æ’å average, min,max,firstï¼Œdense, é»˜è®¤ average</span>
s<span class="token punctuation">.</span>rank<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># æ•°æ®çˆ†ç‚¸ï¼Œå°†æœ¬åˆ—çš„ç±»åˆ—è¡¨æ•°æ®å’Œå…¶ä»–åˆ—çš„æ•°æ®å±•å¼€é“ºå¼€</span>
df<span class="token punctuation">.</span>explode<span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># æšä¸¾æ›´æ–°</span>
status <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token string">&#39;æœªæ‰§è¡Œ&#39;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token string">&#39;æ‰§è¡Œä¸­&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span><span class="token string">&#39;æ‰§è¡Œå®Œæ¯•&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span><span class="token string">&#39;æ‰§è¡Œå¼‚å¸¸&#39;</span><span class="token punctuation">}</span>
df<span class="token punctuation">[</span><span class="token string">&#39;taskStatus&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;taskStatus&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>status<span class="token punctuation">.</span>get<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>é‡‘é¢<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment"># æ–°å¢å­—æ®µ</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">&#39;bar&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;two&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&#39;A&#39;</span><span class="token punctuation">]</span> <span class="token comment"># å¤šç´¢å¼•æŸ¥è¯¢</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;i0 == &quot;b&quot; &amp; i1 == &quot;b&quot;&#39;</span><span class="token punctuation">)</span> <span class="token comment"># å¤šç´¢å¼•æŸ¥è¯¢æ–¹æ³• 2</span>
<span class="token comment"># å–å¤šç´¢å¼•ä¸­æŒ‡å®šçº§åˆ«çš„æ‰€æœ‰ä¸é‡å¤å€¼</span>
df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>get_level_values<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># å»æ‰ä¸ºé›¶å°æ•°ï¼Œ12.00 -&gt; 12</span>
df<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;str&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>applymap<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&#39;.00&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># æ’å…¥æ•°æ®ï¼Œåœ¨ç¬¬ä¸‰åˆ—åŠ å…¥ã€Œä¸¤å€ã€åˆ—</span>
df<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;ä¸¤å€&#39;</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;å€¼&#39;</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># æšä¸¾è½¬æ¢</span>
df<span class="token punctuation">[</span><span class="token string">&#39;gender&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>gender<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;male&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;ç”·&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;female&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;å¥³&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># å¢åŠ æœ¬è¡Œä¹‹å’Œåˆ—</span>
df<span class="token punctuation">[</span><span class="token string">&#39;Col_sum&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment"># å¯¹æŒ‡å®šè¡Œè¿›è¡ŒåŠ å’Œ</span>
col_list<span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># å–è¯·å‡èŒƒå›´æ—¥æœŸ</span>
df<span class="token punctuation">[</span><span class="token string">&#39;æ€»å¤©æ•°&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span>col_list<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># è®¡ç®—æ€»è¯·å‡å¤©æ•°</span>
<span class="token comment"># å¯¹åˆ—æ±‚å’Œï¼Œæ±‡æ€»</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;col_sum&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‰æŒ‡å®šçš„åˆ—è¡¨é¡ºåºæ˜¾ç¤º</span>
df<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span>order_list<span class="token punctuation">)</span>
<span class="token comment"># æŒ‰æŒ‡å®šçš„å¤šåˆ—æ’åº</span>
df<span class="token punctuation">.</span>reindex<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;col_1&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;col_5&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token string">&quot;columns&quot;</span><span class="token punctuation">)</span>
<span class="token comment"># è¡¥é½ç©ºå€¼</span>
a <span class="token operator">=</span> a<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">&#39;bfill&#39;</span><span class="token punctuation">)</span>
<span class="token comment">#method : {â€˜backfill&#39;, â€˜bfill&#39;, â€˜pad&#39;, â€˜ffill&#39;, None}, default None</span>
<span class="token comment">#pad / ffill: å‘ä¸‹è‡ªåŠ¨å¡«å……</span>
<span class="token comment">#backfill / bfill: å‘ä¸Šè‡ªåŠ¨å¡«å……</span>
<span class="token comment"># æ—¶é—´èŒƒå›´</span>
s_date <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2021-06-29&#39;</span><span class="token punctuation">)</span><span class="token comment">#datetime.datetime.strptime(&#39;20210629&#39;, &#39;%Y%m%d&#39;).date()</span>
e_date <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2021-07-29&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">&#39;DATA_DATE_TIME&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;DATA_DATE&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">&#39;%Y%m%d&#39;</span><span class="token punctuation">)</span>
df <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;DATA_DATE_TIME&#39;</span><span class="token punctuation">]</span><span class="token operator">&gt;=</span>s_date<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;DATA_DATE_TIME&#39;</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span>e_date<span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># æŸ¥è¯¢å…·ä½“é‡å¤çš„æ•°æ®</span>
unique1 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;ORDER_ID&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">(</span><span class="token punctuation">)</span>
unique2 <span class="token operator">=</span> unique1<span class="token punctuation">[</span>unique1<span class="token operator">&gt;</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
unique3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>unique2<span class="token punctuation">,</span>df<span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ORDER_ID&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
unique3

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ•°æ®é€‰å–" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é€‰å–" aria-hidden="true">#</a> æ•°æ®é€‰å–</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">[</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span> col2<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># ä»¥DataFrameå½¢å¼è¿”å›å¤šåˆ—</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;team&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># æŒ‰æ¡ä»¶æŸ¥è¯¢ï¼Œåªæ˜¾ç¤ºname åˆ—</span>
s<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># æŒ‰ä½ç½®é€‰å–æ•°æ®</span>
s<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;index_one&#39;</span><span class="token punctuation">]</span> <span class="token comment"># æŒ‰ç´¢å¼•é€‰å–æ•°æ®</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span> <span class="token comment">#  Aåˆ° B å­—æ®µçš„ç¬¬ä¸€è¡Œ</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">2018</span><span class="token punctuation">:</span><span class="token number">1990</span><span class="token punctuation">,</span> <span class="token string">&#39;ç¬¬ä¸€äº§ä¸šå¢åŠ å€¼&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;ç¬¬ä¸‰äº§ä¸šå¢åŠ å€¼&#39;</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment"># d.loc[ä½ç½®åˆ‡ç‰‡, å­—æ®µ]</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment"># è¿”å›ç¬¬ä¸€è¡Œ, iloc åªèƒ½æ˜¯æ•°å­—</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment"># è¿”å›ç¬¬ä¸€åˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span>
dc<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;site_id &gt; 8 and utype==&quot;è€å®¢&quot;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å¯ä»¥ and or / &amp; |</span>
 <span class="token comment"># è¿­ä»£å™¨åŠä½¿ç”¨</span>
<span class="token keyword">for</span> idx<span class="token punctuation">,</span>row <span class="token keyword">in</span> df<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> row<span class="token punctuation">[</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">]</span>
<span class="token comment"># è¿­ä»£å™¨å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">,</span><span class="token string">&#39;é“¾æ¥&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&#39;http://www.gairuo.com/p/</span><span class="token interpolation"><span class="token punctuation">{</span>slug<span class="token punctuation">}</span></span><span class="token string">.html&#39;</span></span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> df<span class="token punctuation">.</span>Name<span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token comment"># è¿­ä»£ä¸€ä¸ªåˆ—</span>
<span class="token comment"># æŒ‰åˆ—è¿­ä»£ï¼Œ[åˆ—å, åˆ—ä¸­çš„æ•°æ®åºåˆ— Sï¼ˆç´¢å¼•å å€¼)]</span>
<span class="token keyword">for</span> label<span class="token punctuation">,</span> content <span class="token keyword">in</span> df<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>label<span class="token punctuation">,</span> content<span class="token punctuation">)</span>
<span class="token comment"># æŒ‰è¡Œè¿­ä»£ï¼Œè¿­ä»£å‡ºæ•´è¡ŒåŒ…æ‹¬ç´¢å¼•çš„ç±»ä¼¼åˆ—è¡¨çš„å†…å®¹ï¼Œå¯row[2]å–</span>
<span class="token keyword">for</span> row <span class="token keyword">in</span> df<span class="token punctuation">.</span>itertuples<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>at<span class="token punctuation">[</span><span class="token number">2018</span><span class="token punctuation">,</span> <span class="token string">&#39;æ€»äººå£&#39;</span><span class="token punctuation">]</span> <span class="token comment"># æŒ‰è¡Œåˆ—ç´¢å¼•åå–ä¸€ä¸ªæŒ‡å®šçš„å•ä¸ªå…ƒç´ </span>
df<span class="token punctuation">.</span>iat<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token comment"># ç´¢å¼•å’Œåˆ—çš„ç¼–å·å–å•ä¸ªå…ƒç´ </span>
s<span class="token punctuation">.</span>nlargest<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>nsmallest<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment"># æœ€å¤§å’Œæœ€å°çš„å‰å‡ ä¸ªå€¼</span>
df<span class="token punctuation">.</span>nlargest<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;population&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;GDP&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>take<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># æŒ‡å®šå¤šä¸ªè¡Œåˆ—ä½ç½®çš„å†…å®¹</span>
<span class="token comment"># æŒ‰è¡Œåˆ—æˆªå–æ‰éƒ¨åˆ†å†…å®¹ï¼Œæ”¯æŒæ—¥æœŸç´¢å¼•æ ‡ç­¾</span>
ds<span class="token punctuation">.</span>truncate<span class="token punctuation">(</span>before<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> after<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token comment"># å°† dataframe è½¬æˆ series</span>
df<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token builtin">float</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token string">&#39;%&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># ç™¾åˆ†æ•°è½¬æ•°å­—</span>
df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token comment"># å–æ¶ˆç´¢å¼•</span>

df<span class="token punctuation">.</span>eq<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># ç­‰äºç›¸ç­‰ ==</span>
df<span class="token punctuation">.</span>ne<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># ä¸ç­‰äº !=</span>
df<span class="token punctuation">.</span>le<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å°äºç­‰äº &gt;=</span>
df<span class="token punctuation">.</span>lt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å°äº &lt;</span>
df<span class="token punctuation">.</span>ge<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å¤§äºç­‰äº &gt;=</span>
df<span class="token punctuation">.</span>gt<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># å¤§äº &gt;</span>
<span class="token comment"># éƒ½æ”¯æŒ  axis{0 or â€˜indexâ€™, 1 or â€˜columnsâ€™}, default â€˜columnsâ€™</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Q1<span class="token punctuation">.</span>ne<span class="token punctuation">(</span><span class="token number">89</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># Q1 ä¸ç­‰äº8</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">.</span>Q1<span class="token punctuation">.</span>gt<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> df<span class="token punctuation">.</span>Q2<span class="token punctuation">.</span>lt<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># and å…³ç³» Q1&gt;90 Q2&lt;90</span>

df<span class="token punctuation">[</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">[</span><span class="token string">&#39;Q1&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">]</span> <span class="token comment"># Q1ä¸º8çš„</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> df<span class="token punctuation">.</span>Q1 <span class="token operator">==</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token string">&#39;Q1&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;Q2&#39;</span><span class="token punctuation">]</span> <span class="token comment"># Q1ä¸º8çš„, æ˜¾ç¤º Q1 Q2</span>

df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 &gt; Q2 &gt; 90&#39;</span><span class="token punctuation">)</span> <span class="token comment"># ç›´æ¥å†™ç±»å‹ sql where è¯­å¥</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 + Q2 &gt; 180&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 == Q2&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;(Q1&lt;50) &amp; (Q2&gt;40) and (Q3&gt;90)&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 &gt; Q2 &gt; Q3 &gt; Q4&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;team != &quot;C&quot;&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;team not in (&quot;E&quot;,&quot;A&quot;,&quot;B&quot;)&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># å¯¹äºåç§°ä¸­å¸¦æœ‰ç©ºæ ¼çš„åˆ—ï¼Œå¯ä»¥ä½¿ç”¨åå¼•å·å¼•èµ·æ¥</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;B == `team name`&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># æ”¯æŒä¼ å…¥å˜é‡ï¼Œå¦‚ï¼šå¤§äºå¹³å‡åˆ†40åˆ†çš„</span>
a <span class="token operator">=</span> df<span class="token punctuation">.</span>Q1<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 &gt; @a+40&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&#39;Q1 &gt; `Q2`+@a&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># df.eval() ç”¨æ³•ä¸ df.query ç±»ä¼¼</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">&quot;Q1 &gt; 90 &gt; Q3 &gt; 10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span>df<span class="token punctuation">.</span><span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token string">&quot;Q1 &gt; `Q2`+@a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># åˆ†ç»„å–å‰3</span>
df_ask_org<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;CLASS&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">.</span>nlargest<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&#39;è¿°æ±‚é‡&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ•°æ®å¤„ç†ã€åˆ†ç»„ã€é€è§†" tabindex="-1"><a class="header-anchor" href="#æ•°æ®å¤„ç†ã€åˆ†ç»„ã€é€è§†" aria-hidden="true">#</a> æ•°æ®å¤„ç†ã€åˆ†ç»„ã€é€è§†</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span>col1<span class="token punctuation">,</span>col2<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># è¿”å›ä¸€ä¸ªæŒ‰å¤šåˆ—è¿›è¡Œåˆ†ç»„çš„Groupbyå¯¹è±¡</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">[</span>col2<span class="token punctuation">]</span> <span class="token comment"># è¿”å›æŒ‰åˆ—col1è¿›è¡Œåˆ†ç»„åï¼Œåˆ—col2çš„å‡å€¼</span>
<span class="token comment"># åˆ›å»ºä¸€ä¸ªæŒ‰åˆ—col1è¿›è¡Œåˆ†ç»„ï¼Œå¹¶è®¡ç®—col2å’Œcol3çš„æœ€å¤§å€¼çš„æ•°æ®é€è§†è¡¨</span>
df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span>col1<span class="token punctuation">,</span>
               values<span class="token operator">=</span><span class="token punctuation">[</span>col2<span class="token punctuation">,</span>col3<span class="token punctuation">]</span><span class="token punctuation">,</span>
               aggfunc<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">,</span>
               as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment"># åŒä¸Š</span>
df<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;site_id&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;utype&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;uv_all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;regist_num&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
               aggfunc<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;max&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;mean&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>col1<span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">)</span> <span class="token comment"># è¿”å›æŒ‰åˆ—col1åˆ†ç»„çš„æ‰€æœ‰åˆ—çš„å‡å€¼</span>
<span class="token comment"># æŒ‰åˆ—å°†å…¶ä»–åˆ—è½¬è¡Œ</span>
pd<span class="token punctuation">.</span>melt<span class="token punctuation">(</span>df<span class="token punctuation">,</span> id_vars<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;day&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> var_name<span class="token operator">=</span><span class="token string">&#39;city&#39;</span><span class="token punctuation">,</span> value_name<span class="token operator">=</span><span class="token string">&#39;temperature&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># äº¤å‰è¡¨æ˜¯ç”¨äºç»Ÿè®¡åˆ†ç»„é¢‘ç‡çš„ç‰¹æ®Šé€è§†è¡¨</span>
pd<span class="token punctuation">.</span>crosstab<span class="token punctuation">(</span>df<span class="token punctuation">.</span>Nationality<span class="token punctuation">,</span>df<span class="token punctuation">.</span>Handedness<span class="token punctuation">)</span>
<span class="token comment"># groupby åæ’åºï¼Œåˆ†ç»„ agg å†…çš„å…ƒç´ å–å›ºå®šä¸ªæ•°</span>
<span class="token punctuation">(</span>
    df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>p_day <span class="token operator">&gt;=</span> <span class="token string">&#39;20190101&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;name&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;uv&#39;</span><span class="token punctuation">:</span><span class="token builtin">sum</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;uv&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>level<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment"># æ¯å¤©å–5ä¸ªé¡µé¢</span>
    <span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>plot<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token comment"># åˆå¹¶æŸ¥è¯¢ç»ç¬¬ä¸€ä¸ªçœ‹ï¼ˆmax, min, last, size:æ•°é‡ï¼‰</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;ç»“ç®—ç±»å‹&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># åˆå¹¶æ˜ç»†å¹¶åˆ†ç»„ç»Ÿè®¡åŠ æ€»ï¼ˆ&#39;max&#39;, `mean`, `median`,</span>
<span class="token comment"># `prod`, `sum`, `std`,`var`, &#39;nunique&#39;ï¼‰,&#39;nunique&#39;ä¸ºå»é‡çš„åˆ—è¡¨</span>
df1 <span class="token operator">=</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token string">&#39;è®¾è®¡å¸ˆID&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;ç»“ç®—é‡‘é¢&#39;</span><span class="token punctuation">:</span><span class="token builtin">sum</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span>df<span class="token punctuation">.</span>pf<span class="token punctuation">)</span><span class="token punctuation">.</span>ip<span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># groupby distinct, åˆ†ç»„+å»é‡æ•°</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span>df<span class="token punctuation">.</span>pf<span class="token punctuation">)</span><span class="token punctuation">.</span>ip<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># groupby åˆ†ç»„+å»é‡çš„å€¼åŠæ•°é‡</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;sum&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;median&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

se_level1<span class="token punctuation">[</span><span class="token string">&#39;level_0&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x <span class="token punctuation">:</span> <span class="token string">&#39;{:0&gt;2d}&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
data<span class="token punctuation">[</span><span class="token string">&#39;huanbi_01&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">format</span><span class="token punctuation">(</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">&#39;mony&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> data<span class="token punctuation">[</span><span class="token string">&#39;mony&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>data<span class="token punctuation">[</span><span class="token string">&#39;mony&#39;</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">&#39;.2%&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># {:.2f} ä¿ç•™å°æ•°ç‚¹åä¸¤ä½</span>
<span class="token comment"># {:+.2f} å¸¦ç¬¦å·ä¿ç•™å°æ•°ç‚¹åä¸¤ä½</span>
<span class="token comment"># {:+.2f} å¸¦ç¬¦å·ä¿ç•™å°æ•°ç‚¹åä¸¤ä½</span>
<span class="token comment"># {:.0f} ä¸å¸¦å°æ•°</span>
<span class="token comment"># {:0&gt;2d} æ•°å­—è¡¥é›¶ (å¡«å……å·¦è¾¹, å®½åº¦ä¸º2)</span>
<span class="token comment"># {:x&lt;4d} æ•°å­—è¡¥x (å¡«å……å³è¾¹, å®½åº¦ä¸º4)</span>
<span class="token comment"># {:x&lt;4d} æ•°å­—è¡¥x (å¡«å……å³è¾¹, å®½åº¦ä¸º4)</span>
<span class="token comment"># {:,} ä»¥é€—å·åˆ†éš”çš„æ•°å­—æ ¼å¼</span>
<span class="token comment"># {:.2%} ç™¾åˆ†æ¯”æ ¼å¼</span>
<span class="token comment"># {:.2e} æŒ‡æ•°è®°æ³•</span>
<span class="token comment"># {:&gt;10d} å³å¯¹é½ (é»˜è®¤, å®½åº¦ä¸º10)</span>
<span class="token comment"># {:&lt;10d} å·¦å¯¹é½ (å®½åº¦ä¸º10)</span>
<span class="token comment"># {:^10d} ä¸­é—´å¯¹é½ (å®½åº¦ä¸º10)</span>

<span class="token comment"># å æ¯”</span>
r15<span class="token punctuation">[</span><span class="token string">&#39;proportion&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> r15<span class="token punctuation">[</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">]</span><span class="token operator">/</span>r15<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;service_provider&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;trip_type&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token string">&#39;sum&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># åˆå¹¶ç»“æœä¸ºä¸€åˆ—</span>
r1_3 <span class="token operator">=</span> df<span class="token punctuation">.</span>query<span class="token punctuation">(</span><span class="token string">&quot;APPLICANT_SEX_CN != &#39;æœªçŸ¥&#39;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>
    <span class="token punctuation">[</span><span class="token string">&quot;CASE_TYPE_CN&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&quot;APPLICANT_SEX_CN&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>
        <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> gensexrate<span class="token punctuation">(</span>x<span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_frame<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#.apply(lambda x: &quot;:&quot;.join(str(a) for a in x.value_counts().values.tolist()))</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ•°æ®åˆå¹¶" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åˆå¹¶" aria-hidden="true">#</a> æ•°æ®åˆå¹¶</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># åˆå¹¶é€è§†è¡¨å’Œåˆ†ç»„è¡¨</span>
table4 <span class="token operator">=</span> table1<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
table3 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ä¸€çº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;äºŒçº§åˆ†ç±»&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;uuid&quot;</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
table2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ä¸€çº§åˆ†ç±»&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;uuid&quot;</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
table1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>pivot_table<span class="token punctuation">(</span>df<span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ä¸€çº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;äºŒçº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ä¸‰çº§åˆ†ç±»&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> fill_value<span class="token operator">=</span><span class="token string">&quot;æ— &quot;</span><span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;uuid&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> aggfunc<span class="token operator">=</span><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
_merge <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>table2<span class="token punctuation">,</span> table4<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ä¸€çº§åˆ†ç±»&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
_merge<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;ä¸€çº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ä¸€çº§åˆ†ç±»_count&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;äºŒçº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ä¸‰çº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ä¸‰çº§åˆ†ç±»_count&#39;</span><span class="token punctuation">]</span>
merge <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>_merge<span class="token punctuation">,</span> table3<span class="token punctuation">,</span> on<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ä¸€çº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span><span class="token string">&quot;äºŒçº§åˆ†ç±»&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
merge <span class="token operator">=</span> merge<span class="token punctuation">.</span>rename<span class="token punctuation">(</span>columns<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&#39;å·¥å•ç¼–å·&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;äºŒçº§åˆ†ç±»_count&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
merge <span class="token operator">=</span> merge<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;ä¸€çº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ä¸€çº§åˆ†ç±»_count&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;äºŒçº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;äºŒçº§åˆ†ç±»_count&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;ä¸‰çº§åˆ†ç±»&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ä¸‰çº§åˆ†ç±»_count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
merge <span class="token operator">=</span> merge<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ä¸€çº§åˆ†ç±»_count&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;äºŒçº§åˆ†ç±»_count&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;ä¸‰çº§åˆ†ç±»_count&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># åˆå¹¶æ‹¼æ¥è¡Œ</span>
<span class="token comment"># å°†df2ä¸­çš„è¡Œæ·»åŠ åˆ°df1çš„å°¾éƒ¨</span>
df1<span class="token punctuation">.</span>append<span class="token punctuation">(</span>df2<span class="token punctuation">)</span>
<span class="token comment"># æŒ‡å®šåˆ—åˆå¹¶æˆä¸€ä¸ªæ–°è¡¨æ–°åˆ—</span>
ndf <span class="token operator">=</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;æå1&#39;</span><span class="token punctuation">]</span>
       <span class="token punctuation">.</span>append<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;æå2&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
       <span class="token punctuation">.</span>append<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;æå3&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ignore_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ndf <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>ndf<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;å§“å&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># å°†df2ä¸­çš„åˆ—æ·»åŠ åˆ°df1çš„å°¾éƒ¨</span>
df<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># åˆå¹¶æ–‡ä»¶çš„å„è¡Œ</span>
df1 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;111.csv&#39;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&#39;\t&#39;</span><span class="token punctuation">)</span>
df2 <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;222.csv&#39;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&#39;\t&#39;</span><span class="token punctuation">)</span>
excel_list <span class="token operator">=</span> <span class="token punctuation">[</span>df1<span class="token punctuation">,</span> df2<span class="token punctuation">]</span>
<span class="token comment"># result = pd.concat(excel_list).fillna(&#39;&#39;)[:].astype(&#39;str&#39;)</span>
result <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>excel_list<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
result<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span><span class="token string">&#39;333.xlsx&#39;</span><span class="token punctuation">,</span> index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># åˆå¹¶æŒ‡å®šç›®å½•ä¸‹æ‰€æœ‰çš„ excel (csv) æ–‡ä»¶</span>
<span class="token keyword">import</span> glob
files <span class="token operator">=</span> glob<span class="token punctuation">.</span>glob<span class="token punctuation">(</span><span class="token string">&quot;data/cs/*.xls&quot;</span><span class="token punctuation">)</span>
dflist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> files<span class="token punctuation">:</span>
    dflist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>i<span class="token punctuation">,</span> usecols<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;ID&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;æ—¶é—´&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;åç§°&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

df <span class="token operator">=</span> pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>dflist<span class="token punctuation">)</span>

<span class="token comment"># åˆå¹¶å¢åŠ åˆ—</span>
<span class="token comment"># å¯¹df1çš„åˆ—å’Œdf2çš„åˆ—æ‰§è¡ŒSQLå½¢å¼çš„join</span>
df1<span class="token punctuation">.</span>join<span class="token punctuation">(</span>df2<span class="token punctuation">,</span>on<span class="token operator">=</span>col1<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">&#39;inner&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># ç”¨ key åˆå¹¶ä¸¤ä¸ªè¡¨</span>
df_all <span class="token operator">=</span> pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>df_sku<span class="token punctuation">,</span> df_spu<span class="token punctuation">,</span>
                  how<span class="token operator">=</span><span class="token string">&#39;left&#39;</span><span class="token punctuation">,</span>
                  left_on<span class="token operator">=</span>df_sku<span class="token punctuation">[</span><span class="token string">&#39;product_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                  right_on<span class="token operator">=</span>df_spu<span class="token punctuation">[</span><span class="token string">&#39;p.product_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># è¿”å›å¤šåˆ—</span>
<span class="token keyword">def</span> <span class="token function">formatrow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&quot;cnt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token string">&quot;cnt&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> row<span class="token punctuation">[</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> a<span class="token punctuation">,</span> b
df_tmp<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;fomat1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;format2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_tmp<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>formatrow<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> result_type<span class="token operator">=</span><span class="token string">&quot;expand&quot;</span><span class="token punctuation">)</span>
df_tmp<span class="token punctuation">[</span><span class="token string">&quot;fomat1-1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> df_tmp<span class="token punctuation">[</span><span class="token string">&quot;format2-2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>df_tmp<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>formatrow<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">age_map</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token keyword">return</span> x<span class="token operator">+</span><span class="token number">1</span>
data<span class="token punctuation">[</span><span class="token string">&#39;age&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">&#39;birth_year&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>age_map<span class="token punctuation">)</span>

pd<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span>x<span class="token punctuation">)</span>
df<span class="token punctuation">.</span>isna<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ—¶é—´å¤„ç†" tabindex="-1"><a class="header-anchor" href="#æ—¶é—´å¤„ç†" aria-hidden="true">#</a> æ—¶é—´å¤„ç†</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># æ—¶é—´ç´¢å¼•</span>
df<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>DatetimeIndex<span class="token punctuation">(</span>df<span class="token punctuation">.</span>index<span class="token punctuation">)</span>
<span class="token comment"># æ—¶é—´åªä¿ç•™æ—¥æœŸ</span>
df<span class="token punctuation">[</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>date
<span class="token comment"># å°†æŒ‡å®šå­—æ®µæ ¼å¼åŒ–ä¸ºæ—¶é—´ç±»å‹</span>
df<span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;æ—¶é—´&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># è½¬åŒ–ä¸ºåŒ—äº¬æ—¶é—´</span>
df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>tz_convert<span class="token punctuation">(</span><span class="token string">&#39;Asia/Shanghai&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># è½¬ä¸ºæŒ‡å®šæ ¼å¼ï¼Œå¯èƒ½ä¼šå¤±å»ç§’ä»¥åçš„ç²¾åº¦</span>
df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="token punctuation">)</span>
dc<span class="token punctuation">.</span>index <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>dc<span class="token punctuation">.</span>index<span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">&#39;%Y%m%d&#39;</span><span class="token punctuation">,</span> errors<span class="token operator">=</span><span class="token string">&#39;ignore&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># æ—¶é—´ï¼Œå‚ä¸è¿ç®—</span>
pd<span class="token punctuation">.</span>DateOffset<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># å½“å‰æ—¶é—´</span>
pd<span class="token punctuation">.</span>Timestamp<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;today&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># åˆ¤æ–­æ—¶é—´æ˜¯å¦å½“å¤©</span>
pd<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>today<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>year <span class="token operator">==</span> df<span class="token punctuation">.</span>start_work<span class="token punctuation">.</span>dt<span class="token punctuation">.</span>year
df<span class="token punctuation">.</span>time<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;datetime64[ns]&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>date <span class="token operator">==</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;today&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># å®šä¹‰ä¸ªå¤©æ•°</span>
<span class="token keyword">import</span> datetime
days <span class="token operator">=</span> <span class="token keyword">lambda</span> x<span class="token punctuation">:</span> datetime<span class="token punctuation">.</span>timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span>x<span class="token punctuation">)</span>
days<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># åŒä¸Šï¼Œç›´æ¥ç”¨ pd åŒ…è£…çš„</span>
pd<span class="token punctuation">.</span>Timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># unix æ—¶é—´æˆ³</span>
pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>ted<span class="token punctuation">.</span>film_date<span class="token punctuation">,</span> unit<span class="token operator">=</span><span class="token string">&#39;ms&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‰æœˆï¼ˆYMDHminSï¼‰é‡‡é›†åˆè®¡æ•°æ®</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;quantity&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">&quot;M&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‰å¤©æ±‡æ€»ï¼Œindex æ˜¯ datetime æ—¶é—´ç±»å‹</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span>df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;uu&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;count&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‰å‘¨æ±‡æ€»</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>by<span class="token operator">=</span>df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>weekday<span class="token punctuation">)</span><span class="token punctuation">.</span>uu<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‰æœˆè¿›è¡Œæ±‡æ€»</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> pd<span class="token punctuation">.</span>Grouper<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‰æœˆè¿›è¡Œæ±‡æ€»</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>pd<span class="token punctuation">.</span>Grouper<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token string">&#39;day&#39;</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">&#39;1M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‰ç…§å¹´åº¦ï¼Œä¸”æˆªæ­¢åˆ°12æœˆæœ€åä¸€å¤©ç»Ÿè®¡ ext price çš„ sum å€¼</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">,</span> pd<span class="token punctuation">.</span>Grouper<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token string">&#39;date&#39;</span><span class="token punctuation">,</span> freq<span class="token operator">=</span><span class="token string">&#39;A-DEC&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># æŒ‰æœˆçš„å¹³å‡é‡æ–°é‡‡æ ·</span>
df<span class="token punctuation">[</span><span class="token string">&#39;Close&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>resample<span class="token punctuation">(</span><span class="token string">&#39;M&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases</span>
<span class="token comment"># å–æ—¶é—´èŒƒå›´ï¼Œå¹¶å–å·¥ä½œæ—¥</span>
rng <span class="token operator">=</span> pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start<span class="token operator">=</span><span class="token string">&quot;6/1/2016&quot;</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">&quot;6/30/2016&quot;</span><span class="token punctuation">,</span>freq<span class="token operator">=</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># é‡æ–°å®šæ—¶æ•°æ®é¢‘åº¦ï¼ŒæŒ‰ä¸€å®šè¡¥å……æ–¹æ³•</span>
df<span class="token punctuation">.</span>asfreq<span class="token punctuation">(</span><span class="token string">&#39;D&#39;</span><span class="token punctuation">,</span> method<span class="token operator">=</span><span class="token string">&#39;pad&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># æ—¶åŒºï¼Œdf.tz_convert(&#39;Europe/Berlin&#39;)</span>
df<span class="token punctuation">.</span>time<span class="token punctuation">.</span>tz_localize<span class="token punctuation">(</span>tz<span class="token operator">=</span><span class="token string">&#39;Asia/Shanghai&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># è½¬åŒ—äº¬æ—¶é—´</span>
df<span class="token punctuation">[</span><span class="token string">&#39;Time&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;Time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>tz_localize<span class="token punctuation">(</span><span class="token string">&#39;UTC&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>tz_convert<span class="token punctuation">(</span><span class="token string">&#39;Asia/Shanghai&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># æŸ¥çœ‹æ‰€æœ‰æ—¶åŒº</span>
<span class="token keyword">from</span> pytz <span class="token keyword">import</span> all_timezones
<span class="token keyword">print</span> <span class="token punctuation">(</span>all_timezones<span class="token punctuation">)</span>
<span class="token comment"># æ—¶é•¿ï¼Œå¤šä¹…ï¼Œä¸¤ä¸ªæ—¶é—´é—´éš”æ—¶é—´ï¼Œæ—¶å·®</span>
df<span class="token punctuation">[</span><span class="token string">&#39;duration&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span>pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;end&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">&#39;begin&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dt<span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">60</span><span class="token operator">/</span><span class="token number">60</span>
<span class="token comment"># æŒ‡å®šæ—¶é—´è¿›è¡Œå¯¹æ¯”</span>
df<span class="token punctuation">.</span>Time<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;datetime64[ns]&#39;</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2019-12-11 20:00:00&#39;</span><span class="token punctuation">,</span> <span class="token builtin">format</span><span class="token operator">=</span><span class="token string">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># åªè®¡ç®—å·¥ä½œæ—¥</span>
<span class="token keyword">from</span> pandas<span class="token punctuation">.</span>tseries<span class="token punctuation">.</span>offsets <span class="token keyword">import</span> CustomBusinessDay
b <span class="token operator">=</span> CustomBusinessDay<span class="token punctuation">(</span>holidays<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;2022-04-03&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2022-04-04&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2022-04-05&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>weekmask<span class="token operator">=</span><span class="token string">&#39;Mon Tue Wed Thu Fri Sat Sun&#39;</span><span class="token punctuation">)</span>
start_time <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2022-03-28 01:30:12&#39;</span><span class="token punctuation">)</span>
end_time <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token string">&#39;2022-04-11 12:55:35&#39;</span><span class="token punctuation">)</span>
len1 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span> end_time<span class="token punctuation">,</span>freq<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
len2 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start_time<span class="token punctuation">,</span> end_time<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>len1<span class="token punctuation">,</span>len2<span class="token punctuation">)</span>
duration <span class="token operator">=</span> end_time<span class="token operator">-</span>start_time
<span class="token keyword">print</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token punctuation">(</span>duration<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len2<span class="token operator">-</span>len1<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">24</span><span class="token punctuation">)</span>
<span class="token comment"># åªè®¡ç®—å·¥ä½œæ—¥ï¼Œè€ƒè™‘å¼€å§‹æ—¶é—´ä¸ç»“æŸæ—¶é—´å¯èƒ½æ˜¯éå·¥ä½œæ—¥çš„æƒ…å†µ</span>
holidays<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;2022-04-03&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2022-04-04&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;2022-04-05&#39;</span><span class="token punctuation">]</span>
businessdays <span class="token operator">=</span> pd<span class="token punctuation">.</span>tseries<span class="token punctuation">.</span>offsets<span class="token punctuation">.</span>CustomBusinessDay<span class="token punctuation">(</span>holidays<span class="token operator">=</span>holidays<span class="token punctuation">,</span>weekmask<span class="token operator">=</span><span class="token string">&#39;Mon Tue Wed Thu Fri Sat Sun&#39;</span><span class="token punctuation">)</span>
df_test <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&#39;2022-03-28 01:30:12&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-11 12:55:35&#39;</span><span class="token punctuation">,</span> <span class="token string">&quot;te1&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token punctuation">[</span><span class="token string">&#39;2022-04-04 01:30:12&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-11 12:55:35&#39;</span><span class="token punctuation">,</span> <span class="token string">&quot;te2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token punctuation">[</span><span class="token string">&#39;2022-04-04 23:30:12&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-06 12:20:35&#39;</span><span class="token punctuation">,</span> <span class="token string">&quot;te3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        <span class="token punctuation">[</span><span class="token string">&#39;2022-04-02 20:30:12&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;2022-04-03 12:00:00&#39;</span><span class="token punctuation">,</span> <span class="token string">&quot;te4&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;start_time&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;end_time&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;title&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">computeDur</span><span class="token punctuation">(</span>start_time<span class="token punctuation">,</span> end_time<span class="token punctuation">)</span><span class="token punctuation">:</span>
   start_time <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>start_time<span class="token punctuation">)</span>
   end_time <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span>end_time<span class="token punctuation">)</span>
   len1 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> freq<span class="token operator">=</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
   len2 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>date_range<span class="token punctuation">(</span>start_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token keyword">if</span> len1 <span class="token operator">==</span><span class="token number">0</span> <span class="token punctuation">:</span>
       <span class="token keyword">return</span> <span class="token number">0</span>
   sub_s <span class="token operator">=</span> <span class="token number">0</span>
   sub_e <span class="token operator">=</span> <span class="token number">0</span>
   <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>start_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">in</span> holidays<span class="token punctuation">:</span>
       sub_s <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>start_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; 23:59:59&#39;</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time
       sub_s <span class="token operator">=</span> <span class="token number">24</span> <span class="token operator">-</span> sub_s<span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span>
   <span class="token keyword">if</span> <span class="token builtin">str</span><span class="token punctuation">(</span>end_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">in</span> holidays<span class="token punctuation">:</span>
       sub_e <span class="token operator">=</span> pd<span class="token punctuation">.</span>to_datetime<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>end_time<span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39; 23:59:59&#39;</span><span class="token punctuation">)</span> <span class="token operator">-</span> end_time
       sub_e <span class="token operator">=</span> sub_e<span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span>
   <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>end_time <span class="token operator">-</span> start_time<span class="token punctuation">)</span><span class="token punctuation">.</span>total_seconds<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">60</span> <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>len2 <span class="token operator">-</span> len1<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">)</span> <span class="token operator">+</span> sub_s <span class="token operator">+</span> sub_e

df_test<span class="token punctuation">[</span><span class="token string">&#39;duration&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_test<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> computeDur<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token string">&#39;start_time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token string">&#39;end_time&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="å…¶ä»–" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–" aria-hidden="true">#</a> å…¶ä»–</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># è§£å†³ç§‘å­¦è®¡æ•°æ³•é—®é¢˜</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&#39;111.csv&#39;</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">&#39;\t&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">&#39;str&#39;</span><span class="token punctuation">)</span>
<span class="token comment"># å’Œè®¢å•é‡ç›¸å…³æ€§æœ€å¤§åˆ°å°æ˜¾ç¤º</span>
dd<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>total_order_num<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

<span class="token comment"># è§£æåˆ—è¡¨ã€json å­—ç¬¦ä¸²</span>
<span class="token keyword">import</span> ast
ast<span class="token punctuation">.</span>literal_eval<span class="token punctuation">(</span><span class="token string">&quot;[{&#39;id&#39;: 7, &#39;name&#39;: &#39;Funny&#39;}]&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># Series apply method applies a function to</span>
<span class="token comment"># every element in a Series and returns a Series</span>
ted<span class="token punctuation">.</span>ratings<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>str_to_list<span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># lambda is a shorter alternative</span>
ted<span class="token punctuation">.</span>ratings<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> ast<span class="token punctuation">.</span>literal_eval<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># an even shorter alternative is to apply the</span>
<span class="token comment"># function directly (without lambda)</span>
ted<span class="token punctuation">.</span>ratings<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>ast<span class="token punctuation">.</span>literal_eval<span class="token punctuation">)</span>
<span class="token comment"># ç´¢å¼• index ä½¿ç”¨ apply()</span>
df<span class="token punctuation">.</span>index<span class="token punctuation">.</span>to_series<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æ ·å¼æ˜¾ç¤º" tabindex="-1"><a class="header-anchor" href="#æ ·å¼æ˜¾ç¤º" aria-hidden="true">#</a> æ ·å¼æ˜¾ç¤º</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token comment"># https://pbpython.com/styling-pandas.html</span>
df<span class="token punctuation">[</span><span class="token string">&#39;per_cost&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">&#39;per_cost&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token string">&#39;{:,.2f}%&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">)</span>  <span class="token comment"># æ˜¾ç¤º%æ¯”å½¢å¼</span>
<span class="token comment"># æŒ‡å®šåˆ—è¡¨ï¼ˆå€¼å¤§äº0ï¼‰åŠ èƒŒæ™¯è‰²</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span>applymap<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">&#39;background-color: grey&#39;</span> <span class="token keyword">if</span> x<span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">else</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
                  subset<span class="token operator">=</span>pd<span class="token punctuation">.</span>IndexSlice<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;C&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># æœ€å¤§å€¼æœ€å°å€¼åŠ èƒŒæ™¯è‰²</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span>highlight_max<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;lightgreen&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>highlight_min<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;#cd4f39&#39;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token string">&#39;{:.2%}&#39;</span><span class="token punctuation">,</span> subset<span class="token operator">=</span>pd<span class="token punctuation">.</span>IndexSlice<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># æ˜¾ç¤ºç™¾åˆ†å·</span>

<span class="token comment"># æŒ‡å®šå„åˆ—çš„æ ·å¼</span>
format_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&#39;sum&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;${0:,.0f}&#39;</span><span class="token punctuation">,</span>
                       <span class="token string">&#39;date&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;{:%Y-%m}&#39;</span><span class="token punctuation">,</span>
                       <span class="token string">&#39;pct_of_total&#39;</span><span class="token punctuation">:</span> <span class="token string">&#39;{:.2%}&#39;</span>
                       <span class="token string">&#39;c&#39;</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">.</span>upper<span class="token punctuation">}</span>

<span class="token comment"># ä¸€æ¬¡æ€§æ ·å¼è®¾ç½®</span>
<span class="token punctuation">(</span>df<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>format_dict<span class="token punctuation">)</span> <span class="token comment"># å¤šç§æ ·å¼å½¢å¼</span>
    <span class="token punctuation">.</span>hide_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># æŒ‡å®šåˆ—æŒ‰é¢œè‰²æ·±åº¦è¡¨ç¤ºå€¼å¤§å°, cmap ä¸º matplotlib colormap</span>
    <span class="token punctuation">.</span>background_gradient<span class="token punctuation">(</span>subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;sum_num&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cmap<span class="token operator">=</span><span class="token string">&#39;BuGn&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># è¡¨æ ¼å†…ä½œæ¨ªå‘ bar ä»£è¡¨å€¼å¤§å°</span>
    <span class="token punctuation">.</span>bar<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;#FFA07A&#39;</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token number">100_000</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;sum&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;zero&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># è¡¨æ ¼å†…ä½œæ¨ªå‘ bar ä»£è¡¨å€¼å¤§å°</span>
    <span class="token punctuation">.</span>bar<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;lightgreen&#39;</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;pct_of_total&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;zero&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># ä¸‹é™ï¼ˆå°äº0ï¼‰ä¸ºçº¢è‰², ä¸Šå‡ä¸ºç»¿è‰²</span>
    <span class="token punctuation">.</span>bar<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;#ffe4e4&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;#bbf9ce&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vmin<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> vmax<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> subset<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;å¢é•¿ç‡&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">&#39;zero&#39;</span><span class="token punctuation">)</span>
    <span class="token comment"># ç»™æ ·å¼è¡¨æ ¼èµ·ä¸ªåå­—</span>
    <span class="token punctuation">.</span>set_caption<span class="token punctuation">(</span><span class="token string">&#39;2018 Sales Performance&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>hide_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># æŒ‰æ¡ä»¶ç»™æ•´è¡ŒåŠ èƒŒæ™¯è‰²ï¼ˆæ ·å¼ï¼‰</span>
<span class="token keyword">def</span> <span class="token function">background_color</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> row<span class="token punctuation">.</span>pv_num <span class="token operator">&gt;=</span> <span class="token number">10000</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">&#39;background-color: red&#39;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> row<span class="token punctuation">.</span>pv_num <span class="token operator">&gt;=</span> <span class="token number">100</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">&#39;background-color: yellow&#39;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token builtin">len</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span>
<span class="token comment"># ä½¿ç”¨</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>background_color<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="è¡¨æ ¼ä¸­çš„ç›´æ–¹å›¾-sparkline-å›¾å½¢" tabindex="-1"><a class="header-anchor" href="#è¡¨æ ¼ä¸­çš„ç›´æ–¹å›¾-sparkline-å›¾å½¢" aria-hidden="true">#</a> è¡¨æ ¼ä¸­çš„ç›´æ–¹å›¾ï¼Œsparkline å›¾å½¢</h3><div class="language-python line-numbers-mode" data-ext="py"><pre class="language-python"><code><span class="token keyword">import</span> sparklines
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">def</span> <span class="token function">sparkline_str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
    bins<span class="token operator">=</span>np<span class="token punctuation">.</span>histogram<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    sl <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>sparklines<span class="token punctuation">.</span>sparklines<span class="token punctuation">(</span>bins<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> sl
sparkline_str<span class="token punctuation">.</span>__name__ <span class="token operator">=</span> <span class="token string">&quot;sparkline&quot;</span>
<span class="token comment"># ç”»å‡ºè¶‹åŠ¿å›¾ï¼Œä¿ç•™ä¸¤ä½å°æ•°</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;quantity&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;mean&#39;</span><span class="token punctuation">,</span> sparkline_str<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># sparkline å›¾å½¢</span>
<span class="token comment"># https://hugoworld.wordpress.com/2019/01/26/sparklines-in-jupyter-notebooks-ipython-and-pandas/</span>
<span class="token keyword">def</span> <span class="token function">sparkline</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;
    creates a sparkline
    &quot;&quot;&quot;</span>

    <span class="token comment"># Turn off the max column width so the images won&#39;t be truncated</span>
    pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&#39;display.max_colwidth&#39;</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># Turning off the max column will display all the data</span>
    <span class="token comment"># if gathering into sets / array we might want to restrict to a few items</span>
    pd<span class="token punctuation">.</span>set_option<span class="token punctuation">(</span><span class="token string">&#39;display.max_seq_items&#39;</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>

    <span class="token comment">#Monkey patch the dataframe so the sparklines are displayed</span>
    pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">.</span>_repr_html_ <span class="token operator">=</span> <span class="token keyword">lambda</span> self<span class="token punctuation">:</span> self<span class="token punctuation">.</span>to_html<span class="token punctuation">(</span>escape<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>

    <span class="token keyword">from</span> matplotlib <span class="token keyword">import</span> pyplot <span class="token keyword">as</span> plt
    <span class="token keyword">import</span> base64
    <span class="token keyword">from</span> io <span class="token keyword">import</span> BytesIO

    data <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>

    <span class="token operator">*</span>_<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span>figsize<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>fill_between<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token builtin">min</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span>
    ax<span class="token punctuation">.</span>set_axis_off<span class="token punctuation">(</span><span class="token punctuation">)</span>

    img <span class="token operator">=</span> BytesIO<span class="token punctuation">(</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>img<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&#39;&lt;img src=&quot;data:image/png;base64, {}&quot; /&gt;&#39;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>img<span class="token punctuation">.</span>getvalue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># ä½¿ç”¨</span>
df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">&#39;name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;quantity&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;ext price&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;mean&#39;</span><span class="token punctuation">,</span> sparkline<span class="token punctuation">]</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span>sparkline<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment"># ä»…æ”¯æŒæ¨ªå‘æ•°æ®ç”»çº¿ï¼Œå¯åš T è½¬ç½®</span>

df88<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>y<span class="token operator">=</span><span class="token string">&#39;rate&#39;</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># å›¾å½¢å¤§å°ï¼Œå•ä½è‹±å¯¸</span>
df_1<span class="token punctuation">[</span>df_1<span class="token punctuation">.</span>p_day <span class="token operator">&gt;</span> <span class="token string">&#39;2019-06-01&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;total_order_num&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;order_user&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># æŸ±çŠ¶å›¾</span>
<span class="token comment"># æ¯æ¡çº¿ä¸€ä¸ªç«™ç‚¹ï¼Œå„ç«™ç‚¹çš„ home_remain, stackçš„æ„æ€æ˜¯å †å ï¼Œå †ç§¯</span>
<span class="token comment"># unstack å³â€œä¸è¦å †å â€</span>
<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">.</span>p_day <span class="token operator">&gt;=</span> <span class="token string">&#39;2019-05-1&#39;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span>df<span class="token punctuation">.</span>utype <span class="token operator">==</span> <span class="token string">&#39;è€å®¢&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;site_id&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">&#39;home_remain&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>line<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#  æŠ˜çº¿å›¾ï¼Œå¤šæ¡, x è½´é»˜è®¤ä¸º index</span>
dd<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>line<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;p_day&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&#39;uv_all&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;home_remain&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
dd<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&#39;æ–°è®¿å®¢&#39;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token string">&#39;order_user&#39;</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token string">&#39;paid_order_user&#39;</span><span class="token punctuation">)</span> <span class="token comment"># æ•£ç‚¹å›¾</span>
dd<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;blue&#39;</span><span class="token punctuation">)</span> <span class="token comment"># æŸ±çŠ¶å›¾, barh ä¸ºæ¨ªå‘æŸ±çŠ¶å›¾</span>
sns<span class="token punctuation">.</span>heatmap<span class="token punctuation">(</span>dd<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># ç›¸å…³æ€§å¯è§†åŒ–</span>
<span class="token comment">#  åˆ»åº¦ä»0å¼€å§‹ï¼ŒæŒ‡å®šèŒƒå›´ ylim=(0,100), x è½´ç›¸åŒ</span>
s<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>line<span class="token punctuation">(</span>ylim<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token comment"># æŠ˜çº¿é¢œè‰² https://matplotlib.org/examples/color/named_colors.html</span>
<span class="token comment"># æ ·å¼( &#39;-&#39;,&#39;--&#39;,&#39;-.&#39;,&#39;:&#39; )</span>
<span class="token comment"># æŠ˜çº¿æ ‡è®° https://matplotlib.org/api/markers_api.html</span>
<span class="token comment"># grid=True æ˜¾ç¤ºåˆ»åº¦ etc: https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html</span>
s<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>line<span class="token punctuation">(</span>color<span class="token operator">=</span><span class="token string">&#39;green&#39;</span><span class="token punctuation">,</span> linestyle<span class="token operator">=</span><span class="token string">&#39;-&#39;</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">&#39;o&#39;</span><span class="token punctuation">)</span>

<span class="token comment"># ä¸¤ä¸ªå›¾ç»˜åœ¨ä¸€èµ·</span>
<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">&#39;æ•°é‡&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>kde<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> df<span class="token punctuation">[</span><span class="token string">&#39;æ•°é‡&#39;</span><span class="token punctuation">]</span><span class="token punctuation">.</span>plot<span class="token punctuation">.</span>hist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># å¯¹è¡¨ä¸­çš„æ•°æ®æŒ‰é¢œè‰²å¯è§†åŒ–</span>
<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns
cm <span class="token operator">=</span> sns<span class="token punctuation">.</span>light_palette<span class="token punctuation">(</span><span class="token string">&quot;green&quot;</span><span class="token punctuation">,</span> as_cmap<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background_gradient<span class="token punctuation">(</span>cmap<span class="token operator">=</span>cm<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token comment"># å°†æ•°æ®è½¬åŒ–ä¸ºäºŒç»´æ•°ç»„</span>
<span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">&#39;%Y-%m-%d&#39;</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">.</span>index<span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>to_list<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># å’Œ plot ç”¨æ³•ä¸€æ · https://hvplot.pyviz.org/user_guide/Plotting.html</span>
<span class="token keyword">import</span> hvplot<span class="token punctuation">.</span>pandas

<span class="token comment"># æ‰“å° Sqlite å»ºè¡¨è¯­å¥</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pd<span class="token punctuation">.</span>io<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>get_schema<span class="token punctuation">(</span>fdf<span class="token punctuation">,</span> <span class="token string">&#39;table_name&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># jupyter notebooks plt å›¾è¡¨é…ç½®</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;figure.figsize&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">15.0</span><span class="token punctuation">,</span> <span class="token number">8.0</span><span class="token punctuation">)</span> <span class="token comment"># å›ºå®šæ˜¾ç¤ºå¤§å°</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;font.family&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;sans-serif&#39;</span><span class="token punctuation">]</span> <span class="token comment"># æ˜¾ç¤ºä¸­æ–‡é—®é¢˜</span>
plt<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">&#39;font.sans-serif&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;SimHei&#39;</span><span class="token punctuation">]</span> <span class="token comment"># æ˜¾ç¤ºä¸­æ–‡é—®é¢˜</span>

<span class="token comment"># è¾“å‡ºå•è¡Œå…¨éƒ¨å˜é‡</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>core<span class="token punctuation">.</span>interactiveshell <span class="token keyword">import</span> InteractiveShell
InteractiveShell<span class="token punctuation">.</span>ast_node_interactivity <span class="token operator">=</span> <span class="token string">&#39;all&#39;</span>

<span class="token comment"># jupyter notebooks é¡µé¢è‡ªé€‚åº”å®½åº¦</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>core<span class="token punctuation">.</span>display <span class="token keyword">import</span> display<span class="token punctuation">,</span> HTML
display<span class="token punctuation">(</span>HTML<span class="token punctuation">(</span><span class="token string">&quot;&lt;style&gt;.container { width:100% !important; }&lt;/style&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># èƒŒæ™¯ç™½è‰² &lt;style&gt;#notebook_panel {background: #ffffff;}&lt;/style&gt;</span>

<span class="token comment"># jupyter notebooks åµŒå…¥é¡µé¢å†…å®¹</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>display <span class="token keyword">import</span> IFrame
IFrame<span class="token punctuation">(</span><span class="token string">&#39;https://arxiv.org/pdf/1406.2661.pdf&#39;</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">800</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">450</span><span class="token punctuation">)</span>

<span class="token comment"># Markdown ä¸€ä¸ª cell ä¸æ”¯æŒå¤šå¼ ç²˜è´´å›¾ç‰‡</span>
<span class="token comment"># ä¸€ä¸ªæ–‡ä»¶æ‰“å°æ‰“å¼€åªæ˜¾ç¤ºä¸€å¼ å›¾ç‰‡é—®é¢˜è§£å†³</span>
<span class="token comment"># /site-packages/notebook/static/notebook/js/main.min.js var key å¤„</span>
<span class="token comment"># 33502ã€33504 è¡Œ</span>
key <span class="token operator">=</span> utils<span class="token punctuation">.</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span>encodeURIandParens<span class="token punctuation">(</span>blob<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
key <span class="token operator">=</span> utils<span class="token punctuation">.</span>uuid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">+</span>Object<span class="token punctuation">.</span>keys<span class="token punctuation">(</span>that<span class="token punctuation">.</span>attachments<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token comment"># https://github.com/ihnorton/notebook/commit/55687c2dc08817da587977cb6f19f8cc0103bab1</span>

<span class="token comment"># å¤šè¡Œè¾“å‡º</span>
<span class="token keyword">from</span> IPython<span class="token punctuation">.</span>core<span class="token punctuation">.</span>interactiveshell <span class="token keyword">import</span> InteractiveShell
InteractiveShell<span class="token punctuation">.</span>ast_node_interactivity <span class="token operator">=</span> <span class="token string">&#39;all&#39;</span> <span class="token comment">#é»˜è®¤ä¸º&#39;last&#39;</span>

<span class="token comment"># æ‰§è¡Œ shell å‘½ä»¤: ! &lt;å‘½ä»¤è¯­å¥&gt;</span>

<span class="token comment"># åœ¨çº¿å¯è§†åŒ–å·¥å…·</span>
https<span class="token punctuation">:</span><span class="token operator">//</span>plot<span class="token punctuation">.</span>ly<span class="token operator">/</span>create
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="slideshow-å¹»ç¯ç‰‡" tabindex="-1"><a class="header-anchor" href="#slideshow-å¹»ç¯ç‰‡" aria-hidden="true">#</a> Slideshow å¹»ç¯ç‰‡</h4><p><code>pip install RISE</code></p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/token01/token01.github.io/edit/main/docs/python/pandas.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><!----></footer><nav class="page-nav"><a href="/python/WinHidden.html" class="nav-link prev" aria-label="LearnNotes"><div class="hint"><span class="arrow left"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="icon iconfont icon-note"></span>LearnNotes</div></a><a href="/python/pySpark.html" class="nav-link next" aria-label="Spark in Python"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow right"></span></div><div class="link">Spark in Python<!----></div></a></nav><div class="waline-wrapper" darkmode="false" style="display:block;"><div data-waline provider="Waline"><!--v-if--><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="wl-nick">æ˜µç§°</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">é‚®ç®±</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="wl-link">ç½‘å€</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="è¯·ç•™è¨€ã€‚(å¡«å†™é‚®ç®±å¯åœ¨è¢«å›å¤æ—¶æ”¶åˆ°é‚®ä»¶æé†’)"></textarea><div class="wl-preview" style="display:none;"><hr><h4>é¢„è§ˆ:</h4><!-- eslint-disable-next-line vue/no-v-html --><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button class="wl-action" title="è¡¨æƒ…" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button class="wl-action" title="è¡¨æƒ…åŒ…"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="ä¸Šä¼ å›¾ç‰‡"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button class="wl-action" title="é¢„è§ˆ"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-text-number">0 <!--v-if--> Â å­—</div><button class="wl-btn">ç™»å½•</button><button class="wl-btn primary" title="Cmd|Ctrl + Enter"><!--[-->æäº¤<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="æœç´¢è¡¨æƒ…åŒ…"><div class="wl-gallery" style="gap:6px;"><!--[--><!--]--></div><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> è¯„è®º</div><ul class="wl-sort"><!--[--><li class="active">æŒ‰æ­£åº</li><li class="">æŒ‰å€’åº</li><li class="">æŒ‰çƒ­åº¦</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><!-- Copyright Information --><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noreferrer"> Waline </a> v2.14.1</div></div></div><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app.63c04501.js" defer></script>
  </body>
</html>
